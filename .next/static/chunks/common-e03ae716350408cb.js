"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[592],{4075:function(e,t,r){r.d(t,{N:function(){return PricingPopup}});var s=r(7437),a=r(2265),i=r(2369),n=r(5340),o=r(2549),c=r(9036),l=r(2442),d=r(3286);let u=[{id:"basic",name:"Basic",price:4.99,period:"month",description:"Perfect for individual traders",features:["Real-time market data","Advanced charting tools","Price alerts & notifications","Technical indicators","Social trading features","Email support"],limits:{portfolios:5,watchlists:10},icon:(0,s.jsx)(i.Z,{className:"w-6 h-6"}),buttonText:"Start Basic Plan",buttonVariant:"primary"},{id:"premium",name:"Premium",price:9.99,period:"month",description:"For serious traders and investors",features:["Everything in Basic","AI-powered insights","Unlimited portfolios","Unlimited watchlists","Institutional-grade tools","Priority support","Advanced analytics","Custom indicators"],limits:{portfolios:"Unlimited",watchlists:"Unlimited"},popular:!0,icon:(0,s.jsx)(n.Z,{className:"w-6 h-6"}),buttonText:"Start Premium Plan",buttonVariant:"premium"}],PricingPopup=e=>{var t,r;let{isOpen:i,onClose:n,feature:h,requiredPlan:m,title:p,description:g}=e,{user:f}=(0,d.useAuth)(),[x,y]=(0,a.useState)(null);if(!i)return null;let handleSubscribe=async e=>{y(e);try{let t=await fetch("/api/subscription/subscribe",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("access_token"))},body:JSON.stringify({plan:e,feature:h})});t.ok?window.location.href="/subscription/checkout?plan=".concat(e):console.error("Subscription failed")}catch(e){console.error("Subscription error:",e)}finally{y(null)}},b=m?u.filter(e=>"basic"===m||"premium"===e.id):u;return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between rounded-t-2xl",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:(()=>{if(p)return p;switch(h){case"/dashboard/analytics":return"Advanced Analytics";case"/dashboard/ai-insights":return"AI-Powered Insights";case"/dashboard/social-trading":return"Social Trading";case"/dashboard/institutional":return"Institutional Tools";default:return"Premium Feature"}})()}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:(()=>{if(g)return g;switch(h){case"/dashboard/analytics":return"Access advanced analytics and detailed market insights to make better trading decisions.";case"/dashboard/ai-insights":return"Get AI-powered market analysis and personalized trading recommendations.";case"/dashboard/social-trading":return"Follow top traders, copy their strategies, and share your own insights.";case"/dashboard/institutional":return"Access professional-grade tools used by institutional traders and fund managers.";default:return"This feature requires a subscription to access."}})()})]}),(0,s.jsx)("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,s.jsx)(o.Z,{className:"w-6 h-6"})})]}),f&&(0,s.jsx)("div",{className:"px-6 py-4 bg-blue-50 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(c.Z,{className:"w-5 h-5 text-blue-600"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"text-sm font-medium text-blue-900",children:["Current Plan: ",(null===(t=f.subscriptionPlan)||void 0===t?void 0:t.charAt(0).toUpperCase())+(null===(r=f.subscriptionPlan)||void 0===r?void 0:r.slice(1))||"Free"]}),(0,s.jsx)("p",{className:"text-xs text-blue-700",children:"Upgrade to access this feature and unlock more capabilities"})]})]})}),(0,s.jsx)("div",{className:"px-6 py-8",children:(0,s.jsx)("div",{className:"grid md:grid-cols-2 gap-6",children:b.map(e=>(0,s.jsxs)("div",{className:"relative rounded-xl border-2 p-6 ".concat(e.popular?"border-blue-500 bg-blue-50":"border-gray-200 bg-white"),children:[e.popular&&(0,s.jsx)("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:(0,s.jsx)("span",{className:"bg-blue-500 text-white px-3 py-1 rounded-full text-sm font-medium",children:"Most Popular"})}),(0,s.jsxs)("div",{className:"text-center mb-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-3",children:(0,s.jsx)("div",{className:"p-3 rounded-full ".concat(e.popular?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"),children:e.icon})}),(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:e.name}),(0,s.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:e.description}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("span",{className:"text-3xl font-bold text-gray-900",children:["$",e.price]}),(0,s.jsxs)("span",{className:"text-gray-600",children:["/",e.period]})]})]}),(0,s.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center py-1",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Portfolios:"}),(0,s.jsx)("span",{className:"font-medium",children:e.limits.portfolios})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center py-1",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Watchlists:"}),(0,s.jsx)("span",{className:"font-medium",children:e.limits.watchlists})]})]}),(0,s.jsx)("div",{className:"space-y-2",children:e.features.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.Z,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),(0,s.jsx)("span",{className:"text-sm text-gray-700",children:e})]},t))})]}),(0,s.jsx)("button",{onClick:()=>handleSubscribe(e.id),disabled:x===e.id,className:"w-full py-3 px-4 rounded-lg font-medium transition-colors ".concat("premium"===e.buttonVariant?"bg-gradient-to-r from-purple-600 to-blue-600 text-white hover:from-purple-700 hover:to-blue-700":"primary"===e.buttonVariant?"bg-blue-600 text-white hover:bg-blue-700":"border border-gray-300 text-gray-700 hover:bg-gray-50"," disabled:opacity-50 disabled:cursor-not-allowed"),children:x===e.id?"Processing...":e.buttonText})]},e.id))})}),(0,s.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 rounded-b-2xl",children:(0,s.jsx)("p",{className:"text-center text-sm text-gray-600",children:"All plans include a 7-day free trial. Cancel anytime."})})]})})};t.Z=PricingPopup},4590:function(e,t,r){r.d(t,{hJ:function(){return FeatureAccess},i1:function(){return ProtectedRoute}});var s=r(7437),a=r(2265),i=r(3286),n=r(7866),o=r(4075),c=r(4033),l=r(6264),d=r(5589),u=r(9036);let ProtectedRoute=e=>{let{children:t,requiredPlan:r="free",feature:u,title:h,description:m,fallback:p,redirectOnFail:g=!1}=e,{user:f,isLoading:x,checkSubscriptionAccess:y}=(0,i.useAuth)(),{popupState:b,showPricingPopup:v,hidePricingPopup:w}=(0,n.y)(),S=(0,c.useRouter)(),[N,j]=(0,a.useState)(null);return((0,a.useEffect)(()=>{if(!x&&f){let e=y(r);j(e),e||(g?S.push("/pricing?upgrade=true&feature="+encodeURIComponent(u||"premium")):"free"!==r&&v(u||"premium-feature",r,h,m))}},[f,x,r,u,h,m,y,v,g,S]),x||null===N)?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(l.Z,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):N?(0,s.jsxs)(s.Fragment,{children:[t,(0,s.jsx)(o.Z,{isOpen:b.isVisible,onClose:w,feature:b.feature,requiredPlan:b.plan,title:b.title,description:b.description})]}):p?(0,s.jsxs)(s.Fragment,{children:[p,(0,s.jsx)(o.Z,{isOpen:b.isVisible,onClose:w,feature:b.feature,requiredPlan:b.plan,title:b.title,description:b.description})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,s.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(d.Z,{className:"w-8 h-8 text-gray-400"})}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:h||"Premium Feature"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:m||"This feature requires a ".concat(r," subscription to access.")}),(0,s.jsx)("button",{onClick:()=>v(u||"premium-feature",r,h,m),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"View Pricing Plans"})]})}),(0,s.jsx)(o.Z,{isOpen:b.isVisible,onClose:w,feature:b.feature,requiredPlan:b.plan,title:b.title,description:b.description})]})},FeatureAccess=e=>{let{requiredPlan:t,feature:r,title:a,description:c,children:l,fallback:d,showUpgradeButton:h=!0}=e,{checkSubscriptionAccess:m}=(0,i.useAuth)(),{popupState:p,showPricingPopup:g,hidePricingPopup:f}=(0,n.y)(),x=m(t);return x?(0,s.jsx)(s.Fragment,{children:l}):d?(0,s.jsxs)(s.Fragment,{children:[d,(0,s.jsx)(o.Z,{isOpen:p.isVisible,onClose:f,feature:p.feature,requiredPlan:p.plan,title:p.title,description:p.description})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gray-50 bg-opacity-90 flex items-center justify-center z-10 rounded-lg",children:(0,s.jsxs)("div",{className:"text-center p-4",children:[(0,s.jsx)(u.Z,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:a||"".concat(t.charAt(0).toUpperCase()+t.slice(1)," plan required")}),h&&(0,s.jsx)("button",{onClick:()=>g(r||"premium-feature",t,a,c),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm font-medium hover:bg-blue-700 transition-colors",children:"Upgrade"})]})}),(0,s.jsx)("div",{className:"filter blur-sm pointer-events-none",children:l})]}),(0,s.jsx)(o.Z,{isOpen:p.isVisible,onClose:f,feature:p.feature,requiredPlan:p.plan,title:p.title,description:p.description})]})}},8458:function(e,t,r){r.d(t,{Z:function(){return components_RealTimeMarketData}});var s=r(7437),a=r(2265),i=r(7795),n=r(3219);let MarketDataService=class MarketDataService extends i.EventEmitter{initializeWebSocket(){try{this.wsConnection=new WebSocket("wss://api.finscope.com/ws"),this.wsConnection.onopen=()=>{console.log("Market data WebSocket connected"),this.reconnectAttempts=0,this.emit("connected"),this.sendWebSocketMessage({type:"subscribe",symbols:Array.from(this.subscriptions)})},this.wsConnection.onmessage=e=>{try{let t=JSON.parse(e.data);this.handleWebSocketMessage(t)}catch(e){console.error("Error parsing WebSocket message:",e)}},this.wsConnection.onclose=e=>{console.log("WebSocket connection closed:",e.code,e.reason),this.emit("disconnected"),this.scheduleReconnect()},this.wsConnection.onerror=e=>{console.error("WebSocket error:",e),this.emit("error",e)}}catch(e){console.error("WebSocket connection failed:",e),this.scheduleReconnect()}}handleWebSocketMessage(e){switch(e.type){case"price_update":this.handlePriceUpdate(e.data);break;case"market_update":this.handleMarketUpdate(e.data);break;case"status":console.log("WebSocket status:",e.data);break;case"error":console.error("WebSocket error message:",e.data);break;default:console.log("Unknown message type:",e.type)}}handlePriceUpdate(e){let t={symbol:e.symbol,price:e.price,change:e.change,changePercent:e.change_percent,volume:e.volume||0,high24h:e.high_24h||1.05*e.price,low24h:e.low_24h||.95*e.price,marketCap:e.market_cap,timestamp:new Date(e.timestamp).getTime()};this.priceCache.set(e.symbol,t),this.emit("priceUpdate",{symbol:e.symbol,data:t})}handleMarketUpdate(e){e.prices&&Object.entries(e.prices).forEach(e=>{let[t,r]=e;this.handlePriceUpdate({symbol:t,...r})})}sendWebSocketMessage(e){this.wsConnection&&this.wsConnection.readyState===WebSocket.OPEN&&this.wsConnection.send(JSON.stringify(e))}startPriceUpdates(){setInterval(()=>{this.symbols.forEach(e=>{let t=this.generateMockPriceData(e);this.updatePrice(e,t)})},2e3)}async updatePrice(e,t){this.priceCache.set(e,t),await n.$.cacheMarketData(e,t,60),await n.$.publish("price:".concat(e),t),this.emit("priceUpdate",{symbol:e,data:t})}generateMockPriceData(e){let t=this.getBasePrice(e),r=this.getVolatility(e),s=(Math.random()-.5)*r,a=t*(s/100),i=t+a,n=i*(1+.05*Math.random()),o=i*(1-.05*Math.random());return{symbol:e,price:Number(i.toFixed(2)),change:Number(a.toFixed(2)),changePercent:Number(s.toFixed(2)),volume:Math.floor(1e7*Math.random())+1e6,high24h:Number(n.toFixed(2)),low24h:Number(o.toFixed(2)),marketCap:this.calculateMarketCap(e,i),timestamp:Date.now()}}getBasePrice(e){return({AAPL:175.5,GOOGL:2850,MSFT:415.25,AMZN:3200,TSLA:245.8,META:485.6,NVDA:875.3,NFLX:425.9,"BTC-USD":43500,"ETH-USD":2650,"ADA-USD":.48,"SOL-USD":98.5,"DOT-USD":7.25,"MATIC-USD":.85,SPY:485.2,QQQ:395.8,IWM:198.5,GLD:185.3,SLV:22.45,VIX:15.8})[e]||100}getVolatility(e){return e.includes("BTC")||e.includes("ETH")?8:e.includes("USD")?12:"VIX"===e?15:"TSLA"===e?6:3}calculateMarketCap(e,t){let r={AAPL:15728e6,GOOGL:128e8,MSFT:743e7,AMZN:107e8,TSLA:317e7,META:265e7,NVDA:247e7,NFLX:442e6}[e];return r?Math.floor(r*t):void 0}async getCurrentPrice(e){let t=await n.$.getMarketData(e);if(t)return t;let r=this.priceCache.get(e);if(r)return r;let s=this.generateMockPriceData(e);return await this.updatePrice(e,s),s}async getMultiplePrices(e){let t={};return await Promise.all(e.map(async e=>{let r=await this.getCurrentPrice(e);r&&(t[e]=r)})),t}async getHistoricalData(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,s="historical:".concat(e,":").concat(t,":").concat(r),a=await n.$.get(s);if(a)return a;let i=this.generateMockHistoricalData(e,t,r);return await n.$.set(s,i,300),i}generateMockHistoricalData(e,t,r){let s=this.getBasePrice(e),a=this.getVolatility(e),i=[],n=this.getTimeframeMs(t),o=Date.now(),c=s;for(let e=r-1;e>=0;e--){let t=o-e*n,r=c,s=(Math.random()-.5)*(a/10),l=r*(1+s/100),d=Math.max(r,l)*(1+.02*Math.random()),u=Math.min(r,l)*(1-.02*Math.random()),h=Math.floor(5e6*Math.random())+5e5;i.push({timestamp:t,open:Number(r.toFixed(2)),high:Number(d.toFixed(2)),low:Number(u.toFixed(2)),close:Number(l.toFixed(2)),volume:h}),c=l}return i}getTimeframeMs(e){return({"1m":6e4,"5m":3e5,"15m":9e5,"30m":18e5,"1h":36e5,"4h":144e5,"1d":864e5,"1w":6048e5,"1M":2592e6})[e]}async getMarketStats(){let e="market:stats",t=await n.$.get(e);if(t)return t;let r=await this.getMultiplePrices(this.symbols),s=Object.values(r),a=[...s].sort((e,t)=>t.changePercent-e.changePercent),i=[...s].sort((e,t)=>t.volume-e.volume),o={totalMarketCap:s.reduce((e,t)=>e+(t.marketCap||0),0),totalVolume24h:s.reduce((e,t)=>e+t.volume,0),btcDominance:42.5,activeSymbols:this.symbols.length,topGainers:a.slice(0,5),topLosers:a.slice(-5).reverse(),mostActive:i.slice(0,5)};return await n.$.set(e,o,60),o}async getTechnicalIndicators(e){let t="indicators:".concat(e),r=await n.$.get(t);if(r)return r;let s=[{name:"RSI",value:100*Math.random(),signal:Math.random()>.5?"buy":Math.random()>.5?"sell":"neutral",timestamp:Date.now()},{name:"MACD",value:(Math.random()-.5)*10,signal:Math.random()>.5?"buy":Math.random()>.5?"sell":"neutral",timestamp:Date.now()},{name:"SMA_20",value:this.getBasePrice(e)*(.95+.1*Math.random()),signal:"neutral",timestamp:Date.now()}];return await n.$.set(t,s,120),s}subscribeToSymbol(e){this.subscriptions.add(e),this.wsConnection&&this.wsConnection.readyState===WebSocket.OPEN&&this.sendWebSocketMessage({type:"subscribe",symbols:[e]}),n.$.subscribe("price:".concat(e),t=>{this.emit("priceUpdate",{symbol:e,data:t})})}async unsubscribeFromSymbol(e){this.subscriptions.delete(e),this.wsConnection&&this.wsConnection.readyState===WebSocket.OPEN&&this.sendWebSocketMessage({type:"unsubscribe",symbols:[e]})}async fetchRealTimePrice(e){try{let t=await this.getCurrentPrice(e);if(t&&Date.now()-t.timestamp<3e4)return t;let r=await fetch("/api/v2/market-data/price/".concat(e),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"}});if(r.ok){let t=await r.json(),s={symbol:t.symbol,price:t.price,change:t.change,changePercent:t.change_percent,volume:t.volume,high24h:t.high_24h,low24h:t.low_24h,marketCap:t.market_cap,timestamp:Date.now()};return await this.updatePrice(e,s),s}}catch(t){console.error("Error fetching real-time price for ".concat(e,":"),t)}return null}async fetchMultipleRealTimePrices(e){try{let t=await fetch("/api/v2/market-data/prices",{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token")),"Content-Type":"application/json"},body:JSON.stringify({symbols:e})});if(t.ok){let e=await t.json(),r={};return Object.entries(e.prices||{}).forEach(e=>{let[t,s]=e;r[t]={symbol:t,price:s.price,change:s.change,changePercent:s.change_percent,volume:s.volume,high24h:s.high_24h,low24h:s.low_24h,marketCap:s.market_cap,timestamp:Date.now()},this.updatePrice(t,r[t])}),r}}catch(e){console.error("Error fetching multiple real-time prices:",e)}return await this.getMultiplePrices(e)}getSubscriptions(){return Array.from(this.subscriptions)}scheduleReconnect(){this.reconnectAttempts<this.maxReconnectAttempts&&setTimeout(()=>{this.reconnectAttempts++,this.initializeWebSocket()},this.reconnectDelay*Math.pow(2,this.reconnectAttempts))}disconnect(){this.wsConnection&&(this.wsConnection.close(),this.wsConnection=null),this.subscriptions.clear(),this.emit("disconnected")}isConnected(){var e;return(null===(e=this.wsConnection)||void 0===e?void 0:e.readyState)===WebSocket.OPEN}constructor(){super(),this.priceCache=new Map,this.wsConnection=null,this.subscriptions=new Set,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=1e3,this.symbols=["AAPL","GOOGL","MSFT","AMZN","TSLA","META","NVDA","NFLX","BTC-USD","ETH-USD","ADA-USD","SOL-USD","DOT-USD","MATIC-USD","SPY","QQQ","IWM","GLD","SLV","VIX"],this.initializeWebSocket(),this.startPriceUpdates()}};let o=new MarketDataService;var c=r(5790),l=r(4522),d=r(998),u=r(1298),h=r(2457),m=r(2369);let Card=e=>{let{children:t,className:r=""}=e;return(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 ".concat(r),children:t})},CardHeader=e=>{let{children:t}=e;return(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:t})},CardTitle=e=>{let{children:t,className:r=""}=e;return(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 ".concat(r),children:t})},CardContent=e=>{let{children:t}=e;return(0,s.jsx)("div",{className:"px-6 py-4",children:t})},Badge=e=>{let{children:t,variant:r="default"}=e;return(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat({default:"bg-gray-100 text-gray-800",success:"bg-green-100 text-green-800",destructive:"bg-red-100 text-red-800"}[r]),children:t})},Button=e=>{let{children:t,onClick:r,variant:a="default",size:i="default",disabled:n=!1}=e;return(0,s.jsx)("button",{onClick:r,disabled:n,className:"inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ".concat({default:"bg-blue-600 hover:bg-blue-700 text-white",outline:"border border-gray-300 bg-white hover:bg-gray-50 text-gray-700",ghost:"hover:bg-gray-100 text-gray-700"}[a]," ").concat({default:"px-4 py-2 text-sm",sm:"px-3 py-1.5 text-xs",lg:"px-6 py-3 text-base"}[i]),children:t})};var components_RealTimeMarketData=e=>{let{symbols:t=["BTC-USD","ETH-USD","AAPL","GOOGL","TSLA"],autoRefresh:r=!0,refreshInterval:i=5e3}=e,[n,p]=(0,a.useState)({}),[g,f]=(0,a.useState)(null),[x,y]=(0,a.useState)(!1),[b,v]=(0,a.useState)(!0),[w,S]=(0,a.useState)(null),[N,j]=(0,a.useState)(null);(0,a.useEffect)(()=>{let initializeService=async()=>{try{v(!0),o.on("connected",()=>{y(!0),S(null)}),o.on("disconnected",()=>{y(!1)}),o.on("error",e=>{S(e.message||"Connection error")}),o.on("priceUpdate",e=>{let{symbol:t,data:r}=e;p(e=>({...e,[t]:r})),j(new Date)}),t.forEach(e=>{o.subscribeToSymbol(e)}),await fetchInitialData()}catch(e){S("Failed to initialize market data service"),console.error("Market data initialization error:",e)}finally{v(!1)}};return initializeService(),()=>{t.forEach(e=>{o.unsubscribeFromSymbol(e)}),o.removeAllListeners()}},[t]),(0,a.useEffect)(()=>{if(!r)return;let e=setInterval(async()=>{await fetchLatestPrices()},i);return()=>clearInterval(e)},[r,i,t]);let fetchInitialData=async()=>{try{let e=await o.fetchMultipleRealTimePrices(t);p(e);let r=await o.getMarketStats();f(r),j(new Date)}catch(e){console.error("Error fetching initial data:",e),S("Failed to fetch initial market data")}},fetchLatestPrices=async()=>{try{let e=await o.fetchMultipleRealTimePrices(t);p(t=>({...t,...e})),j(new Date)}catch(e){console.error("Error fetching latest prices:",e)}},k=(0,a.useCallback)(async()=>{v(!0),await fetchInitialData(),v(!1)},[t]),formatPrice=e=>e>=1e3?e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):e.toFixed(e<1?6:2),formatChange=(e,t)=>{let r=e>=0;return{text:"".concat(r?"+":"").concat(e.toFixed(2)," (").concat(r?"+":"").concat(t.toFixed(2),"%)"),color:r?"text-green-600":"text-red-600",icon:r?(0,s.jsx)(c.Z,{className:"w-4 h-4"}):(0,s.jsx)(l.Z,{className:"w-4 h-4"})}},formatVolume=e=>e>=1e9?"".concat((e/1e9).toFixed(1),"B"):e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(1),"K"):e.toString(),formatMarketCap=e=>e>=1e12?"$".concat((e/1e12).toFixed(2),"T"):e>=1e9?"$".concat((e/1e9).toFixed(2),"B"):e>=1e6?"$".concat((e/1e6).toFixed(2),"M"):"$".concat(e.toLocaleString());return b&&0===Object.keys(n).length?(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-center p-8",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,s.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading market data..."})]})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Real-Time Market Data"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(x?"bg-green-500":"bg-red-500")}),(0,s.jsx)("span",{className:"text-sm ".concat(x?"text-green-600":"text-red-600"),children:x?"Connected":"Disconnected"})]}),N&&(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["Last update: ",N.toLocaleTimeString()]})]}),(0,s.jsxs)(Button,{onClick:k,disabled:b,variant:"outline",children:[(0,s.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),w&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,s.jsx)("div",{className:"flex",children:(0,s.jsxs)("div",{className:"text-red-800",children:[(0,s.jsx)("strong",{children:"Error:"})," ",w]})})}),g&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(Card,{children:(0,s.jsx)(CardContent,{children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(u.Z,{className:"h-8 w-8 text-blue-600"}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Market Cap"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:formatMarketCap(g.totalMarketCap)})]})]})})}),(0,s.jsx)(Card,{children:(0,s.jsx)(CardContent,{children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(h.Z,{className:"h-8 w-8 text-green-600"}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"24h Volume"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:formatVolume(g.totalVolume24h)})]})]})})}),(0,s.jsx)(Card,{children:(0,s.jsx)(CardContent,{children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(d.Z,{className:"h-8 w-8 text-purple-600"}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Symbols"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:g.activeSymbols})]})]})})}),(0,s.jsx)(Card,{children:(0,s.jsx)(CardContent,{children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(m.Z,{className:"h-8 w-8 text-yellow-600"}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"BTC Dominance"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:[g.btcDominance.toFixed(1),"%"]})]})]})})})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(e=>{let t=n[e];if(!t)return(0,s.jsxs)(Card,{children:[(0,s.jsx)(CardHeader,{children:(0,s.jsx)(CardTitle,{children:e})}),(0,s.jsx)(CardContent,{children:(0,s.jsxs)("div",{className:"animate-pulse",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})]},e);let r=formatChange(t.change,t.changePercent);return(0,s.jsxs)(Card,{className:"hover:shadow-lg transition-shadow",children:[(0,s.jsx)(CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(CardTitle,{children:e}),(0,s.jsx)(Badge,{variant:t.change>=0?"success":"destructive",children:r.icon})]})}),(0,s.jsx)(CardContent,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"text-3xl font-bold text-gray-900",children:["$",formatPrice(t.price)]}),(0,s.jsxs)("p",{className:"text-sm font-medium flex items-center ".concat(r.color),children:[r.icon,(0,s.jsx)("span",{className:"ml-1",children:r.text})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-600",children:"24h High"}),(0,s.jsxs)("p",{className:"font-semibold",children:["$",formatPrice(t.high24h)]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-600",children:"24h Low"}),(0,s.jsxs)("p",{className:"font-semibold",children:["$",formatPrice(t.low24h)]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-600",children:"Volume"}),(0,s.jsx)("p",{className:"font-semibold",children:formatVolume(t.volume)})]}),t.marketCap&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-600",children:"Market Cap"}),(0,s.jsx)("p",{className:"font-semibold",children:formatMarketCap(t.marketCap)})]})]}),(0,s.jsx)("div",{className:"pt-2 border-t border-gray-200",children:(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Updated: ",new Date(t.timestamp).toLocaleTimeString()]})})]})})]},e)})}),g&&(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)(Card,{children:[(0,s.jsx)(CardHeader,{children:(0,s.jsxs)(CardTitle,{className:"flex items-center",children:[(0,s.jsx)(c.Z,{className:"w-5 h-5 text-green-600 mr-2"}),"Top Gainers"]})}),(0,s.jsx)(CardContent,{children:(0,s.jsx)("div",{className:"space-y-3",children:g.topGainers.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900 w-16",children:e.symbol}),(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:["$",formatPrice(e.price)]})]}),(0,s.jsxs)(Badge,{variant:"success",children:["+",e.changePercent.toFixed(2),"%"]})]},e.symbol))})})]}),(0,s.jsxs)(Card,{children:[(0,s.jsx)(CardHeader,{children:(0,s.jsxs)(CardTitle,{className:"flex items-center",children:[(0,s.jsx)(l.Z,{className:"w-5 h-5 text-red-600 mr-2"}),"Top Losers"]})}),(0,s.jsx)(CardContent,{children:(0,s.jsx)("div",{className:"space-y-3",children:g.topLosers.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900 w-16",children:e.symbol}),(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:["$",formatPrice(e.price)]})]}),(0,s.jsxs)(Badge,{variant:"destructive",children:[e.changePercent.toFixed(2),"%"]})]},e.symbol))})})]})]})]})}},9950:function(e,t,r){r.d(t,{X:function(){return l},bZ:function(){return o}});var s=r(7437),a=r(2265),i=r(5789);let n={default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"},o=a.forwardRef((e,t)=>{let{className:r,variant:a="default",...o}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)("relative w-full rounded-lg border p-4 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",n[a],r),...o})});o.displayName="Alert";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",r),...a})});c.displayName="AlertTitle";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",r),...a})});l.displayName="AlertDescription"},150:function(e,t,r){r.d(t,{C:function(){return o}});var s=r(7437),a=r(2265),i=r(5789);let n={default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"},o=a.forwardRef((e,t)=>{let{className:r,variant:a="default",...o}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",n[a],r),...o})});o.displayName="Badge"},3089:function(e,t,r){r.d(t,{z:function(){return o}});var s=r(7437),a=r(2265),i=r(5789);let n={variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},o=a.forwardRef((e,t)=>{let{className:r,variant:a="default",size:o="default",...c}=e;return(0,s.jsx)("button",{className:(0,i.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",n.variant[a],n.size[o],r),ref:t,...c})});o.displayName="Button"},609:function(e,t,r){r.d(t,{Ol:function(){return o},Zb:function(){return n},aY:function(){return d},ll:function(){return c}});var s=r(7437),a=r(2265),i=r(5789);let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});n.displayName="Card";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",r),...a})});o.displayName="CardHeader";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});c.displayName="CardTitle";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...a})});l.displayName="CardDescription";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",r),...a})});d.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},6582:function(e,t,r){r.d(t,{I:function(){return n}});var s=r(7437),a=r(2265),i=r(5789);let n=a.forwardRef((e,t)=>{let{className:r,type:a,...n}=e;return(0,s.jsx)("input",{type:a,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...n})});n.displayName="Input"},6429:function(e,t,r){r.d(t,{_:function(){return n}});var s=r(7437),a=r(2265),i=r(5789);let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("label",{ref:t,className:(0,i.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),...a})});n.displayName="Label"},1735:function(e,t,r){r.d(t,{Bw:function(){return d},Ph:function(){return o},Ql:function(){return u},i4:function(){return c},ki:function(){return l}});var s=r(7437),a=r(2265),i=r(5789);let n=a.createContext({open:!1,setOpen:()=>{}}),o=a.forwardRef((e,t)=>{let{value:r,onValueChange:i,defaultValue:o,children:c}=e,[l,d]=a.useState(o||""),[u,h]=a.useState(!1),m=void 0!==r?r:l,p=a.useCallback(e=>{void 0===r&&d(e),null==i||i(e),h(!1)},[r,i]);return(0,s.jsx)(n.Provider,{value:{value:m,onValueChange:p,open:u,setOpen:h},children:(0,s.jsx)("div",{ref:t,className:"relative",children:c})})});o.displayName="Select";let c=a.forwardRef((e,t)=>{let{className:r,children:o,...c}=e,l=a.useContext(n);return(0,s.jsxs)("button",{ref:t,type:"button",className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),onClick:()=>l.setOpen(!l.open),...c,children:[o,(0,s.jsx)("svg",{className:"h-4 w-4 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})});c.displayName="SelectTrigger";let l=a.forwardRef((e,t)=>{let{className:r,placeholder:o,...c}=e,l=a.useContext(n);return(0,s.jsx)("span",{ref:t,className:(0,i.cn)("block truncate",r),...c,children:l.value||o})});l.displayName="SelectValue";let d=a.forwardRef((e,t)=>{let{className:r,children:o,...c}=e,l=a.useContext(n);return l.open?(0,s.jsx)("div",{ref:t,className:(0,i.cn)("absolute top-full z-50 mt-1 max-h-60 w-full overflow-auto rounded-md border bg-popover text-popover-foreground shadow-md",r),...c,children:o}):null});d.displayName="SelectContent";let u=a.forwardRef((e,t)=>{let{className:r,children:o,value:c,...l}=e,d=a.useContext(n),u=d.value===c;return(0,s.jsxs)("div",{ref:t,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none hover:bg-accent hover:text-accent-foreground",u&&"bg-accent text-accent-foreground",r),onClick:()=>{var e;return null===(e=d.onValueChange)||void 0===e?void 0:e.call(d,c)},...l,children:[u&&(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),o]})});u.displayName="SelectItem"},7461:function(e,t,r){r.d(t,{SP:function(){return l},dr:function(){return c},mQ:function(){return o},nU:function(){return d}});var s=r(7437),a=r(2265),i=r(5789);let n=a.createContext({}),o=a.forwardRef((e,t)=>{let{defaultValue:r,value:o,onValueChange:c,children:l,className:d,...u}=e,[h,m]=a.useState(r||""),p=void 0!==o?o:h,g=a.useCallback(e=>{void 0===o&&m(e),null==c||c(e)},[o,c]);return(0,s.jsx)(n.Provider,{value:{value:p,onValueChange:g},children:(0,s.jsx)("div",{ref:t,className:(0,i.cn)("w-full",d),...u,children:l})})});o.displayName="Tabs";let c=a.forwardRef((e,t)=>{let{className:r,children:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...n,children:a})});c.displayName="TabsList";let l=a.forwardRef((e,t)=>{let{className:r,children:o,value:c,...l}=e,d=a.useContext(n),u=d.value===c;return(0,s.jsx)("button",{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",u?"bg-background text-foreground shadow-sm":"hover:bg-background/50",r),onClick:()=>{var e;return null===(e=d.onValueChange)||void 0===e?void 0:e.call(d,c)},...l,children:o})});l.displayName="TabsTrigger";let d=a.forwardRef((e,t)=>{let{className:r,children:o,value:c,...l}=e,d=a.useContext(n),u=d.value===c;return u?(0,s.jsx)("div",{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...l,children:o}):null});d.displayName="TabsContent"},3286:function(e,t,r){r.r(t),r.d(t,{AuthProvider:function(){return AuthProvider},useAuth:function(){return useAuth}});var s=r(7437),a=r(2265),i=r(4033),n=r(3219);let SessionService=class SessionService{async createSession(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s={...this.defaultOptions,...r},a="".concat(this.SESSION_PREFIX).concat(e),i="".concat(this.USER_SESSIONS_PREFIX).concat(t.userId);try{await n.$.setHash(a,{userId:t.userId,username:t.username,email:t.email,role:t.role,permissions:JSON.stringify(t.permissions),loginTime:t.loginTime.toString(),lastActivity:t.lastActivity.toString(),ipAddress:t.ipAddress,userAgent:t.userAgent,deviceId:t.deviceId||""}),await n.$.expire(a,s.maxAge),await n.$.addToSortedSet(i,e,Date.now()),await n.$.expire(i,s.maxAge),await n.$.addToSortedSet(this.ACTIVE_SESSIONS_PREFIX,e,Date.now()),s.maxConcurrentSessions>0&&await this.enforceConcurrentSessionLimit(t.userId,s.maxConcurrentSessions),s.trackActivity&&await this.trackActivity(e,"session_created",{ipAddress:t.ipAddress,userAgent:t.userAgent})}catch(e){throw console.error("Error creating session:",e),Error("Failed to create session")}}async getSession(e){try{let t="".concat(this.SESSION_PREFIX).concat(e),r=await n.$.getHash(t);if(!r||0===Object.keys(r).length)return null;return{userId:r.userId,username:r.username,email:r.email,role:r.role,permissions:JSON.parse(r.permissions||"[]"),loginTime:parseInt(r.loginTime),lastActivity:parseInt(r.lastActivity),ipAddress:r.ipAddress,userAgent:r.userAgent,deviceId:r.deviceId||void 0}}catch(e){return console.error("Error getting session:",e),null}}async updateActivity(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r={...this.defaultOptions,...t},s="".concat(this.SESSION_PREFIX).concat(e),a=await n.$.exists(s);if(!a)return!1;let i=Date.now();return await n.$.setHashField(s,"lastActivity",i.toString()),r.extendOnActivity&&await n.$.expire(s,r.maxAge),r.trackActivity&&await this.trackActivity(e,"activity_update"),!0}catch(e){return console.error("Error updating session activity:",e),!1}}async destroySession(e){try{let t="".concat(this.SESSION_PREFIX).concat(e),r=await this.getSession(e);if(!r)return!1;await n.$.delete(t);let s="".concat(this.USER_SESSIONS_PREFIX).concat(r.userId);return await n.$.removeFromSortedSet(s,e),await n.$.removeFromSortedSet(this.ACTIVE_SESSIONS_PREFIX,e),await this.trackActivity(e,"session_destroyed"),!0}catch(e){return console.error("Error destroying session:",e),!1}}async getUserSessions(e){try{let t="".concat(this.USER_SESSIONS_PREFIX).concat(e),r=await n.$.getSortedSetRange(t,0,-1),s=[];for(let e of r){let r="".concat(this.SESSION_PREFIX).concat(e),a=await n.$.exists(r);a?s.push(e):await n.$.removeFromSortedSet(t,e)}return s}catch(e){return console.error("Error getting user sessions:",e),[]}}async destroyUserSessions(e,t){try{let r=await this.getUserSessions(e),s=0;for(let e of r){if(t&&e===t)continue;let r=await this.destroySession(e);r&&s++}return s}catch(e){return console.error("Error destroying user sessions:",e),0}}async getSessionStats(){try{let e=Date.now(),t=e-864e5,r=e-36e5,s=await n.$.getSortedSetCount(this.ACTIVE_SESSIONS_PREFIX),a=await n.$.getSortedSetCountByScore(this.ACTIVE_SESSIONS_PREFIX,t,e),i=await n.$.getSortedSetCountByScore(this.ACTIVE_SESSIONS_PREFIX,r,e);return{totalActiveSessions:s,sessionsLast24h:a,sessionsLastHour:i}}catch(e){return console.error("Error getting session stats:",e),{totalActiveSessions:0,sessionsLast24h:0,sessionsLastHour:0}}}async cleanupExpiredSessions(){try{let e=Date.now(),t=e-1e3*this.defaultOptions.maxAge,r=await n.$.getSortedSetRangeByScore(this.ACTIVE_SESSIONS_PREFIX,0,t),s=0;for(let e of r){let t="".concat(this.SESSION_PREFIX).concat(e),r=await n.$.exists(t);!r&&(await n.$.removeFromSortedSet(this.ACTIVE_SESSIONS_PREFIX,e),s++)}return s}catch(e){return console.error("Error cleaning up expired sessions:",e),0}}async enforceConcurrentSessionLimit(e,t){try{let r=await this.getUserSessions(e);if(r.length>t){let e=await Promise.all(r.map(async e=>{let t=await this.getSession(e);return{sessionId:e,lastActivity:(null==t?void 0:t.lastActivity)||0}}));e.sort((e,t)=>e.lastActivity-t.lastActivity);let s=e.slice(0,r.length-t);for(let{sessionId:e}of s)await this.destroySession(e)}}catch(e){console.error("Error enforcing concurrent session limit:",e)}}async trackActivity(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let s="".concat(this.SESSION_ACTIVITY_PREFIX).concat(e),a={type:t,timestamp:Date.now(),...r};await n.$.addToList(s,JSON.stringify(a)),await n.$.trimList(s,0,99),await n.$.expire(s,this.defaultOptions.maxAge)}catch(e){console.error("Error tracking session activity:",e)}}async getSessionActivity(e){try{let t="".concat(this.SESSION_ACTIVITY_PREFIX).concat(e),r=await n.$.getListRange(t,0,-1);return r.map(e=>{try{return JSON.parse(e)}catch(e){return{type:"unknown",timestamp:0}}})}catch(e){return console.error("Error getting session activity:",e),[]}}constructor(){this.SESSION_PREFIX="session:",this.USER_SESSIONS_PREFIX="user_sessions:",this.ACTIVE_SESSIONS_PREFIX="active_sessions",this.SESSION_ACTIVITY_PREFIX="session_activity:",this.defaultOptions={maxAge:86400,maxConcurrentSessions:5,extendOnActivity:!0,trackActivity:!0}}};let o=new SessionService,c=(0,a.createContext)(void 0),useAuth=()=>{let e=(0,a.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},AuthProvider=e=>{let{children:t}=e,[r,n]=(0,a.useState)(null),[l,d]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null),m=(0,i.useRouter)(),p=!!r;(0,a.useEffect)(()=>{{let e=window.location.pathname,t=e.startsWith("/auth/")||e.startsWith("/landing")||"/"===e;t?d(!1):checkAuthStatus()}},[]);let checkAuthStatus=async()=>{try{let t=await fetch("/api/auth/me",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(t.ok){let r=await t.json();if(r.success&&r.data){var e;let t={...r.data,subscriptionPlan:(null===(e=r.data.subscription_plan)||void 0===e?void 0:e.toLowerCase())||"free"};n(t)}else n(null)}else n(null),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}catch(e){console.error("Auth check failed:",e),n(null),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}finally{d(!1)}},login=async(e,t,s,a)=>{try{let i=await fetch("/api/auth/login",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,captcha_token:s,remember_me:a})}),n=await i.json();if(!i.ok)return{success:!1,error:n.error||"Login failed",requiresCaptcha:n.requires_captcha};if(await checkAuthStatus(),r){let e="session_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),t={userId:r.id,username:r.email,email:r.email,role:r.role||"user",permissions:[],loginTime:Date.now(),lastActivity:Date.now(),userAgent:navigator.userAgent,ipAddress:"client-side"};await o.createSession(e,t),h(e)}return{success:!0}}catch(e){return console.error("Login error:",e),{success:!1,error:"Network error. Please try again."}}},register=async e=>{try{var t;let r=(null===(t=e.captcha)||void 0===t?void 0:t.split(":"))||[],s=r[0]||"",a=r[1]||"",i=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email,password:e.password,first_name:e.firstName,last_name:e.lastName,captcha_id:s,captcha_answer:a,acceptTerms:e.acceptTerms,acceptPrivacy:e.acceptPrivacy,marketingEmails:e.marketingEmails})}),n=await i.json();if(!i.ok)return{success:!1,error:n.detail||"Registration failed"};{let t=await login(e.email,e.password);if(t.success)return{success:!0};return{success:!0,message:"Registration successful. Please log in manually."}}}catch(e){return console.error("Registration error:",e),{success:!1,error:"Network error. Please try again."}}},logout=async e=>{try{if(u){if(e&&r){let e=await o.getUserSessions(r.id);await Promise.all(e.map(e=>o.destroySession(e)))}else await o.destroySession(u);h(null)}await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch(e){console.error("Logout API error:",e)}localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),n(null),m.push("/landing")},refreshToken=async()=>{try{let e=await fetch("/api/auth/refresh",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok)return await checkAuthStatus(),!0;return n(null),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),!1}catch(e){return console.error("Token refresh error:",e),n(null),!1}},resendVerificationEmail=async()=>{try{let e=await fetch("/api/auth/resend-verification",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}}),t=await e.json();if(e.ok)return{success:!0};return{success:!1,error:t.detail||"Failed to resend verification email"}}catch(e){return console.error("Resend verification error:",e),{success:!1,error:"Network error. Please try again."}}},forgotPassword=async(e,t)=>{try{let r=await fetch("/api/auth/password-reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,captcha_token:t})}),s=await r.json();if(r.ok)return{success:!0};return{success:!1,error:s.detail||"Failed to send reset email",requiresCaptcha:s.requires_captcha}}catch(e){return console.error("Forgot password error:",e),{success:!1,error:"Network error. Please try again."}}},resetPassword=async(e,t)=>{try{let r=await fetch("/api/auth/reset-password-confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,new_password:t})}),s=await r.json();if(r.ok)return{success:!0};return{success:!1,error:s.detail||"Failed to reset password"}}catch(e){return console.error("Reset password error:",e),{success:!1,error:"Network error. Please try again."}}},verifyEmail=async e=>{try{let t=await fetch("/api/auth/verify-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})}),s=await t.json();if(t.ok)return r&&n({...r,isEmailVerified:!0}),{success:!0};return{success:!1,error:s.detail||"Email verification failed"}}catch(e){return console.error("Email verification error:",e),{success:!1,error:"Network error. Please try again."}}},isFeatureAvailableForFree=e=>["basic_market_data","portfolio_tracking","basic_charts"].includes(e),isFeatureAvailableForBasic=e=>["real_time_data","advanced_charts","price_alerts","technical_indicators"].includes(e),getSubscriptionLimits=()=>{if(!r)return{maxPortfolios:1,maxWatchlists:1,advancedAnalytics:!1,aiInsights:!1,socialTrading:!1,institutionalTools:!1,prioritySupport:!1};switch(r.subscriptionPlan){case"free":return{maxPortfolios:1,maxWatchlists:3,advancedAnalytics:!1,aiInsights:!1,socialTrading:!1,institutionalTools:!1,prioritySupport:!1};case"basic":return{maxPortfolios:5,maxWatchlists:10,advancedAnalytics:!0,aiInsights:!1,socialTrading:!0,institutionalTools:!1,prioritySupport:!1};case"premium":return{maxPortfolios:-1,maxWatchlists:-1,advancedAnalytics:!0,aiInsights:!0,socialTrading:!0,institutionalTools:!0,prioritySupport:!0};default:return getSubscriptionLimits()}},refreshSubscription=async()=>{if(r)try{let e=localStorage.getItem("access_token"),t=await fetch("/api/auth/subscription",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(t.ok){let e=await t.json();n({...r,subscriptionPlan:e.plan,subscriptionStatus:e.status,trialEndsAt:e.trial_ends_at,subscriptionEndsAt:e.subscription_ends_at})}}catch(e){console.error("Failed to refresh subscription:",e)}},getActiveSessions=async()=>{if(!r)return[];try{return await o.getUserSessions(r.id)}catch(e){return console.error("Failed to get active sessions:",e),[]}},terminateSession=async e=>{try{return await o.destroySession(e),!0}catch(e){return console.error("Failed to terminate session:",e),!1}},refreshSession=async()=>{if(!u)return!1;try{return await o.updateActivity(u),!0}catch(e){return console.error("Failed to refresh session:",e),!1}};return(0,s.jsx)(c.Provider,{value:{user:r,isLoading:l,isAuthenticated:p,sessionId:u,login,register,logout,refreshToken,updateUser:e=>{r&&n({...r,...e})},resendVerificationEmail,forgotPassword,resetPassword,verifyEmail,hasFeatureAccess:e=>{if(!r)return!1;let t=r.subscriptionPlan,s=r.subscriptionStatus;if("expired"===s||"cancelled"===s)return"free"===t&&isFeatureAvailableForFree(e);switch(t){case"free":return isFeatureAvailableForFree(e);case"basic":return isFeatureAvailableForFree(e)||isFeatureAvailableForBasic(e);case"premium":return!0;default:return!1}},checkSubscriptionAccess:e=>{if(!r)return!1;let t={free:0,basic:1,premium:2},s=t[r.subscriptionPlan],a=t[e];return"expired"===r.subscriptionStatus||"cancelled"===r.subscriptionStatus?"free"===r.subscriptionPlan&&"free"===e:s>=a},getSubscriptionLimits,refreshSubscription,getActiveSessions,terminateSession,refreshSession},children:t})}},7866:function(e,t,r){r.d(t,{y:function(){return usePricingPopup}});var s=r(2265);let usePricingPopup=()=>{let[e,t]=(0,s.useState)({isVisible:!1}),r=(0,s.useCallback)((e,r,s,a)=>{t({isVisible:!0,feature:e,plan:r,title:s,description:a})},[]),a=(0,s.useCallback)(()=>{t({isVisible:!1})},[]);return{popupState:e,showPricingPopup:r,hidePricingPopup:a,isPricingPopupVisible:e.isVisible}}},3219:function(e,t,r){r.d(t,{$:function(){return s}});let SimpleEventEmitter=class SimpleEventEmitter{on(e,t){this.events.has(e)||this.events.set(e,[]),this.events.get(e).push(t)}emit(e){for(var t=arguments.length,r=Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];let a=this.events.get(e);a&&a.forEach(e=>e(...r))}removeListener(e,t){let r=this.events.get(e);if(r){let e=r.indexOf(t);e>-1&&r.splice(e,1)}}constructor(){this.events=new Map}};let MockRedisClient=class MockRedisClient extends SimpleEventEmitter{async get(e){return this.data.get(e)||null}async set(e,t,r){return this.data.set(e,t),(null==r?void 0:r.EX)&&setTimeout(()=>this.data.delete(e),1e3*r.EX),(null==r?void 0:r.PX)&&setTimeout(()=>this.data.delete(e),r.PX),"OK"}async del(e){let t=this.data.has(e);return this.data.delete(e),this.hashes.delete(e),this.lists.delete(e),this.sortedSets.delete(e),t?1:0}async exists(e){return this.data.has(e)?1:0}async expire(e,t){return this.data.has(e)?(setTimeout(()=>this.data.delete(e),1e3*t),1):0}async hget(e,t){let r=this.hashes.get(e);return(null==r?void 0:r.get(t))||null}async hset(e,t,r){this.hashes.has(e)||this.hashes.set(e,new Map);let s=this.hashes.get(e),a=!s.has(t);return s.set(t,r),a?1:0}async hgetall(e){let t=this.hashes.get(e);return t?Object.fromEntries(t.entries()):{}}async hdel(e,t){let r=this.hashes.get(e);return r&&r.has(t)?(r.delete(t),1):0}async lpush(e,t){this.lists.has(e)||this.lists.set(e,[]);let r=this.lists.get(e);return r.unshift(t),r.length}async rpush(e,t){this.lists.has(e)||this.lists.set(e,[]);let r=this.lists.get(e);return r.push(t),r.length}async lpop(e){let t=this.lists.get(e);return(null==t?void 0:t.shift())||null}async rpop(e){let t=this.lists.get(e);return(null==t?void 0:t.pop())||null}async lrange(e,t,r){let s=this.lists.get(e)||[];return s.slice(t,-1===r?void 0:r+1)}async zadd(e,t,r){this.sortedSets.has(e)||this.sortedSets.set(e,new Map);let s=this.sortedSets.get(e),a=!s.has(r);return s.set(r,t),a?1:0}async zrange(e,t,r,s){let a=this.sortedSets.get(e);if(!a)return[];let i=Array.from(a.entries()).sort((e,t)=>e[1]-t[1]),n=i.slice(t,-1===r?void 0:r+1);return(null==s?void 0:s.WITHSCORES)?n.flatMap(e=>{let[t,r]=e;return[t,r.toString()]}):n.map(e=>{let[t]=e;return t})}async zrevrange(e,t,r,s){let a=this.sortedSets.get(e);if(!a)return[];let i=Array.from(a.entries()).sort((e,t)=>t[1]-e[1]),n=i.slice(t,-1===r?void 0:r+1);return(null==s?void 0:s.WITHSCORES)?n.flatMap(e=>{let[t,r]=e;return[t,r.toString()]}):n.map(e=>{let[t]=e;return t})}async zrem(e,t){let r=this.sortedSets.get(e);return r&&r.has(t)?(r.delete(t),1):0}async publish(e,t){let r=this.subscribers.get(e);return r?(r.forEach(e=>e(t)),r.size):0}async subscribe(e){console.log("Subscribed to channel: ".concat(e))}async unsubscribe(e){this.subscribers.delete(e),console.log("Unsubscribed from channel: ".concat(e))}async disconnect(){this.data.clear(),this.hashes.clear(),this.lists.clear(),this.sortedSets.clear(),this.subscribers.clear()}constructor(...e){super(...e),this.data=new Map,this.hashes=new Map,this.lists=new Map,this.sortedSets=new Map,this.subscribers=new Map}};let RedisService=class RedisService extends SimpleEventEmitter{async connect(){try{this.isConnected=!0,this.emit("connected"),console.log("Redis service connected (mock mode)")}catch(e){throw this.emit("error",e),e}}async disconnect(){this.client&&(await this.client.disconnect(),this.isConnected=!1,this.emit("disconnected"))}async get(e){try{let t=await this.client.get(e);return t?JSON.parse(t):null}catch(t){return console.error("Redis GET error for key ".concat(e,":"),t),null}}async set(e,t,r){try{let s=JSON.stringify(t),a=r?{EX:r}:{EX:this.config.defaultTTL};return await this.client.set(e,s,a),!0}catch(t){return console.error("Redis SET error for key ".concat(e,":"),t),!1}}async del(e){try{let t=await this.client.del(e);return t>0}catch(t){return console.error("Redis DEL error for key ".concat(e,":"),t),!1}}async exists(e){try{let t=await this.client.exists(e);return t>0}catch(t){return console.error("Redis EXISTS error for key ".concat(e,":"),t),!1}}async hget(e,t){try{let r=await this.client.hget(e,t);return r?JSON.parse(r):null}catch(r){return console.error("Redis HGET error for key ".concat(e,", field ").concat(t,":"),r),null}}async hset(e,t,r){try{let s=JSON.stringify(r);return await this.client.hset(e,t,s),!0}catch(r){return console.error("Redis HSET error for key ".concat(e,", field ").concat(t,":"),r),!1}}async hgetall(e){try{let t=await this.client.hgetall(e),r={};for(let[e,s]of Object.entries(t))try{r[e]=JSON.parse(s)}catch(t){r[e]=s}return r}catch(t){return console.error("Redis HGETALL error for key ".concat(e,":"),t),{}}}async hdel(e,t){try{return await this.client.hdel(e,t)}catch(r){return console.error("Redis HDEL error for key ".concat(e,", field ").concat(t,":"),r),0}}async lpush(e,t){try{let r=JSON.stringify(t);return await this.client.lpush(e,r)}catch(t){return console.error("Redis LPUSH error for key ".concat(e,":"),t),0}}async rpop(e){try{let t=await this.client.rpop(e);return t?JSON.parse(t):null}catch(t){return console.error("Redis RPOP error for key ".concat(e,":"),t),null}}async lrange(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;try{let s=await this.client.lrange(e,t,r);return s.map(e=>{try{return JSON.parse(e)}catch(t){return e}})}catch(t){return console.error("Redis LRANGE error for key ".concat(e,":"),t),[]}}async zadd(e,t,r){try{let s=await this.client.zadd(e,t,r);return s>0}catch(t){return console.error("Redis ZADD error for key ".concat(e,":"),t),!1}}async zrevrange(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{return await this.client.zrevrange(e,t,r,{WITHSCORES:s})}catch(t){return console.error("Redis ZREVRANGE error for key ".concat(e,":"),t),[]}}async publish(e,t){try{let r="string"==typeof t?t:JSON.stringify(t);return await this.client.publish(e,r)}catch(t){return console.error("Redis PUBLISH error for channel ".concat(e,":"),t),0}}async subscribe(e,t){try{await this.client.subscribe(e),this.client.on("message",(r,s)=>{if(r===e)try{let e=JSON.parse(s);t(e)}catch(e){t(s)}})}catch(t){console.error("Redis SUBSCRIBE error for channel ".concat(e,":"),t)}}async cacheMarketData(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60;await this.set("market:".concat(e),t,r)}async getMarketData(e){return await this.get("market:".concat(e))}async cacheNews(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1800;await this.set("news:".concat(e),t,r)}async getNews(e){return await this.get("news:".concat(e))}async cacheUserSession(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:86400;await this.hset("session:".concat(e),"data",t),await this.client.expire("session:".concat(e),r)}async getUserSession(e){return await this.hget("session:".concat(e),"data")}async addTradeOrder(e){await this.lpush("trade:orders",e)}async getNextTradeOrder(){return await this.rpop("trade:orders")}async updateLeaderboard(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"trading";await this.zadd("leaderboard:".concat(r),t,e)}async getLeaderboard(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"trading",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return await this.zrevrange("leaderboard:".concat(e),0,t-1,!0)}async updateTradingPerformance(e,t){let r=Date.now();await Promise.all([this.zadd("leaderboard:return",t.totalReturn,e),this.zadd("leaderboard:winrate",t.winRate,e),this.zadd("leaderboard:sharpe",t.sharpeRatio,e),this.zadd("leaderboard:trades",t.totalTrades,e),this.zadd("leaderboard:followers",t.followers,e),this.zadd("leaderboard:aum",t.aum,e),this.hset("user:".concat(e,":metrics"),{totalReturn:t.totalReturn.toString(),winRate:t.winRate.toString(),sharpeRatio:t.sharpeRatio.toString(),totalTrades:t.totalTrades.toString(),followers:t.followers.toString(),aum:t.aum.toString(),lastUpdated:r.toString()})])}async getTopTraders(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"return",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{let r=await this.zrevrange("leaderboard:".concat(e),0,t-1,!0),s=[];for(let e=0;e<r.length;e+=2){let t=r[e],a=parseFloat(r[e+1]),i=await this.hgetall("user:".concat(t,":metrics"));s.push({userId:t,score:a,rank:Math.floor(e/2)+1,metrics:i?{totalReturn:parseFloat(i.totalReturn||"0"),winRate:parseFloat(i.winRate||"0"),sharpeRatio:parseFloat(i.sharpeRatio||"0"),totalTrades:parseInt(i.totalTrades||"0"),followers:parseInt(i.followers||"0"),aum:parseFloat(i.aum||"0"),lastUpdated:parseInt(i.lastUpdated||"0")}:null})}return s}catch(e){return console.error("Error getting top traders:",e),[]}}async getUserRank(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"return";try{let r=await this.client.zrevrank("leaderboard:".concat(t),e);return null!==r?r+1:null}catch(e){return console.error("Error getting user rank:",e),null}}async updatePeriodLeaderboard(e,t,r,s){let a=new Date,i="";switch(s){case"daily":i="".concat(a.getFullYear(),"-").concat(String(a.getMonth()+1).padStart(2,"0"),"-").concat(String(a.getDate()).padStart(2,"0"));break;case"weekly":let n=new Date(a.setDate(a.getDate()-a.getDay()));i="".concat(n.getFullYear(),"-W").concat(Math.ceil(n.getDate()/7));break;case"monthly":i="".concat(a.getFullYear(),"-").concat(String(a.getMonth()+1).padStart(2,"0"))}await this.zadd("leaderboard:".concat(r,":").concat(s,":").concat(i),t,e);let o="daily"===s?604800:"weekly"===s?2592e3:31536e3;await this.client.expire("leaderboard:".concat(r,":").concat(s,":").concat(i),o)}async getPeriodLeaderboard(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,s=new Date,a="";switch(t){case"daily":a="".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0"),"-").concat(String(s.getDate()).padStart(2,"0"));break;case"weekly":let i=new Date(s.setDate(s.getDate()-s.getDay()));a="".concat(i.getFullYear(),"-W").concat(Math.ceil(i.getDate()/7));break;case"monthly":a="".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0"))}try{let s=await this.zrevrange("leaderboard:".concat(e,":").concat(t,":").concat(a),0,r-1,!0),i=[];for(let e=0;e<s.length;e+=2){let t=s[e],r=parseFloat(s[e+1]);i.push({userId:t,score:r,rank:Math.floor(e/2)+1})}return i}catch(e){return console.error("Error getting period leaderboard:",e),[]}}async addPaperTradingOrder(e){try{await this.lpush("paper_trading_orders",e)}catch(e){throw console.error("Error adding paper trading order:",e),e}}async getNextPaperTradingOrder(){try{return await this.rpop("paper_trading_orders")}catch(e){return console.error("Error getting next paper trading order:",e),null}}async subscribeToOrderUpdates(e){try{await this.subscribe("order_updates",e)}catch(e){throw console.error("Error subscribing to order updates:",e),e}}async publishOrderUpdate(e){try{await this.publish("order_updates",e)}catch(e){throw console.error("Error publishing order update:",e),e}}async cacheQueueStats(e){try{await this.hset("queue_stats","pending",e.pending.toString()),await this.hset("queue_stats","processing",e.processing.toString()),await this.hset("queue_stats","completed",e.completed.toString())}catch(e){throw console.error("Error caching queue stats:",e),e}}async getQueueStats(){try{let e=await this.hgetall("queue_stats");return{pending:parseInt(e.pending||"0"),processing:parseInt(e.processing||"0"),completed:parseInt(e.completed||"0")}}catch(e){return console.error("Error getting queue stats:",e),{pending:0,processing:0,completed:0}}}isHealthy(){return this.isConnected}constructor(e={}){super(),this.isConnected=!1,this.config={defaultTTL:3600,maxRetries:3,retryDelay:1e3,...e},this.client=new MockRedisClient,this.isConnected=!0}};let s=new RedisService},5789:function(e,t,r){r.d(t,{HQ:function(){return getChangeColor},P2:function(){return throttle},SY:function(){return formatRelativeTime},cn:function(){return cn},rl:function(){return formatPercentage},xG:function(){return formatCurrency}});let cn=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(Boolean).join(" ")},formatCurrency=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:r,maximumFractionDigits:r}).format(e)},formatPercentage=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:t,maximumFractionDigits:t}).format(e/100)},formatDate=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"short",r="string"==typeof e?new Date(e):e;return"relative"===t?formatRelativeTime(r):new Intl.DateTimeFormat("en-US","long"===t?{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}:{year:"numeric",month:"short",day:"numeric"}).format(r)},formatRelativeTime=e=>{let t=new Date,r="string"==typeof e?new Date(e):e,s=Math.floor((t.getTime()-r.getTime())/1e3);return s<60?"just now":s<3600?"".concat(Math.floor(s/60),"m ago"):s<86400?"".concat(Math.floor(s/3600),"h ago"):s<604800?"".concat(Math.floor(s/86400),"d ago"):formatDate(r,"short")},getChangeColor=e=>e>0?"text-green-500":e<0?"text-red-500":"text-gray-500",throttle=(e,t)=>{let r;return function(){for(var s=arguments.length,a=Array(s),i=0;i<s;i++)a[i]=arguments[i];r||(e(...a),r=!0,setTimeout(()=>r=!1,t))}}}}]);