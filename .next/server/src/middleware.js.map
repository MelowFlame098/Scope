{"version":3,"file":"src/middleware.js","mappings":"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","sources":["webpack://_N_E/./node_modules/next/dist/esm/server/web/globals.js","webpack://_N_E/./node_modules/next/dist/esm/server/web/error.js","webpack://_N_E/./node_modules/next/dist/esm/server/web/utils.js","webpack://_N_E/./node_modules/next/dist/esm/server/web/spec-extension/fetch-event.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/i18n/detect-domain-locale.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/router/utils/remove-trailing-slash.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/router/utils/parse-path.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/router/utils/add-path-prefix.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/router/utils/add-path-suffix.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/router/utils/path-has-prefix.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/router/utils/add-locale.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/router/utils/format-next-pathname-info.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/get-hostname.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/i18n/normalize-locale-path.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/router/utils/remove-path-prefix.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/router/utils/get-next-pathname-info.js","webpack://_N_E/./node_modules/next/dist/esm/server/web/next-url.js","webpack://_N_E/./node_modules/next/dist/esm/server/web/spec-extension/cookies.js","webpack://_N_E/./node_modules/next/dist/esm/server/web/spec-extension/request.js","webpack://_N_E/./node_modules/next/dist/esm/server/web/spec-extension/response.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/router/utils/relativize-url.js","webpack://_N_E/./node_modules/next/dist/esm/client/components/app-router-headers.js","webpack://_N_E/./node_modules/next/dist/esm/server/internal-utils.js","webpack://_N_E/./node_modules/next/dist/esm/shared/lib/router/utils/app-paths.js","webpack://_N_E/./node_modules/next/dist/esm/lib/constants.js","webpack://_N_E/./node_modules/next/dist/esm/server/web/spec-extension/adapters/reflect.js","webpack://_N_E/./node_modules/next/dist/esm/server/web/spec-extension/adapters/headers.js","webpack://_N_E/./node_modules/next/dist/esm/server/web/spec-extension/adapters/request-cookies.js","webpack://_N_E/./node_modules/next/dist/esm/server/api-utils/index.js","webpack://_N_E/./node_modules/next/dist/esm/server/async-storage/draft-mode-provider.js","webpack://_N_E/./node_modules/next/dist/esm/server/async-storage/request-async-storage-wrapper.js","webpack://_N_E/./node_modules/next/dist/esm/client/components/async-local-storage.js","webpack://_N_E/./node_modules/next/dist/esm/client/components/request-async-storage.external.js","webpack://_N_E/./node_modules/next/dist/esm/server/web/adapter.js","webpack://_N_E/./node_modules/next/dist/esm/server/web/exports/next-response.js","webpack://_N_E/./src/middleware/subscription.ts","webpack://_N_E/./src/services/RedisService.ts","webpack://_N_E/./src/services/SessionService.ts","webpack://_N_E/./src/middleware.ts","webpack://_N_E/","webpack://_N_E/./node_modules/next/dist/compiled/@edge-runtime/cookies/index.js","webpack://_N_E/./node_modules/next/dist/compiled/cookie/index.js","webpack://_N_E/./node_modules/jose/dist/webapi/index.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/buffer_utils.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/base64.js","webpack://_N_E/./node_modules/jose/dist/webapi/util/base64url.js","webpack://_N_E/./node_modules/jose/dist/webapi/util/errors.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/subtle_dsa.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/check_key_length.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/crypto_key.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/invalid_key_input.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/get_sign_verify_key.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/verify.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/is_disjoint.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/is_object.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/is_key_like.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/is_jwk.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/check_key_type.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/validate_crit.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/validate_algorithms.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/jwk_to_key.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/normalize_key.js","webpack://_N_E/./node_modules/jose/dist/webapi/jws/flattened/verify.js","webpack://_N_E/./node_modules/jose/dist/webapi/jws/compact/verify.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/epoch.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/secs.js","webpack://_N_E/./node_modules/jose/dist/webapi/lib/jwt_claims_set.js","webpack://_N_E/./node_modules/jose/dist/webapi/jwt/verify.js"],"sourcesContent":["async function registerInstrumentation() {\n    if (\"_ENTRIES\" in globalThis && _ENTRIES.middleware_instrumentation && _ENTRIES.middleware_instrumentation.register) {\n        try {\n            await _ENTRIES.middleware_instrumentation.register();\n        } catch (err) {\n            err.message = `An error occurred while loading instrumentation hook: ${err.message}`;\n            throw err;\n        }\n    }\n}\nlet registerInstrumentationPromise = null;\nexport function ensureInstrumentationRegistered() {\n    if (!registerInstrumentationPromise) {\n        registerInstrumentationPromise = registerInstrumentation();\n    }\n    return registerInstrumentationPromise;\n}\nfunction getUnsupportedModuleErrorMessage(module) {\n    // warning: if you change these messages, you must adjust how react-dev-overlay's middleware detects modules not found\n    return `The edge runtime does not support Node.js '${module}' module.\nLearn More: https://nextjs.org/docs/messages/node-module-in-edge-runtime`;\n}\nfunction __import_unsupported(moduleName) {\n    const proxy = new Proxy(function() {}, {\n        get (_obj, prop) {\n            if (prop === \"then\") {\n                return {};\n            }\n            throw new Error(getUnsupportedModuleErrorMessage(moduleName));\n        },\n        construct () {\n            throw new Error(getUnsupportedModuleErrorMessage(moduleName));\n        },\n        apply (_target, _this, args) {\n            if (typeof args[0] === \"function\") {\n                return args[0](proxy);\n            }\n            throw new Error(getUnsupportedModuleErrorMessage(moduleName));\n        }\n    });\n    return new Proxy({}, {\n        get: ()=>proxy\n    });\n}\nfunction enhanceGlobals() {\n    // The condition is true when the \"process\" module is provided\n    if (process !== global.process) {\n        // prefer local process but global.process has correct \"env\"\n        process.env = global.process.env;\n        global.process = process;\n    }\n    // to allow building code that import but does not use node.js modules,\n    // webpack will expect this function to exist in global scope\n    Object.defineProperty(globalThis, \"__import_unsupported\", {\n        value: __import_unsupported,\n        enumerable: false,\n        configurable: false\n    });\n    // Eagerly fire instrumentation hook to make the startup faster.\n    void ensureInstrumentationRegistered();\n}\nenhanceGlobals();\n\n//# sourceMappingURL=globals.js.map","export class PageSignatureError extends Error {\n    constructor({ page }){\n        super(`The middleware \"${page}\" accepts an async API directly with the form:\n  \n  export function middleware(request, event) {\n    return NextResponse.redirect('/new-location')\n  }\n  \n  Read more: https://nextjs.org/docs/messages/middleware-new-signature\n  `);\n    }\n}\nexport class RemovedPageError extends Error {\n    constructor(){\n        super(`The request.page has been deprecated in favour of \\`URLPattern\\`.\n  Read more: https://nextjs.org/docs/messages/middleware-request-page\n  `);\n    }\n}\nexport class RemovedUAError extends Error {\n    constructor(){\n        super(`The request.ua has been removed in favour of \\`userAgent\\` function.\n  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent\n  `);\n    }\n}\n\n//# sourceMappingURL=error.js.map","/**\n * Converts a Node.js IncomingHttpHeaders object to a Headers object. Any\n * headers with multiple values will be joined with a comma and space. Any\n * headers that have an undefined value will be ignored and others will be\n * coerced to strings.\n *\n * @param nodeHeaders the headers object to convert\n * @returns the converted headers object\n */ export function fromNodeOutgoingHttpHeaders(nodeHeaders) {\n    const headers = new Headers();\n    for (let [key, value] of Object.entries(nodeHeaders)){\n        const values = Array.isArray(value) ? value : [\n            value\n        ];\n        for (let v of values){\n            if (typeof v === \"undefined\") continue;\n            if (typeof v === \"number\") {\n                v = v.toString();\n            }\n            headers.append(key, v);\n        }\n    }\n    return headers;\n}\n/*\n  Set-Cookie header field-values are sometimes comma joined in one string. This splits them without choking on commas\n  that are within a single set-cookie field-value, such as in the Expires portion.\n  This is uncommon, but explicitly allowed - see https://tools.ietf.org/html/rfc2616#section-4.2\n  Node.js does this for every header *except* set-cookie - see https://github.com/nodejs/node/blob/d5e363b77ebaf1caf67cd7528224b651c86815c1/lib/_http_incoming.js#L128\n  React Native's fetch does this for *every* header, including set-cookie.\n  \n  Based on: https://github.com/google/j2objc/commit/16820fdbc8f76ca0c33472810ce0cb03d20efe25\n  Credits to: https://github.com/tomball for original and https://github.com/chrusart for JavaScript implementation\n*/ export function splitCookiesString(cookiesString) {\n    var cookiesStrings = [];\n    var pos = 0;\n    var start;\n    var ch;\n    var lastComma;\n    var nextStart;\n    var cookiesSeparatorFound;\n    function skipWhitespace() {\n        while(pos < cookiesString.length && /\\s/.test(cookiesString.charAt(pos))){\n            pos += 1;\n        }\n        return pos < cookiesString.length;\n    }\n    function notSpecialChar() {\n        ch = cookiesString.charAt(pos);\n        return ch !== \"=\" && ch !== \";\" && ch !== \",\";\n    }\n    while(pos < cookiesString.length){\n        start = pos;\n        cookiesSeparatorFound = false;\n        while(skipWhitespace()){\n            ch = cookiesString.charAt(pos);\n            if (ch === \",\") {\n                // ',' is a cookie separator if we have later first '=', not ';' or ','\n                lastComma = pos;\n                pos += 1;\n                skipWhitespace();\n                nextStart = pos;\n                while(pos < cookiesString.length && notSpecialChar()){\n                    pos += 1;\n                }\n                // currently special character\n                if (pos < cookiesString.length && cookiesString.charAt(pos) === \"=\") {\n                    // we found cookies separator\n                    cookiesSeparatorFound = true;\n                    // pos is inside the next cookie, so back up and return it.\n                    pos = nextStart;\n                    cookiesStrings.push(cookiesString.substring(start, lastComma));\n                    start = pos;\n                } else {\n                    // in param ',' or param separator ';',\n                    // we continue from that comma\n                    pos = lastComma + 1;\n                }\n            } else {\n                pos += 1;\n            }\n        }\n        if (!cookiesSeparatorFound || pos >= cookiesString.length) {\n            cookiesStrings.push(cookiesString.substring(start, cookiesString.length));\n        }\n    }\n    return cookiesStrings;\n}\n/**\n * Converts a Headers object to a Node.js OutgoingHttpHeaders object. This is\n * required to support the set-cookie header, which may have multiple values.\n *\n * @param headers the headers object to convert\n * @returns the converted headers object\n */ export function toNodeOutgoingHttpHeaders(headers) {\n    const nodeHeaders = {};\n    const cookies = [];\n    if (headers) {\n        for (const [key, value] of headers.entries()){\n            if (key.toLowerCase() === \"set-cookie\") {\n                // We may have gotten a comma joined string of cookies, or multiple\n                // set-cookie headers. We need to merge them into one header array\n                // to represent all the cookies.\n                cookies.push(...splitCookiesString(value));\n                nodeHeaders[key] = cookies.length === 1 ? cookies[0] : cookies;\n            } else {\n                nodeHeaders[key] = value;\n            }\n        }\n    }\n    return nodeHeaders;\n}\n/**\n * Validate the correctness of a user-provided URL.\n */ export function validateURL(url) {\n    try {\n        return String(new URL(String(url)));\n    } catch (error) {\n        throw new Error(`URL is malformed \"${String(url)}\". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`, {\n            cause: error\n        });\n    }\n}\n\n//# sourceMappingURL=utils.js.map","import { PageSignatureError } from \"../error\";\nconst responseSymbol = Symbol(\"response\");\nconst passThroughSymbol = Symbol(\"passThrough\");\nexport const waitUntilSymbol = Symbol(\"waitUntil\");\nclass FetchEvent {\n    // eslint-disable-next-line @typescript-eslint/no-useless-constructor\n    constructor(_request){\n        this[waitUntilSymbol] = [];\n        this[passThroughSymbol] = false;\n    }\n    respondWith(response) {\n        if (!this[responseSymbol]) {\n            this[responseSymbol] = Promise.resolve(response);\n        }\n    }\n    passThroughOnException() {\n        this[passThroughSymbol] = true;\n    }\n    waitUntil(promise) {\n        this[waitUntilSymbol].push(promise);\n    }\n}\nexport class NextFetchEvent extends FetchEvent {\n    constructor(params){\n        super(params.request);\n        this.sourcePage = params.page;\n    }\n    /**\n   * @deprecated The `request` is now the first parameter and the API is now async.\n   *\n   * Read more: https://nextjs.org/docs/messages/middleware-new-signature\n   */ get request() {\n        throw new PageSignatureError({\n            page: this.sourcePage\n        });\n    }\n    /**\n   * @deprecated Using `respondWith` is no longer needed.\n   *\n   * Read more: https://nextjs.org/docs/messages/middleware-new-signature\n   */ respondWith() {\n        throw new PageSignatureError({\n            page: this.sourcePage\n        });\n    }\n}\n\n//# sourceMappingURL=fetch-event.js.map","export function detectDomainLocale(domainItems, hostname, detectedLocale) {\n    if (!domainItems) return;\n    if (detectedLocale) {\n        detectedLocale = detectedLocale.toLowerCase();\n    }\n    for (const item of domainItems){\n        var _item_domain, _item_locales;\n        // remove port if present\n        const domainHostname = (_item_domain = item.domain) == null ? void 0 : _item_domain.split(\":\", 1)[0].toLowerCase();\n        if (hostname === domainHostname || detectedLocale === item.defaultLocale.toLowerCase() || ((_item_locales = item.locales) == null ? void 0 : _item_locales.some((locale)=>locale.toLowerCase() === detectedLocale))) {\n            return item;\n        }\n    }\n}\n\n//# sourceMappingURL=detect-domain-locale.js.map","/**\n * Removes the trailing slash for a given route or page path. Preserves the\n * root page. Examples:\n *   - `/foo/bar/` -> `/foo/bar`\n *   - `/foo/bar` -> `/foo/bar`\n *   - `/` -> `/`\n */ export function removeTrailingSlash(route) {\n    return route.replace(/\\/$/, \"\") || \"/\";\n}\n\n//# sourceMappingURL=remove-trailing-slash.js.map","/**\n * Given a path this function will find the pathname, query and hash and return\n * them. This is useful to parse full paths on the client side.\n * @param path A path to parse e.g. /foo/bar?id=1#hash\n */ export function parsePath(path) {\n    const hashIndex = path.indexOf(\"#\");\n    const queryIndex = path.indexOf(\"?\");\n    const hasQuery = queryIndex > -1 && (hashIndex < 0 || queryIndex < hashIndex);\n    if (hasQuery || hashIndex > -1) {\n        return {\n            pathname: path.substring(0, hasQuery ? queryIndex : hashIndex),\n            query: hasQuery ? path.substring(queryIndex, hashIndex > -1 ? hashIndex : undefined) : \"\",\n            hash: hashIndex > -1 ? path.slice(hashIndex) : \"\"\n        };\n    }\n    return {\n        pathname: path,\n        query: \"\",\n        hash: \"\"\n    };\n}\n\n//# sourceMappingURL=parse-path.js.map","import { parsePath } from \"./parse-path\";\n/**\n * Adds the provided prefix to the given path. It first ensures that the path\n * is indeed starting with a slash.\n */ export function addPathPrefix(path, prefix) {\n    if (!path.startsWith(\"/\") || !prefix) {\n        return path;\n    }\n    const { pathname, query, hash } = parsePath(path);\n    return \"\" + prefix + pathname + query + hash;\n}\n\n//# sourceMappingURL=add-path-prefix.js.map","import { parsePath } from \"./parse-path\";\n/**\n * Similarly to `addPathPrefix`, this function adds a suffix at the end on the\n * provided path. It also works only for paths ensuring the argument starts\n * with a slash.\n */ export function addPathSuffix(path, suffix) {\n    if (!path.startsWith(\"/\") || !suffix) {\n        return path;\n    }\n    const { pathname, query, hash } = parsePath(path);\n    return \"\" + pathname + suffix + query + hash;\n}\n\n//# sourceMappingURL=add-path-suffix.js.map","import { parsePath } from \"./parse-path\";\n/**\n * Checks if a given path starts with a given prefix. It ensures it matches\n * exactly without containing extra chars. e.g. prefix /docs should replace\n * for /docs, /docs/, /docs/a but not /docsss\n * @param path The path to check.\n * @param prefix The prefix to check against.\n */ export function pathHasPrefix(path, prefix) {\n    if (typeof path !== \"string\") {\n        return false;\n    }\n    const { pathname } = parsePath(path);\n    return pathname === prefix || pathname.startsWith(prefix + \"/\");\n}\n\n//# sourceMappingURL=path-has-prefix.js.map","import { addPathPrefix } from \"./add-path-prefix\";\nimport { pathHasPrefix } from \"./path-has-prefix\";\n/**\n * For a given path and a locale, if the locale is given, it will prefix the\n * locale. The path shouldn't be an API path. If a default locale is given the\n * prefix will be omitted if the locale is already the default locale.\n */ export function addLocale(path, locale, defaultLocale, ignorePrefix) {\n    // If no locale was given or the locale is the default locale, we don't need\n    // to prefix the path.\n    if (!locale || locale === defaultLocale) return path;\n    const lower = path.toLowerCase();\n    // If the path is an API path or the path already has the locale prefix, we\n    // don't need to prefix the path.\n    if (!ignorePrefix) {\n        if (pathHasPrefix(lower, \"/api\")) return path;\n        if (pathHasPrefix(lower, \"/\" + locale.toLowerCase())) return path;\n    }\n    // Add the locale prefix to the path.\n    return addPathPrefix(path, \"/\" + locale);\n}\n\n//# sourceMappingURL=add-locale.js.map","import { removeTrailingSlash } from \"./remove-trailing-slash\";\nimport { addPathPrefix } from \"./add-path-prefix\";\nimport { addPathSuffix } from \"./add-path-suffix\";\nimport { addLocale } from \"./add-locale\";\nexport function formatNextPathnameInfo(info) {\n    let pathname = addLocale(info.pathname, info.locale, info.buildId ? undefined : info.defaultLocale, info.ignorePrefix);\n    if (info.buildId || !info.trailingSlash) {\n        pathname = removeTrailingSlash(pathname);\n    }\n    if (info.buildId) {\n        pathname = addPathSuffix(addPathPrefix(pathname, \"/_next/data/\" + info.buildId), info.pathname === \"/\" ? \"index.json\" : \".json\");\n    }\n    pathname = addPathPrefix(pathname, info.basePath);\n    return !info.buildId && info.trailingSlash ? !pathname.endsWith(\"/\") ? addPathSuffix(pathname, \"/\") : pathname : removeTrailingSlash(pathname);\n}\n\n//# sourceMappingURL=format-next-pathname-info.js.map","/**\n * Takes an object with a hostname property (like a parsed URL) and some\n * headers that may contain Host and returns the preferred hostname.\n * @param parsed An object containing a hostname property.\n * @param headers A dictionary with headers containing a `host`.\n */ export function getHostname(parsed, headers) {\n    // Get the hostname from the headers if it exists, otherwise use the parsed\n    // hostname.\n    let hostname;\n    if ((headers == null ? void 0 : headers.host) && !Array.isArray(headers.host)) {\n        hostname = headers.host.toString().split(\":\", 1)[0];\n    } else if (parsed.hostname) {\n        hostname = parsed.hostname;\n    } else return;\n    return hostname.toLowerCase();\n}\n\n//# sourceMappingURL=get-hostname.js.map","/**\n * For a pathname that may include a locale from a list of locales, it\n * removes the locale from the pathname returning it alongside with the\n * detected locale.\n *\n * @param pathname A pathname that may include a locale.\n * @param locales A list of locales.\n * @returns The detected locale and pathname without locale\n */ export function normalizeLocalePath(pathname, locales) {\n    let detectedLocale;\n    // first item will be empty string from splitting at first char\n    const pathnameParts = pathname.split(\"/\");\n    (locales || []).some((locale)=>{\n        if (pathnameParts[1] && pathnameParts[1].toLowerCase() === locale.toLowerCase()) {\n            detectedLocale = locale;\n            pathnameParts.splice(1, 1);\n            pathname = pathnameParts.join(\"/\") || \"/\";\n            return true;\n        }\n        return false;\n    });\n    return {\n        pathname,\n        detectedLocale\n    };\n}\n\n//# sourceMappingURL=normalize-locale-path.js.map","import { pathHasPrefix } from \"./path-has-prefix\";\n/**\n * Given a path and a prefix it will remove the prefix when it exists in the\n * given path. It ensures it matches exactly without containing extra chars\n * and if the prefix is not there it will be noop.\n *\n * @param path The path to remove the prefix from.\n * @param prefix The prefix to be removed.\n */ export function removePathPrefix(path, prefix) {\n    // If the path doesn't start with the prefix we can return it as is. This\n    // protects us from situations where the prefix is a substring of the path\n    // prefix such as:\n    //\n    // For prefix: /blog\n    //\n    //   /blog -> true\n    //   /blog/ -> true\n    //   /blog/1 -> true\n    //   /blogging -> false\n    //   /blogging/ -> false\n    //   /blogging/1 -> false\n    if (!pathHasPrefix(path, prefix)) {\n        return path;\n    }\n    // Remove the prefix from the path via slicing.\n    const withoutPrefix = path.slice(prefix.length);\n    // If the path without the prefix starts with a `/` we can return it as is.\n    if (withoutPrefix.startsWith(\"/\")) {\n        return withoutPrefix;\n    }\n    // If the path without the prefix doesn't start with a `/` we need to add it\n    // back to the path to make sure it's a valid path.\n    return \"/\" + withoutPrefix;\n}\n\n//# sourceMappingURL=remove-path-prefix.js.map","import { normalizeLocalePath } from \"../../i18n/normalize-locale-path\";\nimport { removePathPrefix } from \"./remove-path-prefix\";\nimport { pathHasPrefix } from \"./path-has-prefix\";\nexport function getNextPathnameInfo(pathname, options) {\n    var _options_nextConfig;\n    const { basePath, i18n, trailingSlash } = (_options_nextConfig = options.nextConfig) != null ? _options_nextConfig : {};\n    const info = {\n        pathname,\n        trailingSlash: pathname !== \"/\" ? pathname.endsWith(\"/\") : trailingSlash\n    };\n    if (basePath && pathHasPrefix(info.pathname, basePath)) {\n        info.pathname = removePathPrefix(info.pathname, basePath);\n        info.basePath = basePath;\n    }\n    let pathnameNoDataPrefix = info.pathname;\n    if (info.pathname.startsWith(\"/_next/data/\") && info.pathname.endsWith(\".json\")) {\n        const paths = info.pathname.replace(/^\\/_next\\/data\\//, \"\").replace(/\\.json$/, \"\").split(\"/\");\n        const buildId = paths[0];\n        info.buildId = buildId;\n        pathnameNoDataPrefix = paths[1] !== \"index\" ? \"/\" + paths.slice(1).join(\"/\") : \"/\";\n        // update pathname with normalized if enabled although\n        // we use normalized to populate locale info still\n        if (options.parseData === true) {\n            info.pathname = pathnameNoDataPrefix;\n        }\n    }\n    // If provided, use the locale route normalizer to detect the locale instead\n    // of the function below.\n    if (i18n) {\n        let result = options.i18nProvider ? options.i18nProvider.analyze(info.pathname) : normalizeLocalePath(info.pathname, i18n.locales);\n        info.locale = result.detectedLocale;\n        var _result_pathname;\n        info.pathname = (_result_pathname = result.pathname) != null ? _result_pathname : info.pathname;\n        if (!result.detectedLocale && info.buildId) {\n            result = options.i18nProvider ? options.i18nProvider.analyze(pathnameNoDataPrefix) : normalizeLocalePath(pathnameNoDataPrefix, i18n.locales);\n            if (result.detectedLocale) {\n                info.locale = result.detectedLocale;\n            }\n        }\n    }\n    return info;\n}\n\n//# sourceMappingURL=get-next-pathname-info.js.map","import { detectDomainLocale } from \"../../shared/lib/i18n/detect-domain-locale\";\nimport { formatNextPathnameInfo } from \"../../shared/lib/router/utils/format-next-pathname-info\";\nimport { getHostname } from \"../../shared/lib/get-hostname\";\nimport { getNextPathnameInfo } from \"../../shared/lib/router/utils/get-next-pathname-info\";\nconst REGEX_LOCALHOST_HOSTNAME = /(?!^https?:\\/\\/)(127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\\[::1\\]|localhost)/;\nfunction parseURL(url, base) {\n    return new URL(String(url).replace(REGEX_LOCALHOST_HOSTNAME, \"localhost\"), base && String(base).replace(REGEX_LOCALHOST_HOSTNAME, \"localhost\"));\n}\nconst Internal = Symbol(\"NextURLInternal\");\nexport class NextURL {\n    constructor(input, baseOrOpts, opts){\n        let base;\n        let options;\n        if (typeof baseOrOpts === \"object\" && \"pathname\" in baseOrOpts || typeof baseOrOpts === \"string\") {\n            base = baseOrOpts;\n            options = opts || {};\n        } else {\n            options = opts || baseOrOpts || {};\n        }\n        this[Internal] = {\n            url: parseURL(input, base ?? options.base),\n            options: options,\n            basePath: \"\"\n        };\n        this.analyze();\n    }\n    analyze() {\n        var _this_Internal_options_nextConfig_i18n, _this_Internal_options_nextConfig, _this_Internal_domainLocale, _this_Internal_options_nextConfig_i18n1, _this_Internal_options_nextConfig1;\n        const info = getNextPathnameInfo(this[Internal].url.pathname, {\n            nextConfig: this[Internal].options.nextConfig,\n            parseData: !process.env.__NEXT_NO_MIDDLEWARE_URL_NORMALIZE,\n            i18nProvider: this[Internal].options.i18nProvider\n        });\n        const hostname = getHostname(this[Internal].url, this[Internal].options.headers);\n        this[Internal].domainLocale = this[Internal].options.i18nProvider ? this[Internal].options.i18nProvider.detectDomainLocale(hostname) : detectDomainLocale((_this_Internal_options_nextConfig = this[Internal].options.nextConfig) == null ? void 0 : (_this_Internal_options_nextConfig_i18n = _this_Internal_options_nextConfig.i18n) == null ? void 0 : _this_Internal_options_nextConfig_i18n.domains, hostname);\n        const defaultLocale = ((_this_Internal_domainLocale = this[Internal].domainLocale) == null ? void 0 : _this_Internal_domainLocale.defaultLocale) || ((_this_Internal_options_nextConfig1 = this[Internal].options.nextConfig) == null ? void 0 : (_this_Internal_options_nextConfig_i18n1 = _this_Internal_options_nextConfig1.i18n) == null ? void 0 : _this_Internal_options_nextConfig_i18n1.defaultLocale);\n        this[Internal].url.pathname = info.pathname;\n        this[Internal].defaultLocale = defaultLocale;\n        this[Internal].basePath = info.basePath ?? \"\";\n        this[Internal].buildId = info.buildId;\n        this[Internal].locale = info.locale ?? defaultLocale;\n        this[Internal].trailingSlash = info.trailingSlash;\n    }\n    formatPathname() {\n        return formatNextPathnameInfo({\n            basePath: this[Internal].basePath,\n            buildId: this[Internal].buildId,\n            defaultLocale: !this[Internal].options.forceLocale ? this[Internal].defaultLocale : undefined,\n            locale: this[Internal].locale,\n            pathname: this[Internal].url.pathname,\n            trailingSlash: this[Internal].trailingSlash\n        });\n    }\n    formatSearch() {\n        return this[Internal].url.search;\n    }\n    get buildId() {\n        return this[Internal].buildId;\n    }\n    set buildId(buildId) {\n        this[Internal].buildId = buildId;\n    }\n    get locale() {\n        return this[Internal].locale ?? \"\";\n    }\n    set locale(locale) {\n        var _this_Internal_options_nextConfig_i18n, _this_Internal_options_nextConfig;\n        if (!this[Internal].locale || !((_this_Internal_options_nextConfig = this[Internal].options.nextConfig) == null ? void 0 : (_this_Internal_options_nextConfig_i18n = _this_Internal_options_nextConfig.i18n) == null ? void 0 : _this_Internal_options_nextConfig_i18n.locales.includes(locale))) {\n            throw new TypeError(`The NextURL configuration includes no locale \"${locale}\"`);\n        }\n        this[Internal].locale = locale;\n    }\n    get defaultLocale() {\n        return this[Internal].defaultLocale;\n    }\n    get domainLocale() {\n        return this[Internal].domainLocale;\n    }\n    get searchParams() {\n        return this[Internal].url.searchParams;\n    }\n    get host() {\n        return this[Internal].url.host;\n    }\n    set host(value) {\n        this[Internal].url.host = value;\n    }\n    get hostname() {\n        return this[Internal].url.hostname;\n    }\n    set hostname(value) {\n        this[Internal].url.hostname = value;\n    }\n    get port() {\n        return this[Internal].url.port;\n    }\n    set port(value) {\n        this[Internal].url.port = value;\n    }\n    get protocol() {\n        return this[Internal].url.protocol;\n    }\n    set protocol(value) {\n        this[Internal].url.protocol = value;\n    }\n    get href() {\n        const pathname = this.formatPathname();\n        const search = this.formatSearch();\n        return `${this.protocol}//${this.host}${pathname}${search}${this.hash}`;\n    }\n    set href(url) {\n        this[Internal].url = parseURL(url);\n        this.analyze();\n    }\n    get origin() {\n        return this[Internal].url.origin;\n    }\n    get pathname() {\n        return this[Internal].url.pathname;\n    }\n    set pathname(value) {\n        this[Internal].url.pathname = value;\n    }\n    get hash() {\n        return this[Internal].url.hash;\n    }\n    set hash(value) {\n        this[Internal].url.hash = value;\n    }\n    get search() {\n        return this[Internal].url.search;\n    }\n    set search(value) {\n        this[Internal].url.search = value;\n    }\n    get password() {\n        return this[Internal].url.password;\n    }\n    set password(value) {\n        this[Internal].url.password = value;\n    }\n    get username() {\n        return this[Internal].url.username;\n    }\n    set username(value) {\n        this[Internal].url.username = value;\n    }\n    get basePath() {\n        return this[Internal].basePath;\n    }\n    set basePath(value) {\n        this[Internal].basePath = value.startsWith(\"/\") ? value : `/${value}`;\n    }\n    toString() {\n        return this.href;\n    }\n    toJSON() {\n        return this.href;\n    }\n    [Symbol.for(\"edge-runtime.inspect.custom\")]() {\n        return {\n            href: this.href,\n            origin: this.origin,\n            protocol: this.protocol,\n            username: this.username,\n            password: this.password,\n            host: this.host,\n            hostname: this.hostname,\n            port: this.port,\n            pathname: this.pathname,\n            search: this.search,\n            searchParams: this.searchParams,\n            hash: this.hash\n        };\n    }\n    clone() {\n        return new NextURL(String(this), this[Internal].options);\n    }\n}\n\n//# sourceMappingURL=next-url.js.map","export { RequestCookies, ResponseCookies } from \"next/dist/compiled/@edge-runtime/cookies\";\n\n//# sourceMappingURL=cookies.js.map","import { NextURL } from \"../next-url\";\nimport { toNodeOutgoingHttpHeaders, validateURL } from \"../utils\";\nimport { RemovedUAError, RemovedPageError } from \"../error\";\nimport { RequestCookies } from \"./cookies\";\nexport const INTERNALS = Symbol(\"internal request\");\nexport class NextRequest extends Request {\n    constructor(input, init = {}){\n        const url = typeof input !== \"string\" && \"url\" in input ? input.url : String(input);\n        validateURL(url);\n        if (input instanceof Request) super(input, init);\n        else super(url, init);\n        const nextUrl = new NextURL(url, {\n            headers: toNodeOutgoingHttpHeaders(this.headers),\n            nextConfig: init.nextConfig\n        });\n        this[INTERNALS] = {\n            cookies: new RequestCookies(this.headers),\n            geo: init.geo || {},\n            ip: init.ip,\n            nextUrl,\n            url: process.env.__NEXT_NO_MIDDLEWARE_URL_NORMALIZE ? url : nextUrl.toString()\n        };\n    }\n    [Symbol.for(\"edge-runtime.inspect.custom\")]() {\n        return {\n            cookies: this.cookies,\n            geo: this.geo,\n            ip: this.ip,\n            nextUrl: this.nextUrl,\n            url: this.url,\n            // rest of props come from Request\n            bodyUsed: this.bodyUsed,\n            cache: this.cache,\n            credentials: this.credentials,\n            destination: this.destination,\n            headers: Object.fromEntries(this.headers),\n            integrity: this.integrity,\n            keepalive: this.keepalive,\n            method: this.method,\n            mode: this.mode,\n            redirect: this.redirect,\n            referrer: this.referrer,\n            referrerPolicy: this.referrerPolicy,\n            signal: this.signal\n        };\n    }\n    get cookies() {\n        return this[INTERNALS].cookies;\n    }\n    get geo() {\n        return this[INTERNALS].geo;\n    }\n    get ip() {\n        return this[INTERNALS].ip;\n    }\n    get nextUrl() {\n        return this[INTERNALS].nextUrl;\n    }\n    /**\n   * @deprecated\n   * `page` has been deprecated in favour of `URLPattern`.\n   * Read more: https://nextjs.org/docs/messages/middleware-request-page\n   */ get page() {\n        throw new RemovedPageError();\n    }\n    /**\n   * @deprecated\n   * `ua` has been removed in favour of \\`userAgent\\` function.\n   * Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent\n   */ get ua() {\n        throw new RemovedUAError();\n    }\n    get url() {\n        return this[INTERNALS].url;\n    }\n}\n\n//# sourceMappingURL=request.js.map","import { NextURL } from \"../next-url\";\nimport { toNodeOutgoingHttpHeaders, validateURL } from \"../utils\";\nimport { ResponseCookies } from \"./cookies\";\nconst INTERNALS = Symbol(\"internal response\");\nconst REDIRECTS = new Set([\n    301,\n    302,\n    303,\n    307,\n    308\n]);\nfunction handleMiddlewareField(init, headers) {\n    var _init_request;\n    if (init == null ? void 0 : (_init_request = init.request) == null ? void 0 : _init_request.headers) {\n        if (!(init.request.headers instanceof Headers)) {\n            throw new Error(\"request.headers must be an instance of Headers\");\n        }\n        const keys = [];\n        for (const [key, value] of init.request.headers){\n            headers.set(\"x-middleware-request-\" + key, value);\n            keys.push(key);\n        }\n        headers.set(\"x-middleware-override-headers\", keys.join(\",\"));\n    }\n}\nexport class NextResponse extends Response {\n    constructor(body, init = {}){\n        super(body, init);\n        this[INTERNALS] = {\n            cookies: new ResponseCookies(this.headers),\n            url: init.url ? new NextURL(init.url, {\n                headers: toNodeOutgoingHttpHeaders(this.headers),\n                nextConfig: init.nextConfig\n            }) : undefined\n        };\n    }\n    [Symbol.for(\"edge-runtime.inspect.custom\")]() {\n        return {\n            cookies: this.cookies,\n            url: this.url,\n            // rest of props come from Response\n            body: this.body,\n            bodyUsed: this.bodyUsed,\n            headers: Object.fromEntries(this.headers),\n            ok: this.ok,\n            redirected: this.redirected,\n            status: this.status,\n            statusText: this.statusText,\n            type: this.type\n        };\n    }\n    get cookies() {\n        return this[INTERNALS].cookies;\n    }\n    static json(body, init) {\n        const response = Response.json(body, init);\n        return new NextResponse(response.body, response);\n    }\n    static redirect(url, init) {\n        const status = typeof init === \"number\" ? init : (init == null ? void 0 : init.status) ?? 307;\n        if (!REDIRECTS.has(status)) {\n            throw new RangeError('Failed to execute \"redirect\" on \"response\": Invalid status code');\n        }\n        const initObj = typeof init === \"object\" ? init : {};\n        const headers = new Headers(initObj == null ? void 0 : initObj.headers);\n        headers.set(\"Location\", validateURL(url));\n        return new NextResponse(null, {\n            ...initObj,\n            headers,\n            status\n        });\n    }\n    static rewrite(destination, init) {\n        const headers = new Headers(init == null ? void 0 : init.headers);\n        headers.set(\"x-middleware-rewrite\", validateURL(destination));\n        handleMiddlewareField(init, headers);\n        return new NextResponse(null, {\n            ...init,\n            headers\n        });\n    }\n    static next(init) {\n        const headers = new Headers(init == null ? void 0 : init.headers);\n        headers.set(\"x-middleware-next\", \"1\");\n        handleMiddlewareField(init, headers);\n        return new NextResponse(null, {\n            ...init,\n            headers\n        });\n    }\n}\n\n//# sourceMappingURL=response.js.map","/**\n * Given a URL as a string and a base URL it will make the URL relative\n * if the parsed protocol and host is the same as the one in the base\n * URL. Otherwise it returns the same URL string.\n */ export function relativizeURL(url, base) {\n    const baseURL = typeof base === \"string\" ? new URL(base) : base;\n    const relative = new URL(url, base);\n    const origin = baseURL.protocol + \"//\" + baseURL.host;\n    return relative.protocol + \"//\" + relative.host === origin ? relative.toString().replace(origin, \"\") : relative.toString();\n}\n\n//# sourceMappingURL=relativize-url.js.map","export const RSC = \"RSC\";\nexport const ACTION = \"Next-Action\";\nexport const NEXT_ROUTER_STATE_TREE = \"Next-Router-State-Tree\";\nexport const NEXT_ROUTER_PREFETCH = \"Next-Router-Prefetch\";\nexport const NEXT_URL = \"Next-Url\";\nexport const RSC_CONTENT_TYPE_HEADER = \"text/x-component\";\nexport const RSC_VARY_HEADER = RSC + \", \" + NEXT_ROUTER_STATE_TREE + \", \" + NEXT_ROUTER_PREFETCH + \", \" + NEXT_URL;\nexport const FLIGHT_PARAMETERS = [\n    [\n        RSC\n    ],\n    [\n        NEXT_ROUTER_STATE_TREE\n    ],\n    [\n        NEXT_ROUTER_PREFETCH\n    ]\n];\nexport const NEXT_RSC_UNION_QUERY = \"_rsc\";\n\n//# sourceMappingURL=app-router-headers.js.map","import { NEXT_RSC_UNION_QUERY } from \"../client/components/app-router-headers\";\nconst INTERNAL_QUERY_NAMES = [\n    \"__nextFallback\",\n    \"__nextLocale\",\n    \"__nextInferredLocaleFromDefault\",\n    \"__nextDefaultLocale\",\n    \"__nextIsNotFound\",\n    NEXT_RSC_UNION_QUERY\n];\nconst EDGE_EXTENDED_INTERNAL_QUERY_NAMES = [\n    \"__nextDataReq\"\n];\nexport function stripInternalQueries(query) {\n    for (const name of INTERNAL_QUERY_NAMES){\n        delete query[name];\n    }\n}\nexport function stripInternalSearchParams(url, isEdge) {\n    const isStringUrl = typeof url === \"string\";\n    const instance = isStringUrl ? new URL(url) : url;\n    for (const name of INTERNAL_QUERY_NAMES){\n        instance.searchParams.delete(name);\n    }\n    if (isEdge) {\n        for (const name of EDGE_EXTENDED_INTERNAL_QUERY_NAMES){\n            instance.searchParams.delete(name);\n        }\n    }\n    return isStringUrl ? instance.toString() : instance;\n}\n/**\n * Headers that are set by the Next.js server and should be stripped from the\n * request headers going to the user's application.\n */ const INTERNAL_HEADERS = [\n    \"x-invoke-path\",\n    \"x-invoke-status\",\n    \"x-invoke-error\",\n    \"x-invoke-query\",\n    \"x-invoke-output\",\n    \"x-middleware-invoke\"\n];\n/**\n * Strip internal headers from the request headers.\n *\n * @param headers the headers to strip of internal headers\n */ export function stripInternalHeaders(headers) {\n    for (const key of INTERNAL_HEADERS){\n        delete headers[key];\n    }\n}\n\n//# sourceMappingURL=internal-utils.js.map","import { ensureLeadingSlash } from \"../../page-path/ensure-leading-slash\";\nimport { isGroupSegment } from \"../../segment\";\n/**\n * Normalizes an app route so it represents the actual request path. Essentially\n * performing the following transformations:\n *\n * - `/(dashboard)/user/[id]/page` to `/user/[id]`\n * - `/(dashboard)/account/page` to `/account`\n * - `/user/[id]/page` to `/user/[id]`\n * - `/account/page` to `/account`\n * - `/page` to `/`\n * - `/(dashboard)/user/[id]/route` to `/user/[id]`\n * - `/(dashboard)/account/route` to `/account`\n * - `/user/[id]/route` to `/user/[id]`\n * - `/account/route` to `/account`\n * - `/route` to `/`\n * - `/` to `/`\n *\n * @param route the app route to normalize\n * @returns the normalized pathname\n */ export function normalizeAppPath(route) {\n    return ensureLeadingSlash(route.split(\"/\").reduce((pathname, segment, index, segments)=>{\n        // Empty segments are ignored.\n        if (!segment) {\n            return pathname;\n        }\n        // Groups are ignored.\n        if (isGroupSegment(segment)) {\n            return pathname;\n        }\n        // Parallel segments are ignored.\n        if (segment[0] === \"@\") {\n            return pathname;\n        }\n        // The last segment (if it's a leaf) should be ignored.\n        if ((segment === \"page\" || segment === \"route\") && index === segments.length - 1) {\n            return pathname;\n        }\n        return pathname + \"/\" + segment;\n    }, \"\"));\n}\n/**\n * Strips the `.rsc` extension if it's in the pathname.\n * Since this function is used on full urls it checks `?` for searchParams handling.\n */ export function normalizeRscURL(url) {\n    return url.replace(/\\.rsc($|\\?)/, // $1 ensures `?` is preserved\n    \"$1\");\n}\n/**\n * Strips the `/_next/postponed` prefix if it's in the pathname.\n *\n * @param url the url to normalize\n */ export function normalizePostponedURL(url) {\n    const parsed = new URL(url);\n    const { pathname } = parsed;\n    if (pathname && pathname.startsWith(\"/_next/postponed\")) {\n        parsed.pathname = pathname.substring(\"/_next/postponed\".length) || \"/\";\n        return parsed.toString();\n    }\n    return url;\n}\n\n//# sourceMappingURL=app-paths.js.map","export const NEXT_QUERY_PARAM_PREFIX = \"nxtP\";\nexport const PRERENDER_REVALIDATE_HEADER = \"x-prerender-revalidate\";\nexport const PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER = \"x-prerender-revalidate-if-generated\";\nexport const NEXT_DID_POSTPONE_HEADER = \"x-nextjs-postponed\";\nexport const NEXT_CACHE_TAGS_HEADER = \"x-next-cache-tags\";\nexport const NEXT_CACHE_SOFT_TAGS_HEADER = \"x-next-cache-soft-tags\";\nexport const NEXT_CACHE_REVALIDATED_TAGS_HEADER = \"x-next-revalidated-tags\";\nexport const NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER = \"x-next-revalidate-tag-token\";\nexport const NEXT_CACHE_TAG_MAX_LENGTH = 256;\nexport const NEXT_CACHE_SOFT_TAG_MAX_LENGTH = 1024;\nexport const NEXT_CACHE_IMPLICIT_TAG_ID = \"_N_T_\";\n// in seconds\nexport const CACHE_ONE_YEAR = 31536000;\n// Patterns to detect middleware files\nexport const MIDDLEWARE_FILENAME = \"middleware\";\nexport const MIDDLEWARE_LOCATION_REGEXP = `(?:src/)?${MIDDLEWARE_FILENAME}`;\n// Pattern to detect instrumentation hooks file\nexport const INSTRUMENTATION_HOOK_FILENAME = \"instrumentation\";\n// Because on Windows absolute paths in the generated code can break because of numbers, eg 1 in the path,\n// we have to use a private alias\nexport const PAGES_DIR_ALIAS = \"private-next-pages\";\nexport const DOT_NEXT_ALIAS = \"private-dot-next\";\nexport const ROOT_DIR_ALIAS = \"private-next-root-dir\";\nexport const APP_DIR_ALIAS = \"private-next-app-dir\";\nexport const RSC_MOD_REF_PROXY_ALIAS = \"private-next-rsc-mod-ref-proxy\";\nexport const RSC_ACTION_VALIDATE_ALIAS = \"private-next-rsc-action-validate\";\nexport const RSC_ACTION_PROXY_ALIAS = \"private-next-rsc-action-proxy\";\nexport const RSC_ACTION_ENCRYPTION_ALIAS = \"private-next-rsc-action-encryption\";\nexport const RSC_ACTION_CLIENT_WRAPPER_ALIAS = \"private-next-rsc-action-client-wrapper\";\nexport const PUBLIC_DIR_MIDDLEWARE_CONFLICT = `You can not have a '_next' folder inside of your public folder. This conflicts with the internal '/_next' route. https://nextjs.org/docs/messages/public-next-folder-conflict`;\nexport const SSG_GET_INITIAL_PROPS_CONFLICT = `You can not use getInitialProps with getStaticProps. To use SSG, please remove your getInitialProps`;\nexport const SERVER_PROPS_GET_INIT_PROPS_CONFLICT = `You can not use getInitialProps with getServerSideProps. Please remove getInitialProps.`;\nexport const SERVER_PROPS_SSG_CONFLICT = `You can not use getStaticProps or getStaticPaths with getServerSideProps. To use SSG, please remove getServerSideProps`;\nexport const STATIC_STATUS_PAGE_GET_INITIAL_PROPS_ERROR = `can not have getInitialProps/getServerSideProps, https://nextjs.org/docs/messages/404-get-initial-props`;\nexport const SERVER_PROPS_EXPORT_ERROR = `pages with \\`getServerSideProps\\` can not be exported. See more info here: https://nextjs.org/docs/messages/gssp-export`;\nexport const GSP_NO_RETURNED_VALUE = \"Your `getStaticProps` function did not return an object. Did you forget to add a `return`?\";\nexport const GSSP_NO_RETURNED_VALUE = \"Your `getServerSideProps` function did not return an object. Did you forget to add a `return`?\";\nexport const UNSTABLE_REVALIDATE_RENAME_ERROR = \"The `unstable_revalidate` property is available for general use.\\n\" + \"Please use `revalidate` instead.\";\nexport const GSSP_COMPONENT_MEMBER_ERROR = `can not be attached to a page's component and must be exported from the page. See more info here: https://nextjs.org/docs/messages/gssp-component-member`;\nexport const NON_STANDARD_NODE_ENV = `You are using a non-standard \"NODE_ENV\" value in your environment. This creates inconsistencies in the project and is strongly advised against. Read more: https://nextjs.org/docs/messages/non-standard-node-env`;\nexport const SSG_FALLBACK_EXPORT_ERROR = `Pages with \\`fallback\\` enabled in \\`getStaticPaths\\` can not be exported. See more info here: https://nextjs.org/docs/messages/ssg-fallback-true-export`;\nexport const ESLINT_DEFAULT_DIRS = [\n    \"app\",\n    \"pages\",\n    \"components\",\n    \"lib\",\n    \"src\"\n];\nexport const ESLINT_PROMPT_VALUES = [\n    {\n        title: \"Strict\",\n        recommended: true,\n        config: {\n            extends: \"next/core-web-vitals\"\n        }\n    },\n    {\n        title: \"Base\",\n        config: {\n            extends: \"next\"\n        }\n    },\n    {\n        title: \"Cancel\",\n        config: null\n    }\n];\nexport const SERVER_RUNTIME = {\n    edge: \"edge\",\n    experimentalEdge: \"experimental-edge\",\n    nodejs: \"nodejs\"\n};\n/**\n * The names of the webpack layers. These layers are the primitives for the\n * webpack chunks.\n */ const WEBPACK_LAYERS_NAMES = {\n    /**\n   * The layer for the shared code between the client and server bundles.\n   */ shared: \"shared\",\n    /**\n   * React Server Components layer (rsc).\n   */ reactServerComponents: \"rsc\",\n    /**\n   * Server Side Rendering layer for app (ssr).\n   */ serverSideRendering: \"ssr\",\n    /**\n   * The browser client bundle layer for actions.\n   */ actionBrowser: \"action-browser\",\n    /**\n   * The layer for the API routes.\n   */ api: \"api\",\n    /**\n   * The layer for the middleware code.\n   */ middleware: \"middleware\",\n    /**\n   * The layer for assets on the edge.\n   */ edgeAsset: \"edge-asset\",\n    /**\n   * The browser client bundle layer for App directory.\n   */ appPagesBrowser: \"app-pages-browser\",\n    /**\n   * The server bundle layer for metadata routes.\n   */ appMetadataRoute: \"app-metadata-route\",\n    /**\n   * The layer for the server bundle for App Route handlers.\n   */ appRouteHandler: \"app-route-handler\"\n};\nconst WEBPACK_LAYERS = {\n    ...WEBPACK_LAYERS_NAMES,\n    GROUP: {\n        server: [\n            WEBPACK_LAYERS_NAMES.reactServerComponents,\n            WEBPACK_LAYERS_NAMES.actionBrowser,\n            WEBPACK_LAYERS_NAMES.appMetadataRoute,\n            WEBPACK_LAYERS_NAMES.appRouteHandler\n        ],\n        nonClientServerTarget: [\n            // plus middleware and pages api\n            WEBPACK_LAYERS_NAMES.middleware,\n            WEBPACK_LAYERS_NAMES.api\n        ],\n        app: [\n            WEBPACK_LAYERS_NAMES.reactServerComponents,\n            WEBPACK_LAYERS_NAMES.actionBrowser,\n            WEBPACK_LAYERS_NAMES.appMetadataRoute,\n            WEBPACK_LAYERS_NAMES.appRouteHandler,\n            WEBPACK_LAYERS_NAMES.serverSideRendering,\n            WEBPACK_LAYERS_NAMES.appPagesBrowser\n        ]\n    }\n};\nconst WEBPACK_RESOURCE_QUERIES = {\n    edgeSSREntry: \"__next_edge_ssr_entry__\",\n    metadata: \"__next_metadata__\",\n    metadataRoute: \"__next_metadata_route__\",\n    metadataImageMeta: \"__next_metadata_image_meta__\"\n};\nexport { WEBPACK_LAYERS, WEBPACK_RESOURCE_QUERIES };\n\n//# sourceMappingURL=constants.js.map","export class ReflectAdapter {\n    static get(target, prop, receiver) {\n        const value = Reflect.get(target, prop, receiver);\n        if (typeof value === \"function\") {\n            return value.bind(target);\n        }\n        return value;\n    }\n    static set(target, prop, value, receiver) {\n        return Reflect.set(target, prop, value, receiver);\n    }\n    static has(target, prop) {\n        return Reflect.has(target, prop);\n    }\n    static deleteProperty(target, prop) {\n        return Reflect.deleteProperty(target, prop);\n    }\n}\n\n//# sourceMappingURL=reflect.js.map","import { ReflectAdapter } from \"./reflect\";\n/**\n * @internal\n */ export class ReadonlyHeadersError extends Error {\n    constructor(){\n        super(\"Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers\");\n    }\n    static callable() {\n        throw new ReadonlyHeadersError();\n    }\n}\nexport class HeadersAdapter extends Headers {\n    constructor(headers){\n        // We've already overridden the methods that would be called, so we're just\n        // calling the super constructor to ensure that the instanceof check works.\n        super();\n        this.headers = new Proxy(headers, {\n            get (target, prop, receiver) {\n                // Because this is just an object, we expect that all \"get\" operations\n                // are for properties. If it's a \"get\" for a symbol, we'll just return\n                // the symbol.\n                if (typeof prop === \"symbol\") {\n                    return ReflectAdapter.get(target, prop, receiver);\n                }\n                const lowercased = prop.toLowerCase();\n                // Let's find the original casing of the key. This assumes that there is\n                // no mixed case keys (e.g. \"Content-Type\" and \"content-type\") in the\n                // headers object.\n                const original = Object.keys(headers).find((o)=>o.toLowerCase() === lowercased);\n                // If the original casing doesn't exist, return undefined.\n                if (typeof original === \"undefined\") return;\n                // If the original casing exists, return the value.\n                return ReflectAdapter.get(target, original, receiver);\n            },\n            set (target, prop, value, receiver) {\n                if (typeof prop === \"symbol\") {\n                    return ReflectAdapter.set(target, prop, value, receiver);\n                }\n                const lowercased = prop.toLowerCase();\n                // Let's find the original casing of the key. This assumes that there is\n                // no mixed case keys (e.g. \"Content-Type\" and \"content-type\") in the\n                // headers object.\n                const original = Object.keys(headers).find((o)=>o.toLowerCase() === lowercased);\n                // If the original casing doesn't exist, use the prop as the key.\n                return ReflectAdapter.set(target, original ?? prop, value, receiver);\n            },\n            has (target, prop) {\n                if (typeof prop === \"symbol\") return ReflectAdapter.has(target, prop);\n                const lowercased = prop.toLowerCase();\n                // Let's find the original casing of the key. This assumes that there is\n                // no mixed case keys (e.g. \"Content-Type\" and \"content-type\") in the\n                // headers object.\n                const original = Object.keys(headers).find((o)=>o.toLowerCase() === lowercased);\n                // If the original casing doesn't exist, return false.\n                if (typeof original === \"undefined\") return false;\n                // If the original casing exists, return true.\n                return ReflectAdapter.has(target, original);\n            },\n            deleteProperty (target, prop) {\n                if (typeof prop === \"symbol\") return ReflectAdapter.deleteProperty(target, prop);\n                const lowercased = prop.toLowerCase();\n                // Let's find the original casing of the key. This assumes that there is\n                // no mixed case keys (e.g. \"Content-Type\" and \"content-type\") in the\n                // headers object.\n                const original = Object.keys(headers).find((o)=>o.toLowerCase() === lowercased);\n                // If the original casing doesn't exist, return true.\n                if (typeof original === \"undefined\") return true;\n                // If the original casing exists, delete the property.\n                return ReflectAdapter.deleteProperty(target, original);\n            }\n        });\n    }\n    /**\n   * Seals a Headers instance to prevent modification by throwing an error when\n   * any mutating method is called.\n   */ static seal(headers) {\n        return new Proxy(headers, {\n            get (target, prop, receiver) {\n                switch(prop){\n                    case \"append\":\n                    case \"delete\":\n                    case \"set\":\n                        return ReadonlyHeadersError.callable;\n                    default:\n                        return ReflectAdapter.get(target, prop, receiver);\n                }\n            }\n        });\n    }\n    /**\n   * Merges a header value into a string. This stores multiple values as an\n   * array, so we need to merge them into a string.\n   *\n   * @param value a header value\n   * @returns a merged header value (a string)\n   */ merge(value) {\n        if (Array.isArray(value)) return value.join(\", \");\n        return value;\n    }\n    /**\n   * Creates a Headers instance from a plain object or a Headers instance.\n   *\n   * @param headers a plain object or a Headers instance\n   * @returns a headers instance\n   */ static from(headers) {\n        if (headers instanceof Headers) return headers;\n        return new HeadersAdapter(headers);\n    }\n    append(name, value) {\n        const existing = this.headers[name];\n        if (typeof existing === \"string\") {\n            this.headers[name] = [\n                existing,\n                value\n            ];\n        } else if (Array.isArray(existing)) {\n            existing.push(value);\n        } else {\n            this.headers[name] = value;\n        }\n    }\n    delete(name) {\n        delete this.headers[name];\n    }\n    get(name) {\n        const value = this.headers[name];\n        if (typeof value !== \"undefined\") return this.merge(value);\n        return null;\n    }\n    has(name) {\n        return typeof this.headers[name] !== \"undefined\";\n    }\n    set(name, value) {\n        this.headers[name] = value;\n    }\n    forEach(callbackfn, thisArg) {\n        for (const [name, value] of this.entries()){\n            callbackfn.call(thisArg, value, name, this);\n        }\n    }\n    *entries() {\n        for (const key of Object.keys(this.headers)){\n            const name = key.toLowerCase();\n            // We assert here that this is a string because we got it from the\n            // Object.keys() call above.\n            const value = this.get(name);\n            yield [\n                name,\n                value\n            ];\n        }\n    }\n    *keys() {\n        for (const key of Object.keys(this.headers)){\n            const name = key.toLowerCase();\n            yield name;\n        }\n    }\n    *values() {\n        for (const key of Object.keys(this.headers)){\n            // We assert here that this is a string because we got it from the\n            // Object.keys() call above.\n            const value = this.get(key);\n            yield value;\n        }\n    }\n    [Symbol.iterator]() {\n        return this.entries();\n    }\n}\n\n//# sourceMappingURL=headers.js.map","import { ResponseCookies } from \"../cookies\";\nimport { ReflectAdapter } from \"./reflect\";\n/**\n * @internal\n */ export class ReadonlyRequestCookiesError extends Error {\n    constructor(){\n        super(\"Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#cookiessetname-value-options\");\n    }\n    static callable() {\n        throw new ReadonlyRequestCookiesError();\n    }\n}\nexport class RequestCookiesAdapter {\n    static seal(cookies) {\n        return new Proxy(cookies, {\n            get (target, prop, receiver) {\n                switch(prop){\n                    case \"clear\":\n                    case \"delete\":\n                    case \"set\":\n                        return ReadonlyRequestCookiesError.callable;\n                    default:\n                        return ReflectAdapter.get(target, prop, receiver);\n                }\n            }\n        });\n    }\n}\nconst SYMBOL_MODIFY_COOKIE_VALUES = Symbol.for(\"next.mutated.cookies\");\nexport function getModifiedCookieValues(cookies) {\n    const modified = cookies[SYMBOL_MODIFY_COOKIE_VALUES];\n    if (!modified || !Array.isArray(modified) || modified.length === 0) {\n        return [];\n    }\n    return modified;\n}\nexport function appendMutableCookies(headers, mutableCookies) {\n    const modifiedCookieValues = getModifiedCookieValues(mutableCookies);\n    if (modifiedCookieValues.length === 0) {\n        return false;\n    }\n    // Return a new response that extends the response with\n    // the modified cookies as fallbacks. `res` cookies\n    // will still take precedence.\n    const resCookies = new ResponseCookies(headers);\n    const returnedCookies = resCookies.getAll();\n    // Set the modified cookies as fallbacks.\n    for (const cookie of modifiedCookieValues){\n        resCookies.set(cookie);\n    }\n    // Set the original cookies as the final values.\n    for (const cookie of returnedCookies){\n        resCookies.set(cookie);\n    }\n    return true;\n}\nexport class MutableRequestCookiesAdapter {\n    static wrap(cookies, onUpdateCookies) {\n        const responseCookes = new ResponseCookies(new Headers());\n        for (const cookie of cookies.getAll()){\n            responseCookes.set(cookie);\n        }\n        let modifiedValues = [];\n        const modifiedCookies = new Set();\n        const updateResponseCookies = ()=>{\n            var _fetch___nextGetStaticStore;\n            // TODO-APP: change method of getting staticGenerationAsyncStore\n            const staticGenerationAsyncStore = fetch.__nextGetStaticStore == null ? void 0 : (_fetch___nextGetStaticStore = fetch.__nextGetStaticStore.call(fetch)) == null ? void 0 : _fetch___nextGetStaticStore.getStore();\n            if (staticGenerationAsyncStore) {\n                staticGenerationAsyncStore.pathWasRevalidated = true;\n            }\n            const allCookies = responseCookes.getAll();\n            modifiedValues = allCookies.filter((c)=>modifiedCookies.has(c.name));\n            if (onUpdateCookies) {\n                const serializedCookies = [];\n                for (const cookie of modifiedValues){\n                    const tempCookies = new ResponseCookies(new Headers());\n                    tempCookies.set(cookie);\n                    serializedCookies.push(tempCookies.toString());\n                }\n                onUpdateCookies(serializedCookies);\n            }\n        };\n        return new Proxy(responseCookes, {\n            get (target, prop, receiver) {\n                switch(prop){\n                    // A special symbol to get the modified cookie values\n                    case SYMBOL_MODIFY_COOKIE_VALUES:\n                        return modifiedValues;\n                    // TODO: Throw error if trying to set a cookie after the response\n                    // headers have been set.\n                    case \"delete\":\n                        return function(...args) {\n                            modifiedCookies.add(typeof args[0] === \"string\" ? args[0] : args[0].name);\n                            try {\n                                target.delete(...args);\n                            } finally{\n                                updateResponseCookies();\n                            }\n                        };\n                    case \"set\":\n                        return function(...args) {\n                            modifiedCookies.add(typeof args[0] === \"string\" ? args[0] : args[0].name);\n                            try {\n                                return target.set(...args);\n                            } finally{\n                                updateResponseCookies();\n                            }\n                        };\n                    default:\n                        return ReflectAdapter.get(target, prop, receiver);\n                }\n            }\n        });\n    }\n}\n\n//# sourceMappingURL=request-cookies.js.map","import { HeadersAdapter } from \"../web/spec-extension/adapters/headers\";\nimport { PRERENDER_REVALIDATE_HEADER, PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER } from \"../../lib/constants\";\n/**\n *\n * @param res response object\n * @param statusCode `HTTP` status code of response\n */ export function sendStatusCode(res, statusCode) {\n    res.statusCode = statusCode;\n    return res;\n}\n/**\n *\n * @param res response object\n * @param [statusOrUrl] `HTTP` status code of redirect\n * @param url URL of redirect\n */ export function redirect(res, statusOrUrl, url) {\n    if (typeof statusOrUrl === \"string\") {\n        url = statusOrUrl;\n        statusOrUrl = 307;\n    }\n    if (typeof statusOrUrl !== \"number\" || typeof url !== \"string\") {\n        throw new Error(`Invalid redirect arguments. Please use a single argument URL, e.g. res.redirect('/destination') or use a status code and URL, e.g. res.redirect(307, '/destination').`);\n    }\n    res.writeHead(statusOrUrl, {\n        Location: url\n    });\n    res.write(url);\n    res.end();\n    return res;\n}\nexport function checkIsOnDemandRevalidate(req, previewProps) {\n    const headers = HeadersAdapter.from(req.headers);\n    const previewModeId = headers.get(PRERENDER_REVALIDATE_HEADER);\n    const isOnDemandRevalidate = previewModeId === previewProps.previewModeId;\n    const revalidateOnlyGenerated = headers.has(PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER);\n    return {\n        isOnDemandRevalidate,\n        revalidateOnlyGenerated\n    };\n}\nexport const COOKIE_NAME_PRERENDER_BYPASS = `__prerender_bypass`;\nexport const COOKIE_NAME_PRERENDER_DATA = `__next_preview_data`;\nexport const RESPONSE_LIMIT_DEFAULT = 4 * 1024 * 1024;\nexport const SYMBOL_PREVIEW_DATA = Symbol(COOKIE_NAME_PRERENDER_DATA);\nexport const SYMBOL_CLEARED_COOKIES = Symbol(COOKIE_NAME_PRERENDER_BYPASS);\nexport function clearPreviewData(res, options = {}) {\n    if (SYMBOL_CLEARED_COOKIES in res) {\n        return res;\n    }\n    const { serialize } = require(\"next/dist/compiled/cookie\");\n    const previous = res.getHeader(\"Set-Cookie\");\n    res.setHeader(`Set-Cookie`, [\n        ...typeof previous === \"string\" ? [\n            previous\n        ] : Array.isArray(previous) ? previous : [],\n        serialize(COOKIE_NAME_PRERENDER_BYPASS, \"\", {\n            // To delete a cookie, set `expires` to a date in the past:\n            // https://tools.ietf.org/html/rfc6265#section-4.1.1\n            // `Max-Age: 0` is not valid, thus ignored, and the cookie is persisted.\n            expires: new Date(0),\n            httpOnly: true,\n            sameSite: process.env.NODE_ENV !== \"development\" ? \"none\" : \"lax\",\n            secure: process.env.NODE_ENV !== \"development\",\n            path: \"/\",\n            ...options.path !== undefined ? {\n                path: options.path\n            } : undefined\n        }),\n        serialize(COOKIE_NAME_PRERENDER_DATA, \"\", {\n            // To delete a cookie, set `expires` to a date in the past:\n            // https://tools.ietf.org/html/rfc6265#section-4.1.1\n            // `Max-Age: 0` is not valid, thus ignored, and the cookie is persisted.\n            expires: new Date(0),\n            httpOnly: true,\n            sameSite: process.env.NODE_ENV !== \"development\" ? \"none\" : \"lax\",\n            secure: process.env.NODE_ENV !== \"development\",\n            path: \"/\",\n            ...options.path !== undefined ? {\n                path: options.path\n            } : undefined\n        })\n    ]);\n    Object.defineProperty(res, SYMBOL_CLEARED_COOKIES, {\n        value: true,\n        enumerable: false\n    });\n    return res;\n}\n/**\n * Custom error class\n */ export class ApiError extends Error {\n    constructor(statusCode, message){\n        super(message);\n        this.statusCode = statusCode;\n    }\n}\n/**\n * Sends error in `response`\n * @param res response object\n * @param statusCode of response\n * @param message of response\n */ export function sendError(res, statusCode, message) {\n    res.statusCode = statusCode;\n    res.statusMessage = message;\n    res.end(message);\n}\n/**\n * Execute getter function only if its needed\n * @param LazyProps `req` and `params` for lazyProp\n * @param prop name of property\n * @param getter function to get data\n */ export function setLazyProp({ req }, prop, getter) {\n    const opts = {\n        configurable: true,\n        enumerable: true\n    };\n    const optsReset = {\n        ...opts,\n        writable: true\n    };\n    Object.defineProperty(req, prop, {\n        ...opts,\n        get: ()=>{\n            const value = getter();\n            // we set the property on the object to avoid recalculating it\n            Object.defineProperty(req, prop, {\n                ...optsReset,\n                value\n            });\n            return value;\n        },\n        set: (value)=>{\n            Object.defineProperty(req, prop, {\n                ...optsReset,\n                value\n            });\n        }\n    });\n}\n\n//# sourceMappingURL=index.js.map","import { COOKIE_NAME_PRERENDER_BYPASS, checkIsOnDemandRevalidate } from \"../api-utils\";\nexport class DraftModeProvider {\n    constructor(previewProps, req, cookies, mutableCookies){\n        var _cookies_get;\n        // The logic for draftMode() is very similar to tryGetPreviewData()\n        // but Draft Mode does not have any data associated with it.\n        const isOnDemandRevalidate = previewProps && checkIsOnDemandRevalidate(req, previewProps).isOnDemandRevalidate;\n        const cookieValue = (_cookies_get = cookies.get(COOKIE_NAME_PRERENDER_BYPASS)) == null ? void 0 : _cookies_get.value;\n        this.isEnabled = Boolean(!isOnDemandRevalidate && cookieValue && previewProps && cookieValue === previewProps.previewModeId);\n        this._previewModeId = previewProps == null ? void 0 : previewProps.previewModeId;\n        this._mutableCookies = mutableCookies;\n    }\n    enable() {\n        if (!this._previewModeId) {\n            throw new Error(\"Invariant: previewProps missing previewModeId this should never happen\");\n        }\n        this._mutableCookies.set({\n            name: COOKIE_NAME_PRERENDER_BYPASS,\n            value: this._previewModeId,\n            httpOnly: true,\n            sameSite: process.env.NODE_ENV !== \"development\" ? \"none\" : \"lax\",\n            secure: process.env.NODE_ENV !== \"development\",\n            path: \"/\"\n        });\n    }\n    disable() {\n        // To delete a cookie, set `expires` to a date in the past:\n        // https://tools.ietf.org/html/rfc6265#section-4.1.1\n        // `Max-Age: 0` is not valid, thus ignored, and the cookie is persisted.\n        this._mutableCookies.set({\n            name: COOKIE_NAME_PRERENDER_BYPASS,\n            value: \"\",\n            httpOnly: true,\n            sameSite: process.env.NODE_ENV !== \"development\" ? \"none\" : \"lax\",\n            secure: process.env.NODE_ENV !== \"development\",\n            path: \"/\",\n            expires: new Date(0)\n        });\n    }\n}\n\n//# sourceMappingURL=draft-mode-provider.js.map","import { FLIGHT_PARAMETERS } from \"../../client/components/app-router-headers\";\nimport { HeadersAdapter } from \"../web/spec-extension/adapters/headers\";\nimport { MutableRequestCookiesAdapter, RequestCookiesAdapter } from \"../web/spec-extension/adapters/request-cookies\";\nimport { RequestCookies } from \"../web/spec-extension/cookies\";\nimport { DraftModeProvider } from \"./draft-mode-provider\";\nfunction getHeaders(headers) {\n    const cleaned = HeadersAdapter.from(headers);\n    for (const param of FLIGHT_PARAMETERS){\n        cleaned.delete(param.toString().toLowerCase());\n    }\n    return HeadersAdapter.seal(cleaned);\n}\nfunction getCookies(headers) {\n    const cookies = new RequestCookies(HeadersAdapter.from(headers));\n    return RequestCookiesAdapter.seal(cookies);\n}\nfunction getMutableCookies(headers, onUpdateCookies) {\n    const cookies = new RequestCookies(HeadersAdapter.from(headers));\n    return MutableRequestCookiesAdapter.wrap(cookies, onUpdateCookies);\n}\nexport const RequestAsyncStorageWrapper = {\n    /**\n   * Wrap the callback with the given store so it can access the underlying\n   * store using hooks.\n   *\n   * @param storage underlying storage object returned by the module\n   * @param context context to seed the store\n   * @param callback function to call within the scope of the context\n   * @returns the result returned by the callback\n   */ wrap (storage, { req, res, renderOpts }, callback) {\n        let previewProps = undefined;\n        if (renderOpts && \"previewProps\" in renderOpts) {\n            // TODO: investigate why previewProps isn't on RenderOpts\n            previewProps = renderOpts.previewProps;\n        }\n        function defaultOnUpdateCookies(cookies) {\n            if (res) {\n                res.setHeader(\"Set-Cookie\", cookies);\n            }\n        }\n        const cache = {};\n        const store = {\n            get headers () {\n                if (!cache.headers) {\n                    // Seal the headers object that'll freeze out any methods that could\n                    // mutate the underlying data.\n                    cache.headers = getHeaders(req.headers);\n                }\n                return cache.headers;\n            },\n            get cookies () {\n                if (!cache.cookies) {\n                    // Seal the cookies object that'll freeze out any methods that could\n                    // mutate the underlying data.\n                    cache.cookies = getCookies(req.headers);\n                }\n                return cache.cookies;\n            },\n            get mutableCookies () {\n                if (!cache.mutableCookies) {\n                    cache.mutableCookies = getMutableCookies(req.headers, (renderOpts == null ? void 0 : renderOpts.onUpdateCookies) || (res ? defaultOnUpdateCookies : undefined));\n                }\n                return cache.mutableCookies;\n            },\n            get draftMode () {\n                if (!cache.draftMode) {\n                    cache.draftMode = new DraftModeProvider(previewProps, req, this.cookies, this.mutableCookies);\n                }\n                return cache.draftMode;\n            }\n        };\n        return storage.run(store, callback, store);\n    }\n};\n\n//# sourceMappingURL=request-async-storage-wrapper.js.map","const sharedAsyncLocalStorageNotAvailableError = new Error(\"Invariant: AsyncLocalStorage accessed in runtime where it is not available\");\nclass FakeAsyncLocalStorage {\n    disable() {\n        throw sharedAsyncLocalStorageNotAvailableError;\n    }\n    getStore() {\n        // This fake implementation of AsyncLocalStorage always returns `undefined`.\n        return undefined;\n    }\n    run() {\n        throw sharedAsyncLocalStorageNotAvailableError;\n    }\n    exit() {\n        throw sharedAsyncLocalStorageNotAvailableError;\n    }\n    enterWith() {\n        throw sharedAsyncLocalStorageNotAvailableError;\n    }\n}\nconst maybeGlobalAsyncLocalStorage = globalThis.AsyncLocalStorage;\nexport function createAsyncLocalStorage() {\n    if (maybeGlobalAsyncLocalStorage) {\n        return new maybeGlobalAsyncLocalStorage();\n    }\n    return new FakeAsyncLocalStorage();\n}\n\n//# sourceMappingURL=async-local-storage.js.map","import { createAsyncLocalStorage } from \"./async-local-storage\";\nexport const requestAsyncStorage = createAsyncLocalStorage();\n\n//# sourceMappingURL=request-async-storage.external.js.map","import { PageSignatureError } from \"./error\";\nimport { fromNodeOutgoingHttpHeaders } from \"./utils\";\nimport { NextFetchEvent } from \"./spec-extension/fetch-event\";\nimport { NextRequest } from \"./spec-extension/request\";\nimport { NextResponse } from \"./spec-extension/response\";\nimport { relativizeURL } from \"../../shared/lib/router/utils/relativize-url\";\nimport { waitUntilSymbol } from \"./spec-extension/fetch-event\";\nimport { NextURL } from \"./next-url\";\nimport { stripInternalSearchParams } from \"../internal-utils\";\nimport { normalizeRscURL } from \"../../shared/lib/router/utils/app-paths\";\nimport { NEXT_ROUTER_PREFETCH, NEXT_ROUTER_STATE_TREE, RSC } from \"../../client/components/app-router-headers\";\nimport { NEXT_QUERY_PARAM_PREFIX } from \"../../lib/constants\";\nimport { ensureInstrumentationRegistered } from \"./globals\";\nimport { RequestAsyncStorageWrapper } from \"../async-storage/request-async-storage-wrapper\";\nimport { requestAsyncStorage } from \"../../client/components/request-async-storage.external\";\nclass NextRequestHint extends NextRequest {\n    constructor(params){\n        super(params.input, params.init);\n        this.sourcePage = params.page;\n    }\n    get request() {\n        throw new PageSignatureError({\n            page: this.sourcePage\n        });\n    }\n    respondWith() {\n        throw new PageSignatureError({\n            page: this.sourcePage\n        });\n    }\n    waitUntil() {\n        throw new PageSignatureError({\n            page: this.sourcePage\n        });\n    }\n}\nconst FLIGHT_PARAMETERS = [\n    [\n        RSC\n    ],\n    [\n        NEXT_ROUTER_STATE_TREE\n    ],\n    [\n        NEXT_ROUTER_PREFETCH\n    ]\n];\nexport async function adapter(params) {\n    await ensureInstrumentationRegistered();\n    // TODO-APP: use explicit marker for this\n    const isEdgeRendering = typeof self.__BUILD_MANIFEST !== \"undefined\";\n    const prerenderManifest = typeof self.__PRERENDER_MANIFEST === \"string\" ? JSON.parse(self.__PRERENDER_MANIFEST) : undefined;\n    params.request.url = normalizeRscURL(params.request.url);\n    const requestUrl = new NextURL(params.request.url, {\n        headers: params.request.headers,\n        nextConfig: params.request.nextConfig\n    });\n    // Iterator uses an index to keep track of the current iteration. Because of deleting and appending below we can't just use the iterator.\n    // Instead we use the keys before iteration.\n    const keys = [\n        ...requestUrl.searchParams.keys()\n    ];\n    for (const key of keys){\n        const value = requestUrl.searchParams.getAll(key);\n        if (key !== NEXT_QUERY_PARAM_PREFIX && key.startsWith(NEXT_QUERY_PARAM_PREFIX)) {\n            const normalizedKey = key.substring(NEXT_QUERY_PARAM_PREFIX.length);\n            requestUrl.searchParams.delete(normalizedKey);\n            for (const val of value){\n                requestUrl.searchParams.append(normalizedKey, val);\n            }\n            requestUrl.searchParams.delete(key);\n        }\n    }\n    // Ensure users only see page requests, never data requests.\n    const buildId = requestUrl.buildId;\n    requestUrl.buildId = \"\";\n    const isDataReq = params.request.headers[\"x-nextjs-data\"];\n    if (isDataReq && requestUrl.pathname === \"/index\") {\n        requestUrl.pathname = \"/\";\n    }\n    const requestHeaders = fromNodeOutgoingHttpHeaders(params.request.headers);\n    const flightHeaders = new Map();\n    // Parameters should only be stripped for middleware\n    if (!isEdgeRendering) {\n        for (const param of FLIGHT_PARAMETERS){\n            const key = param.toString().toLowerCase();\n            const value = requestHeaders.get(key);\n            if (value) {\n                flightHeaders.set(key, requestHeaders.get(key));\n                requestHeaders.delete(key);\n            }\n        }\n    }\n    const normalizeUrl = process.env.__NEXT_NO_MIDDLEWARE_URL_NORMALIZE ? new URL(params.request.url) : requestUrl;\n    const request = new NextRequestHint({\n        page: params.page,\n        // Strip internal query parameters off the request.\n        input: stripInternalSearchParams(normalizeUrl, true).toString(),\n        init: {\n            body: params.request.body,\n            geo: params.request.geo,\n            headers: requestHeaders,\n            ip: params.request.ip,\n            method: params.request.method,\n            nextConfig: params.request.nextConfig,\n            signal: params.request.signal\n        }\n    });\n    /**\n   * This allows to identify the request as a data request. The user doesn't\n   * need to know about this property neither use it. We add it for testing\n   * purposes.\n   */ if (isDataReq) {\n        Object.defineProperty(request, \"__isData\", {\n            enumerable: false,\n            value: true\n        });\n    }\n    if (!globalThis.__incrementalCache && params.IncrementalCache) {\n        globalThis.__incrementalCache = new params.IncrementalCache({\n            appDir: true,\n            fetchCache: true,\n            minimalMode: process.env.NODE_ENV !== \"development\",\n            fetchCacheKeyPrefix: process.env.__NEXT_FETCH_CACHE_KEY_PREFIX,\n            dev: process.env.NODE_ENV === \"development\",\n            requestHeaders: params.request.headers,\n            requestProtocol: \"https\",\n            getPrerenderManifest: ()=>{\n                return {\n                    version: -1,\n                    routes: {},\n                    dynamicRoutes: {},\n                    notFoundRoutes: [],\n                    preview: {\n                        previewModeId: \"development-id\"\n                    }\n                };\n            }\n        });\n    }\n    const event = new NextFetchEvent({\n        request,\n        page: params.page\n    });\n    let response;\n    let cookiesFromResponse;\n    // we only care to make async storage available for middleware\n    const isMiddleware = params.page === \"/middleware\" || params.page === \"/src/middleware\";\n    if (isMiddleware) {\n        response = await RequestAsyncStorageWrapper.wrap(requestAsyncStorage, {\n            req: request,\n            renderOpts: {\n                onUpdateCookies: (cookies)=>{\n                    cookiesFromResponse = cookies;\n                },\n                // @ts-expect-error: TODO: investigate why previewProps isn't on RenderOpts\n                previewProps: (prerenderManifest == null ? void 0 : prerenderManifest.preview) || {\n                    previewModeId: \"development-id\",\n                    previewModeEncryptionKey: \"\",\n                    previewModeSigningKey: \"\"\n                }\n            }\n        }, ()=>params.handler(request, event));\n    } else {\n        response = await params.handler(request, event);\n    }\n    // check if response is a Response object\n    if (response && !(response instanceof Response)) {\n        throw new TypeError(\"Expected an instance of Response to be returned\");\n    }\n    if (response && cookiesFromResponse) {\n        response.headers.set(\"set-cookie\", cookiesFromResponse);\n    }\n    /**\n   * For rewrites we must always include the locale in the final pathname\n   * so we re-create the NextURL forcing it to include it when the it is\n   * an internal rewrite. Also we make sure the outgoing rewrite URL is\n   * a data URL if the request was a data request.\n   */ const rewrite = response == null ? void 0 : response.headers.get(\"x-middleware-rewrite\");\n    if (response && rewrite) {\n        const rewriteUrl = new NextURL(rewrite, {\n            forceLocale: true,\n            headers: params.request.headers,\n            nextConfig: params.request.nextConfig\n        });\n        if (!process.env.__NEXT_NO_MIDDLEWARE_URL_NORMALIZE) {\n            if (rewriteUrl.host === request.nextUrl.host) {\n                rewriteUrl.buildId = buildId || rewriteUrl.buildId;\n                response.headers.set(\"x-middleware-rewrite\", String(rewriteUrl));\n            }\n        }\n        /**\n     * When the request is a data request we must show if there was a rewrite\n     * with an internal header so the client knows which component to load\n     * from the data request.\n     */ const relativizedRewrite = relativizeURL(String(rewriteUrl), String(requestUrl));\n        if (isDataReq && // if the rewrite is external and external rewrite\n        // resolving config is enabled don't add this header\n        // so the upstream app can set it instead\n        !(process.env.__NEXT_EXTERNAL_MIDDLEWARE_REWRITE_RESOLVE && relativizedRewrite.match(/http(s)?:\\/\\//))) {\n            response.headers.set(\"x-nextjs-rewrite\", relativizedRewrite);\n        }\n    }\n    /**\n   * For redirects we will not include the locale in case when it is the\n   * default and we must also make sure the outgoing URL is a data one if\n   * the incoming request was a data request.\n   */ const redirect = response == null ? void 0 : response.headers.get(\"Location\");\n    if (response && redirect && !isEdgeRendering) {\n        const redirectURL = new NextURL(redirect, {\n            forceLocale: false,\n            headers: params.request.headers,\n            nextConfig: params.request.nextConfig\n        });\n        /**\n     * Responses created from redirects have immutable headers so we have\n     * to clone the response to be able to modify it.\n     */ response = new Response(response.body, response);\n        if (!process.env.__NEXT_NO_MIDDLEWARE_URL_NORMALIZE) {\n            if (redirectURL.host === request.nextUrl.host) {\n                redirectURL.buildId = buildId || redirectURL.buildId;\n                response.headers.set(\"Location\", String(redirectURL));\n            }\n        }\n        /**\n     * When the request is a data request we can't use the location header as\n     * it may end up with CORS error. Instead we map to an internal header so\n     * the client knows the destination.\n     */ if (isDataReq) {\n            response.headers.delete(\"Location\");\n            response.headers.set(\"x-nextjs-redirect\", relativizeURL(String(redirectURL), String(requestUrl)));\n        }\n    }\n    const finalResponse = response ? response : NextResponse.next();\n    // Flight headers are not overridable / removable so they are applied at the end.\n    const middlewareOverrideHeaders = finalResponse.headers.get(\"x-middleware-override-headers\");\n    const overwrittenHeaders = [];\n    if (middlewareOverrideHeaders) {\n        for (const [key, value] of flightHeaders){\n            finalResponse.headers.set(`x-middleware-request-${key}`, value);\n            overwrittenHeaders.push(key);\n        }\n        if (overwrittenHeaders.length > 0) {\n            finalResponse.headers.set(\"x-middleware-override-headers\", middlewareOverrideHeaders + \",\" + overwrittenHeaders.join(\",\"));\n        }\n    }\n    return {\n        response: finalResponse,\n        waitUntil: Promise.all(event[waitUntilSymbol]),\n        fetchMetrics: request.fetchMetrics\n    };\n}\n\n//# sourceMappingURL=adapter.js.map","// This file is for modularized imports for next/server to get fully-treeshaking.\nexport { NextResponse as default } from \"../spec-extension/response\";\n\n//# sourceMappingURL=next-response.js.map","import { NextRequest, NextResponse } from 'next/server';\nimport { jwtVerify } from 'jose';\n\ninterface UserPayload {\n  user_id: string;\n  email: string;\n  subscription_plan: 'free' | 'basic' | 'premium';\n  subscription_status: 'active' | 'trial' | 'expired' | 'cancelled';\n  exp: number;\n}\n\n// Define protected routes and their required subscription levels\n// Only include routes that require paid subscriptions (basic/premium)\nconst PROTECTED_ROUTES = {\n  '/dashboard/analytics': 'basic',\n  '/dashboard/ai-insights': 'basic',\n  '/dashboard/social-trading': 'basic',\n  '/dashboard/institutional': 'premium',\n  '/dashboard/advanced-charts': 'basic',\n  '/dashboard/portfolio/advanced': 'basic',\n  '/dashboard/watchlist/premium': 'premium',\n  '/api/analytics': 'basic',\n  '/api/ai-insights': 'basic',\n  '/api/social-trading': 'basic',\n  '/api/institutional': 'premium',\n} as const;\n\n// Features that require specific subscription levels\nconst FEATURE_ACCESS = {\n  'real_time_data': 'basic',\n  'advanced_charts': 'basic',\n  'price_alerts': 'basic',\n  'technical_indicators': 'basic',\n  'ai_insights': 'basic',\n  'social_trading': 'basic',\n  'institutional_tools': 'premium',\n  'priority_support': 'premium',\n  'unlimited_portfolios': 'premium',\n  'unlimited_watchlists': 'premium',\n} as const;\n\nexport async function subscriptionMiddleware(request: NextRequest): Promise<NextResponse> {\n  const { pathname } = request.nextUrl;\n  \n  // Check if the route requires subscription access\n  const requiredPlan = getRequiredPlanForRoute(pathname);\n  if (!requiredPlan) {\n    return NextResponse.next();\n  }\n\n  // Get the access token from cookies or headers\n  const token = request.cookies.get('access_token')?.value || \n                request.headers.get('authorization')?.replace('Bearer ', '');\n\n  if (!token) {\n    return createUnauthorizedResponse('Authentication required');\n  }\n\n  try {\n    // Verify and decode the JWT token\n    const secret = new TextEncoder().encode(process.env.JWT_SECRET || 'your-secret-key-here-change-in-production');\n    const { payload } = await jwtVerify(token, secret) as { payload: UserPayload };\n\n    // Check if user has required subscription level\n    if (!hasSubscriptionAccess(payload, requiredPlan)) {\n      return createSubscriptionRequiredResponse(requiredPlan, pathname);\n    }\n\n    // Add user subscription info to headers for downstream use\n    const requestHeaders = new Headers(request.headers);\n    requestHeaders.set('x-user-subscription-plan', payload.subscription_plan);\n    requestHeaders.set('x-user-subscription-status', payload.subscription_status);\n    requestHeaders.set('x-user-id', payload.user_id);\n\n    return NextResponse.next({\n      request: {\n        headers: requestHeaders,\n      },\n    });\n  } catch (error) {\n    console.error('Subscription middleware error:', error);\n    return createUnauthorizedResponse('Invalid token');\n  }\n}\n\nfunction getRequiredPlanForRoute(pathname: string): 'free' | 'basic' | 'premium' | null {\n  // Check exact matches first\n  if (pathname in PROTECTED_ROUTES) {\n    return PROTECTED_ROUTES[pathname as keyof typeof PROTECTED_ROUTES] as 'free' | 'basic' | 'premium';\n  }\n\n  // Check for partial matches (e.g., API routes with parameters)\n  for (const [route, plan] of Object.entries(PROTECTED_ROUTES)) {\n    if (pathname.startsWith(route)) {\n      return plan as 'free' | 'basic' | 'premium';\n    }\n  }\n\n  return null;\n}\n\nfunction hasSubscriptionAccess(\n  user: UserPayload, \n  requiredPlan: 'free' | 'basic' | 'premium'\n): boolean {\n  // Check if subscription is active\n  if (user.subscription_status === 'expired' || user.subscription_status === 'cancelled') {\n    return user.subscription_plan === 'free' && requiredPlan === 'free';\n  }\n\n  const planHierarchy = { free: 0, basic: 1, premium: 2 };\n  const userPlanLevel = planHierarchy[user.subscription_plan];\n  const requiredPlanLevel = planHierarchy[requiredPlan];\n\n  return userPlanLevel >= requiredPlanLevel;\n}\n\nfunction createUnauthorizedResponse(message: string) {\n  return new NextResponse(\n    JSON.stringify({ error: message, code: 'UNAUTHORIZED' }),\n    {\n      status: 401,\n      headers: {\n        'Content-Type': 'application/json',\n        'Cache-Control': 'no-cache, no-store, must-revalidate',\n      },\n    }\n  );\n}\n\nfunction createSubscriptionRequiredResponse(requiredPlan: string, pathname: string) {\n  return new NextResponse(\n    JSON.stringify({\n      error: 'Subscription upgrade required',\n      code: 'SUBSCRIPTION_REQUIRED',\n      required_plan: requiredPlan,\n      current_path: pathname,\n      upgrade_url: '/pricing',\n    }),\n    {\n      status: 403,\n      headers: {\n        'Content-Type': 'application/json',\n        'Cache-Control': 'no-cache, no-store, must-revalidate',\n      },\n    }\n  );\n}\n\n// Helper function to check feature access\nexport function checkFeatureAccess(\n  userPlan: 'free' | 'basic' | 'premium',\n  userStatus: 'active' | 'trial' | 'expired' | 'cancelled',\n  feature: keyof typeof FEATURE_ACCESS\n): boolean {\n  if (userStatus === 'expired' || userStatus === 'cancelled') {\n    return userPlan === 'free' && !FEATURE_ACCESS[feature];\n  }\n\n  const requiredPlan = FEATURE_ACCESS[feature];\n  const planHierarchy = { free: 0, basic: 1, premium: 2 };\n  const userPlanLevel = planHierarchy[userPlan];\n  const requiredPlanLevel = planHierarchy[requiredPlan];\n\n  return userPlanLevel >= requiredPlanLevel;\n}\n\nexport { PROTECTED_ROUTES, FEATURE_ACCESS };","// Simple EventEmitter replacement for Edge Runtime compatibility\r\nclass SimpleEventEmitter {\r\n  private events: Map<string, Function[]> = new Map();\r\n\r\n  on(event: string, callback: Function): void {\r\n    if (!this.events.has(event)) {\r\n      this.events.set(event, []);\r\n    }\r\n    this.events.get(event)!.push(callback);\r\n  }\r\n\r\n  emit(event: string, ...args: any[]): void {\r\n    const callbacks = this.events.get(event);\r\n    if (callbacks) {\r\n      callbacks.forEach(callback => callback(...args));\r\n    }\r\n  }\r\n\r\n  removeListener(event: string, callback: Function): void {\r\n    const callbacks = this.events.get(event);\r\n    if (callbacks) {\r\n      const index = callbacks.indexOf(callback);\r\n      if (index > -1) {\r\n        callbacks.splice(index, 1);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// Redis Client Interface for type safety\r\ninterface RedisClient {\r\n  get(key: string): Promise<string | null>;\r\n  set(key: string, value: string, options?: { EX?: number; PX?: number }): Promise<string>;\r\n  del(key: string): Promise<number>;\r\n  exists(key: string): Promise<number>;\r\n  expire(key: string, seconds: number): Promise<number>;\r\n  hget(key: string, field: string): Promise<string | null>;\r\n  hset(key: string, field: string, value: string): Promise<number>;\r\n  hgetall(key: string): Promise<Record<string, string>>;\r\n  hdel(key: string, field: string): Promise<number>;\r\n  lpush(key: string, value: string): Promise<number>;\r\n  rpush(key: string, value: string): Promise<number>;\r\n  lpop(key: string): Promise<string | null>;\r\n  rpop(key: string): Promise<string | null>;\r\n  lrange(key: string, start: number, stop: number): Promise<string[]>;\r\n  zadd(key: string, score: number, member: string): Promise<number>;\r\n  zrange(key: string, start: number, stop: number, options?: { WITHSCORES?: boolean }): Promise<string[]>;\r\n  zrevrange(key: string, start: number, stop: number, options?: { WITHSCORES?: boolean }): Promise<string[]>;\r\n  zrem(key: string, member: string): Promise<number>;\r\n  publish(channel: string, message: string): Promise<number>;\r\n  subscribe(channel: string): Promise<void>;\r\n  unsubscribe(channel: string): Promise<void>;\r\n  on(event: string, callback: Function): void;\r\n  disconnect(): Promise<void>;\r\n}\r\n\r\n// Mock Redis Client for development (when Redis is not available)\r\nclass MockRedisClient extends SimpleEventEmitter implements RedisClient {\r\n  private data: Map<string, any> = new Map();\r\n  private hashes: Map<string, Map<string, string>> = new Map();\r\n  private lists: Map<string, string[]> = new Map();\r\n  private sortedSets: Map<string, Map<string, number>> = new Map();\r\n  private subscribers: Map<string, Set<Function>> = new Map();\r\n\r\n  async get(key: string): Promise<string | null> {\r\n    return this.data.get(key) || null;\r\n  }\r\n\r\n  async set(key: string, value: string, options?: { EX?: number; PX?: number }): Promise<string> {\r\n    this.data.set(key, value);\r\n    if (options?.EX) {\r\n      setTimeout(() => this.data.delete(key), options.EX * 1000);\r\n    }\r\n    if (options?.PX) {\r\n      setTimeout(() => this.data.delete(key), options.PX);\r\n    }\r\n    return 'OK';\r\n  }\r\n\r\n  async del(key: string): Promise<number> {\r\n    const existed = this.data.has(key);\r\n    this.data.delete(key);\r\n    this.hashes.delete(key);\r\n    this.lists.delete(key);\r\n    this.sortedSets.delete(key);\r\n    return existed ? 1 : 0;\r\n  }\r\n\r\n  async exists(key: string): Promise<number> {\r\n    return this.data.has(key) ? 1 : 0;\r\n  }\r\n\r\n  async expire(key: string, seconds: number): Promise<number> {\r\n    if (this.data.has(key)) {\r\n      setTimeout(() => this.data.delete(key), seconds * 1000);\r\n      return 1;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  async hget(key: string, field: string): Promise<string | null> {\r\n    const hash = this.hashes.get(key);\r\n    return hash?.get(field) || null;\r\n  }\r\n\r\n  async hset(key: string, field: string, value: string): Promise<number> {\r\n    if (!this.hashes.has(key)) {\r\n      this.hashes.set(key, new Map());\r\n    }\r\n    const hash = this.hashes.get(key)!;\r\n    const isNew = !hash.has(field);\r\n    hash.set(field, value);\r\n    return isNew ? 1 : 0;\r\n  }\r\n\r\n  async hgetall(key: string): Promise<Record<string, string>> {\r\n    const hash = this.hashes.get(key);\r\n    if (!hash) return {};\r\n    return Object.fromEntries(hash.entries());\r\n  }\r\n\r\n  async hdel(key: string, field: string): Promise<number> {\r\n    const hash = this.hashes.get(key);\r\n    if (hash && hash.has(field)) {\r\n      hash.delete(field);\r\n      return 1;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  async lpush(key: string, value: string): Promise<number> {\r\n    if (!this.lists.has(key)) {\r\n      this.lists.set(key, []);\r\n    }\r\n    const list = this.lists.get(key)!;\r\n    list.unshift(value);\r\n    return list.length;\r\n  }\r\n\r\n  async rpush(key: string, value: string): Promise<number> {\r\n    if (!this.lists.has(key)) {\r\n      this.lists.set(key, []);\r\n    }\r\n    const list = this.lists.get(key)!;\r\n    list.push(value);\r\n    return list.length;\r\n  }\r\n\r\n  async lpop(key: string): Promise<string | null> {\r\n    const list = this.lists.get(key);\r\n    return list?.shift() || null;\r\n  }\r\n\r\n  async rpop(key: string): Promise<string | null> {\r\n    const list = this.lists.get(key);\r\n    return list?.pop() || null;\r\n  }\r\n\r\n  async lrange(key: string, start: number, stop: number): Promise<string[]> {\r\n    const list = this.lists.get(key) || [];\r\n    return list.slice(start, stop === -1 ? undefined : stop + 1);\r\n  }\r\n\r\n  async zadd(key: string, score: number, member: string): Promise<number> {\r\n    if (!this.sortedSets.has(key)) {\r\n      this.sortedSets.set(key, new Map());\r\n    }\r\n    const sortedSet = this.sortedSets.get(key)!;\r\n    const isNew = !sortedSet.has(member);\r\n    sortedSet.set(member, score);\r\n    return isNew ? 1 : 0;\r\n  }\r\n\r\n  async zrange(key: string, start: number, stop: number, options?: { WITHSCORES?: boolean }): Promise<string[]> {\r\n    const sortedSet = this.sortedSets.get(key);\r\n    if (!sortedSet) return [];\r\n    \r\n    const sorted = Array.from(sortedSet.entries()).sort((a, b) => a[1] - b[1]);\r\n    const slice = sorted.slice(start, stop === -1 ? undefined : stop + 1);\r\n    \r\n    if (options?.WITHSCORES) {\r\n      return slice.flatMap(([member, score]) => [member, score.toString()]);\r\n    }\r\n    return slice.map(([member]) => member);\r\n  }\r\n\r\n  async zrevrange(key: string, start: number, stop: number, options?: { WITHSCORES?: boolean }): Promise<string[]> {\r\n    const sortedSet = this.sortedSets.get(key);\r\n    if (!sortedSet) return [];\r\n    \r\n    const sorted = Array.from(sortedSet.entries()).sort((a, b) => b[1] - a[1]);\r\n    const slice = sorted.slice(start, stop === -1 ? undefined : stop + 1);\r\n    \r\n    if (options?.WITHSCORES) {\r\n      return slice.flatMap(([member, score]) => [member, score.toString()]);\r\n    }\r\n    return slice.map(([member]) => member);\r\n  }\r\n\r\n  async zrem(key: string, member: string): Promise<number> {\r\n    const sortedSet = this.sortedSets.get(key);\r\n    if (sortedSet && sortedSet.has(member)) {\r\n      sortedSet.delete(member);\r\n      return 1;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  async publish(channel: string, message: string): Promise<number> {\r\n    const subscribers = this.subscribers.get(channel);\r\n    if (subscribers) {\r\n      subscribers.forEach(callback => callback(message));\r\n      return subscribers.size;\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  async subscribe(channel: string): Promise<void> {\r\n    // Mock subscription - in real implementation, this would set up Redis subscription\r\n    console.log(`Subscribed to channel: ${channel}`);\r\n  }\r\n\r\n  async unsubscribe(channel: string): Promise<void> {\r\n    this.subscribers.delete(channel);\r\n    console.log(`Unsubscribed from channel: ${channel}`);\r\n  }\r\n\r\n  async disconnect(): Promise<void> {\r\n    this.data.clear();\r\n    this.hashes.clear();\r\n    this.lists.clear();\r\n    this.sortedSets.clear();\r\n    this.subscribers.clear();\r\n  }\r\n}\r\n\r\n// Cache Configuration\r\ninterface CacheConfig {\r\n  defaultTTL: number; // Time to live in seconds\r\n  maxRetries: number;\r\n  retryDelay: number;\r\n}\r\n\r\n// Redis Service Class\r\nclass RedisService extends SimpleEventEmitter {\r\n  private client: RedisClient;\r\n  private isConnected: boolean = false;\r\n  private config: CacheConfig;\r\n\r\n  constructor(config: Partial<CacheConfig> = {}) {\r\n    super();\r\n    this.config = {\r\n      defaultTTL: 3600, // 1 hour\r\n      maxRetries: 3,\r\n      retryDelay: 1000,\r\n      ...config\r\n    };\r\n\r\n    // Initialize with mock client for development\r\n    this.client = new MockRedisClient();\r\n    this.isConnected = true;\r\n    \r\n    // In production, you would initialize with actual Redis client:\r\n    // this.initializeRedisClient();\r\n  }\r\n\r\n  // Connection Management\r\n  async connect(): Promise<void> {\r\n    try {\r\n      // In production, establish actual Redis connection\r\n      this.isConnected = true;\r\n      this.emit('connected');\r\n      console.log('Redis service connected (mock mode)');\r\n    } catch (error) {\r\n      this.emit('error', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async disconnect(): Promise<void> {\r\n    if (this.client) {\r\n      await this.client.disconnect();\r\n      this.isConnected = false;\r\n      this.emit('disconnected');\r\n    }\r\n  }\r\n\r\n  // Basic Cache Operations\r\n  async get<T>(key: string): Promise<T | null> {\r\n    try {\r\n      const value = await this.client.get(key);\r\n      return value ? JSON.parse(value) : null;\r\n    } catch (error) {\r\n      console.error(`Redis GET error for key ${key}:`, error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async set<T>(key: string, value: T, ttl?: number): Promise<boolean> {\r\n    try {\r\n      const serialized = JSON.stringify(value);\r\n      const options = ttl ? { EX: ttl } : { EX: this.config.defaultTTL };\r\n      await this.client.set(key, serialized, options);\r\n      return true;\r\n    } catch (error) {\r\n      console.error(`Redis SET error for key ${key}:`, error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async del(key: string): Promise<boolean> {\r\n    try {\r\n      const result = await this.client.del(key);\r\n      return result > 0;\r\n    } catch (error) {\r\n      console.error(`Redis DEL error for key ${key}:`, error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async exists(key: string): Promise<boolean> {\r\n    try {\r\n      const result = await this.client.exists(key);\r\n      return result > 0;\r\n    } catch (error) {\r\n      console.error(`Redis EXISTS error for key ${key}:`, error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  // Hash Operations (for user sessions, settings)\r\n  async hget<T>(key: string, field: string): Promise<T | null> {\r\n    try {\r\n      const value = await this.client.hget(key, field);\r\n      return value ? JSON.parse(value) : null;\r\n    } catch (error) {\r\n      console.error(`Redis HGET error for key ${key}, field ${field}:`, error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async hset<T>(key: string, field: string, value: T): Promise<boolean> {\r\n    try {\r\n      const serialized = JSON.stringify(value);\r\n      await this.client.hset(key, field, serialized);\r\n      return true;\r\n    } catch (error) {\r\n      console.error(`Redis HSET error for key ${key}, field ${field}:`, error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async hgetall<T>(key: string): Promise<Record<string, T>> {\r\n    try {\r\n      const hash = await this.client.hgetall(key);\r\n      const result: Record<string, T> = {};\r\n      for (const [field, value] of Object.entries(hash)) {\r\n        try {\r\n          result[field] = JSON.parse(value);\r\n        } catch {\r\n          result[field] = value as T;\r\n        }\r\n      }\r\n      return result;\r\n    } catch (error) {\r\n      console.error(`Redis HGETALL error for key ${key}:`, error);\r\n      return {};\r\n    }\r\n  }\r\n\r\n  async hdel(key: string, field: string): Promise<number> {\r\n    try {\r\n      return await this.client.hdel(key, field);\r\n    } catch (error) {\r\n      console.error(`Redis HDEL error for key ${key}, field ${field}:`, error);\r\n      return 0;\r\n    }\r\n  }\r\n\r\n  // List Operations (for queues, recent items)\r\n  async lpush<T>(key: string, value: T): Promise<number> {\r\n    try {\r\n      const serialized = JSON.stringify(value);\r\n      return await this.client.lpush(key, serialized);\r\n    } catch (error) {\r\n      console.error(`Redis LPUSH error for key ${key}:`, error);\r\n      return 0;\r\n    }\r\n  }\r\n\r\n  async rpop<T>(key: string): Promise<T | null> {\r\n    try {\r\n      const value = await this.client.rpop(key);\r\n      return value ? JSON.parse(value) : null;\r\n    } catch (error) {\r\n      console.error(`Redis RPOP error for key ${key}:`, error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async lrange<T>(key: string, start: number = 0, stop: number = -1): Promise<T[]> {\r\n    try {\r\n      const values = await this.client.lrange(key, start, stop);\r\n      return values.map(value => {\r\n        try {\r\n          return JSON.parse(value);\r\n        } catch {\r\n          return value as T;\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.error(`Redis LRANGE error for key ${key}:`, error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Sorted Set Operations (for leaderboards, rankings)\r\n  async zadd(key: string, score: number, member: string): Promise<boolean> {\r\n    try {\r\n      const result = await this.client.zadd(key, score, member);\r\n      return result > 0;\r\n    } catch (error) {\r\n      console.error(`Redis ZADD error for key ${key}:`, error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  async zrevrange(key: string, start: number = 0, stop: number = -1, withScores: boolean = false): Promise<string[]> {\r\n    try {\r\n      return await this.client.zrevrange(key, start, stop, { WITHSCORES: withScores });\r\n    } catch (error) {\r\n      console.error(`Redis ZREVRANGE error for key ${key}:`, error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Pub/Sub Operations\r\n  async publish(channel: string, message: any): Promise<number> {\r\n    try {\r\n      const serialized = typeof message === 'string' ? message : JSON.stringify(message);\r\n      return await this.client.publish(channel, serialized);\r\n    } catch (error) {\r\n      console.error(`Redis PUBLISH error for channel ${channel}:`, error);\r\n      return 0;\r\n    }\r\n  }\r\n\r\n  async subscribe(channel: string, callback: (message: any) => void): Promise<void> {\r\n    try {\r\n      await this.client.subscribe(channel);\r\n      this.client.on('message', (receivedChannel: string, message: string) => {\r\n        if (receivedChannel === channel) {\r\n          try {\r\n            const parsed = JSON.parse(message);\r\n            callback(parsed);\r\n          } catch {\r\n            callback(message);\r\n          }\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.error(`Redis SUBSCRIBE error for channel ${channel}:`, error);\r\n    }\r\n  }\r\n\r\n  // High-level Cache Methods\r\n  async cacheMarketData(symbol: string, data: any, ttl: number = 60): Promise<void> {\r\n    await this.set(`market:${symbol}`, data, ttl);\r\n  }\r\n\r\n  async getMarketData(symbol: string): Promise<any> {\r\n    return await this.get(`market:${symbol}`);\r\n  }\r\n\r\n  async cacheNews(newsId: string, article: any, ttl: number = 1800): Promise<void> {\r\n    await this.set(`news:${newsId}`, article, ttl);\r\n  }\r\n\r\n  async getNews(newsId: string): Promise<any> {\r\n    return await this.get(`news:${newsId}`);\r\n  }\r\n\r\n  async cacheUserSession(userId: string, sessionData: any, ttl: number = 86400): Promise<void> {\r\n    await this.hset(`session:${userId}`, 'data', sessionData);\r\n    await this.client.expire(`session:${userId}`, ttl);\r\n  }\r\n\r\n  async getUserSession(userId: string): Promise<any> {\r\n    return await this.hget(`session:${userId}`, 'data');\r\n  }\r\n\r\n  // Trading Queue Operations\r\n  async addTradeOrder(order: any): Promise<void> {\r\n    await this.lpush('trade:orders', order);\r\n  }\r\n\r\n  async getNextTradeOrder(): Promise<any> {\r\n    return await this.rpop('trade:orders');\r\n  }\r\n\r\n  // Enhanced Leaderboard Operations with multiple categories\r\n  async updateLeaderboard(userId: string, score: number, category: string = 'trading'): Promise<void> {\r\n    await this.zadd(`leaderboard:${category}`, score, userId);\r\n  }\r\n\r\n  async getLeaderboard(category: string = 'trading', limit: number = 10): Promise<string[]> {\r\n    return await this.zrevrange(`leaderboard:${category}`, 0, limit - 1, true);\r\n  }\r\n\r\n  // Trading Performance Leaderboards\r\n  async updateTradingPerformance(userId: string, metrics: {\r\n    totalReturn: number;\r\n    winRate: number;\r\n    sharpeRatio: number;\r\n    totalTrades: number;\r\n    followers: number;\r\n    aum: number;\r\n  }): Promise<void> {\r\n    const timestamp = Date.now();\r\n    \r\n    // Update multiple leaderboards\r\n    await Promise.all([\r\n      this.zadd('leaderboard:return', metrics.totalReturn, userId),\r\n      this.zadd('leaderboard:winrate', metrics.winRate, userId),\r\n      this.zadd('leaderboard:sharpe', metrics.sharpeRatio, userId),\r\n      this.zadd('leaderboard:trades', metrics.totalTrades, userId),\r\n      this.zadd('leaderboard:followers', metrics.followers, userId),\r\n      this.zadd('leaderboard:aum', metrics.aum, userId),\r\n      \r\n      // Store user metrics with timestamp\r\n      this.hset(`user:${userId}:metrics`, {\r\n        totalReturn: metrics.totalReturn.toString(),\r\n        winRate: metrics.winRate.toString(),\r\n        sharpeRatio: metrics.sharpeRatio.toString(),\r\n        totalTrades: metrics.totalTrades.toString(),\r\n        followers: metrics.followers.toString(),\r\n        aum: metrics.aum.toString(),\r\n        lastUpdated: timestamp.toString()\r\n      })\r\n    ]);\r\n  }\r\n\r\n  async getTopTraders(category: string = 'return', limit: number = 10): Promise<Array<{\r\n    userId: string;\r\n    score: number;\r\n    rank: number;\r\n    metrics?: any;\r\n  }>> {\r\n    try {\r\n      const results = await this.zrevrange(`leaderboard:${category}`, 0, limit - 1, true);\r\n      const traders = [];\r\n      \r\n      for (let i = 0; i < results.length; i += 2) {\r\n        const userId = results[i];\r\n        const score = parseFloat(results[i + 1]);\r\n        \r\n        // Get additional metrics for the user\r\n        const metrics = await this.hgetall(`user:${userId}:metrics`);\r\n        \r\n        traders.push({\r\n          userId,\r\n          score,\r\n          rank: Math.floor(i / 2) + 1,\r\n          metrics: metrics ? {\r\n            totalReturn: parseFloat(metrics.totalReturn || '0'),\r\n            winRate: parseFloat(metrics.winRate || '0'),\r\n            sharpeRatio: parseFloat(metrics.sharpeRatio || '0'),\r\n            totalTrades: parseInt(metrics.totalTrades || '0'),\r\n            followers: parseInt(metrics.followers || '0'),\r\n            aum: parseFloat(metrics.aum || '0'),\r\n            lastUpdated: parseInt(metrics.lastUpdated || '0')\r\n          } : null\r\n        });\r\n      }\r\n      \r\n      return traders;\r\n    } catch (error) {\r\n      console.error('Error getting top traders:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  async getUserRank(userId: string, category: string = 'return'): Promise<number | null> {\r\n    try {\r\n      const rank = await this.client.zrevrank(`leaderboard:${category}`, userId);\r\n      return rank !== null ? rank + 1 : null;\r\n    } catch (error) {\r\n      console.error('Error getting user rank:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Period-based leaderboards (daily, weekly, monthly)\r\n  async updatePeriodLeaderboard(userId: string, score: number, category: string, period: 'daily' | 'weekly' | 'monthly'): Promise<void> {\r\n    const now = new Date();\r\n    let periodKey = '';\r\n    \r\n    switch (period) {\r\n      case 'daily':\r\n        periodKey = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`;\r\n        break;\r\n      case 'weekly':\r\n        const weekStart = new Date(now.setDate(now.getDate() - now.getDay()));\r\n        periodKey = `${weekStart.getFullYear()}-W${Math.ceil(weekStart.getDate() / 7)}`;\r\n        break;\r\n      case 'monthly':\r\n        periodKey = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;\r\n        break;\r\n    }\r\n    \r\n    await this.zadd(`leaderboard:${category}:${period}:${periodKey}`, score, userId);\r\n    \r\n    // Set expiration for period-based leaderboards\r\n    const expiration = period === 'daily' ? 86400 * 7 : // Keep daily for 7 days\r\n                      period === 'weekly' ? 86400 * 30 : // Keep weekly for 30 days\r\n                      86400 * 365; // Keep monthly for 1 year\r\n    \r\n    await this.client.expire(`leaderboard:${category}:${period}:${periodKey}`, expiration);\r\n  }\r\n\r\n  async getPeriodLeaderboard(category: string, period: 'daily' | 'weekly' | 'monthly', limit: number = 10): Promise<Array<{\r\n    userId: string;\r\n    score: number;\r\n    rank: number;\r\n  }>> {\r\n    const now = new Date();\r\n    let periodKey = '';\r\n    \r\n    switch (period) {\r\n      case 'daily':\r\n        periodKey = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}`;\r\n        break;\r\n      case 'weekly':\r\n        const weekStart = new Date(now.setDate(now.getDate() - now.getDay()));\r\n        periodKey = `${weekStart.getFullYear()}-W${Math.ceil(weekStart.getDate() / 7)}`;\r\n        break;\r\n      case 'monthly':\r\n        periodKey = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;\r\n        break;\r\n    }\r\n    \r\n    try {\r\n      const results = await this.zrevrange(`leaderboard:${category}:${period}:${periodKey}`, 0, limit - 1, true);\r\n      const traders = [];\r\n      \r\n      for (let i = 0; i < results.length; i += 2) {\r\n        const userId = results[i];\r\n        const score = parseFloat(results[i + 1]);\r\n        \r\n        traders.push({\r\n          userId,\r\n          score,\r\n          rank: Math.floor(i / 2) + 1\r\n        });\r\n      }\r\n      \r\n      return traders;\r\n    } catch (error) {\r\n      console.error('Error getting period leaderboard:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  // Health Check\r\n  // Paper Trading specific methods\r\n  async addPaperTradingOrder(order: any): Promise<void> {\r\n    try {\r\n      await this.lpush('paper_trading_orders', order);\r\n    } catch (error) {\r\n      console.error('Error adding paper trading order:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async getNextPaperTradingOrder(): Promise<any> {\r\n    try {\r\n      return await this.rpop('paper_trading_orders');\r\n    } catch (error) {\r\n      console.error('Error getting next paper trading order:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async subscribeToOrderUpdates(callback: (message: any) => void): Promise<void> {\r\n    try {\r\n      await this.subscribe('order_updates', callback);\r\n    } catch (error) {\r\n      console.error('Error subscribing to order updates:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async publishOrderUpdate(orderUpdate: any): Promise<void> {\r\n    try {\r\n      await this.publish('order_updates', orderUpdate);\r\n    } catch (error) {\r\n      console.error('Error publishing order update:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async cacheQueueStats(stats: { pending: number; processing: number; completed: number }): Promise<void> {\r\n    try {\r\n      await this.hset('queue_stats', 'pending', stats.pending.toString());\r\n      await this.hset('queue_stats', 'processing', stats.processing.toString());\r\n      await this.hset('queue_stats', 'completed', stats.completed.toString());\r\n    } catch (error) {\r\n      console.error('Error caching queue stats:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async getQueueStats(): Promise<{ pending: number; processing: number; completed: number }> {\r\n    try {\r\n      const stats = await this.hgetall('queue_stats');\r\n      return {\r\n        pending: parseInt(stats.pending || '0'),\r\n        processing: parseInt(stats.processing || '0'),\r\n        completed: parseInt(stats.completed || '0')\r\n      };\r\n    } catch (error) {\r\n      console.error('Error getting queue stats:', error);\r\n      return { pending: 0, processing: 0, completed: 0 };\r\n    }\r\n  }\r\n\r\n  isHealthy(): boolean {\r\n    return this.isConnected;\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const redisService = new RedisService();\r\nexport default redisService;","import { redisService } from './RedisService';\n\nexport interface UserSession {\n  userId: string;\n  username: string;\n  email: string;\n  role: string;\n  permissions: string[];\n  loginTime: number;\n  lastActivity: number;\n  ipAddress: string;\n  userAgent: string;\n  deviceId?: string;\n}\n\nexport interface SessionOptions {\n  maxAge?: number; // Session duration in seconds (default: 24 hours)\n  maxConcurrentSessions?: number; // Max concurrent sessions per user\n  extendOnActivity?: boolean; // Extend session on activity\n  trackActivity?: boolean; // Track user activity\n}\n\nclass SessionService {\n  private readonly SESSION_PREFIX = 'session:';\n  private readonly USER_SESSIONS_PREFIX = 'user_sessions:';\n  private readonly ACTIVE_SESSIONS_PREFIX = 'active_sessions';\n  private readonly SESSION_ACTIVITY_PREFIX = 'session_activity:';\n  \n  private readonly defaultOptions: Required<SessionOptions> = {\n    maxAge: 24 * 60 * 60, // 24 hours\n    maxConcurrentSessions: 5,\n    extendOnActivity: true,\n    trackActivity: true\n  };\n\n  /**\n   * Create a new user session\n   */\n  async createSession(\n    sessionId: string,\n    userSession: UserSession,\n    options: SessionOptions = {}\n  ): Promise<void> {\n    const opts = { ...this.defaultOptions, ...options };\n    const sessionKey = `${this.SESSION_PREFIX}${sessionId}`;\n    const userSessionsKey = `${this.USER_SESSIONS_PREFIX}${userSession.userId}`;\n\n    try {\n      // Store session data\n      await redisService.setHash(sessionKey, {\n        userId: userSession.userId,\n        username: userSession.username,\n        email: userSession.email,\n        role: userSession.role,\n        permissions: JSON.stringify(userSession.permissions),\n        loginTime: userSession.loginTime.toString(),\n        lastActivity: userSession.lastActivity.toString(),\n        ipAddress: userSession.ipAddress,\n        userAgent: userSession.userAgent,\n        deviceId: userSession.deviceId || ''\n      });\n\n      // Set session expiration\n      await redisService.expire(sessionKey, opts.maxAge);\n\n      // Track user sessions\n      await redisService.addToSortedSet(userSessionsKey, sessionId, Date.now());\n      await redisService.expire(userSessionsKey, opts.maxAge);\n\n      // Add to active sessions\n      await redisService.addToSortedSet(this.ACTIVE_SESSIONS_PREFIX, sessionId, Date.now());\n\n      // Enforce concurrent session limit\n      if (opts.maxConcurrentSessions > 0) {\n        await this.enforceConcurrentSessionLimit(userSession.userId, opts.maxConcurrentSessions);\n      }\n\n      // Track session creation activity\n      if (opts.trackActivity) {\n        await this.trackActivity(sessionId, 'session_created', {\n          ipAddress: userSession.ipAddress,\n          userAgent: userSession.userAgent\n        });\n      }\n    } catch (error) {\n      console.error('Error creating session:', error);\n      throw new Error('Failed to create session');\n    }\n  }\n\n  /**\n   * Get session data\n   */\n  async getSession(sessionId: string): Promise<UserSession | null> {\n    try {\n      const sessionKey = `${this.SESSION_PREFIX}${sessionId}`;\n      const sessionData = await redisService.getHash(sessionKey);\n\n      if (!sessionData || Object.keys(sessionData).length === 0) {\n        return null;\n      }\n\n      return {\n        userId: sessionData.userId,\n        username: sessionData.username,\n        email: sessionData.email,\n        role: sessionData.role,\n        permissions: JSON.parse(sessionData.permissions || '[]'),\n        loginTime: parseInt(sessionData.loginTime),\n        lastActivity: parseInt(sessionData.lastActivity),\n        ipAddress: sessionData.ipAddress,\n        userAgent: sessionData.userAgent,\n        deviceId: sessionData.deviceId || undefined\n      };\n    } catch (error) {\n      console.error('Error getting session:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Update session activity\n   */\n  async updateActivity(sessionId: string, options: SessionOptions = {}): Promise<boolean> {\n    try {\n      const opts = { ...this.defaultOptions, ...options };\n      const sessionKey = `${this.SESSION_PREFIX}${sessionId}`;\n      \n      // Check if session exists\n      const exists = await redisService.exists(sessionKey);\n      if (!exists) {\n        return false;\n      }\n\n      const now = Date.now();\n\n      // Update last activity\n      await redisService.setHashField(sessionKey, 'lastActivity', now.toString());\n\n      // Extend session if configured\n      if (opts.extendOnActivity) {\n        await redisService.expire(sessionKey, opts.maxAge);\n      }\n\n      // Track activity\n      if (opts.trackActivity) {\n        await this.trackActivity(sessionId, 'activity_update');\n      }\n\n      return true;\n    } catch (error) {\n      console.error('Error updating session activity:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Destroy a session\n   */\n  async destroySession(sessionId: string): Promise<boolean> {\n    try {\n      const sessionKey = `${this.SESSION_PREFIX}${sessionId}`;\n      \n      // Get session data before deletion\n      const session = await this.getSession(sessionId);\n      if (!session) {\n        return false;\n      }\n\n      // Remove session data\n      await redisService.delete(sessionKey);\n\n      // Remove from user sessions\n      const userSessionsKey = `${this.USER_SESSIONS_PREFIX}${session.userId}`;\n      await redisService.removeFromSortedSet(userSessionsKey, sessionId);\n\n      // Remove from active sessions\n      await redisService.removeFromSortedSet(this.ACTIVE_SESSIONS_PREFIX, sessionId);\n\n      // Track session destruction\n      await this.trackActivity(sessionId, 'session_destroyed');\n\n      return true;\n    } catch (error) {\n      console.error('Error destroying session:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get all active sessions for a user\n   */\n  async getUserSessions(userId: string): Promise<string[]> {\n    try {\n      const userSessionsKey = `${this.USER_SESSIONS_PREFIX}${userId}`;\n      const sessions = await redisService.getSortedSetRange(userSessionsKey, 0, -1);\n      \n      // Filter out expired sessions\n      const activeSessions: string[] = [];\n      for (const sessionId of sessions) {\n        const sessionKey = `${this.SESSION_PREFIX}${sessionId}`;\n        const exists = await redisService.exists(sessionKey);\n        if (exists) {\n          activeSessions.push(sessionId);\n        } else {\n          // Clean up expired session from user sessions\n          await redisService.removeFromSortedSet(userSessionsKey, sessionId);\n        }\n      }\n\n      return activeSessions;\n    } catch (error) {\n      console.error('Error getting user sessions:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Destroy all sessions for a user\n   */\n  async destroyUserSessions(userId: string, excludeSessionId?: string): Promise<number> {\n    try {\n      const sessions = await this.getUserSessions(userId);\n      let destroyedCount = 0;\n\n      for (const sessionId of sessions) {\n        if (excludeSessionId && sessionId === excludeSessionId) {\n          continue;\n        }\n\n        const success = await this.destroySession(sessionId);\n        if (success) {\n          destroyedCount++;\n        }\n      }\n\n      return destroyedCount;\n    } catch (error) {\n      console.error('Error destroying user sessions:', error);\n      return 0;\n    }\n  }\n\n  /**\n   * Get session statistics\n   */\n  async getSessionStats(): Promise<{\n    totalActiveSessions: number;\n    sessionsLast24h: number;\n    sessionsLastHour: number;\n  }> {\n    try {\n      const now = Date.now();\n      const last24h = now - (24 * 60 * 60 * 1000);\n      const lastHour = now - (60 * 60 * 1000);\n\n      const totalActiveSessions = await redisService.getSortedSetCount(this.ACTIVE_SESSIONS_PREFIX);\n      const sessionsLast24h = await redisService.getSortedSetCountByScore(\n        this.ACTIVE_SESSIONS_PREFIX,\n        last24h,\n        now\n      );\n      const sessionsLastHour = await redisService.getSortedSetCountByScore(\n        this.ACTIVE_SESSIONS_PREFIX,\n        lastHour,\n        now\n      );\n\n      return {\n        totalActiveSessions,\n        sessionsLast24h,\n        sessionsLastHour\n      };\n    } catch (error) {\n      console.error('Error getting session stats:', error);\n      return {\n        totalActiveSessions: 0,\n        sessionsLast24h: 0,\n        sessionsLastHour: 0\n      };\n    }\n  }\n\n  /**\n   * Clean up expired sessions\n   */\n  async cleanupExpiredSessions(): Promise<number> {\n    try {\n      const now = Date.now();\n      const expiredThreshold = now - (this.defaultOptions.maxAge * 1000);\n      \n      // Get potentially expired sessions\n      const expiredSessions = await redisService.getSortedSetRangeByScore(\n        this.ACTIVE_SESSIONS_PREFIX,\n        0,\n        expiredThreshold\n      );\n\n      let cleanedCount = 0;\n      for (const sessionId of expiredSessions) {\n        const sessionKey = `${this.SESSION_PREFIX}${sessionId}`;\n        const exists = await redisService.exists(sessionKey);\n        \n        if (!exists) {\n          // Remove from active sessions\n          await redisService.removeFromSortedSet(this.ACTIVE_SESSIONS_PREFIX, sessionId);\n          cleanedCount++;\n        }\n      }\n\n      return cleanedCount;\n    } catch (error) {\n      console.error('Error cleaning up expired sessions:', error);\n      return 0;\n    }\n  }\n\n  /**\n   * Enforce concurrent session limit for a user\n   */\n  private async enforceConcurrentSessionLimit(userId: string, maxSessions: number): Promise<void> {\n    try {\n      const sessions = await this.getUserSessions(userId);\n      \n      if (sessions.length > maxSessions) {\n        // Sort sessions by last activity (oldest first)\n        const sessionDetails = await Promise.all(\n          sessions.map(async (sessionId) => {\n            const session = await this.getSession(sessionId);\n            return { sessionId, lastActivity: session?.lastActivity || 0 };\n          })\n        );\n\n        sessionDetails.sort((a, b) => a.lastActivity - b.lastActivity);\n\n        // Remove oldest sessions\n        const sessionsToRemove = sessionDetails.slice(0, sessions.length - maxSessions);\n        for (const { sessionId } of sessionsToRemove) {\n          await this.destroySession(sessionId);\n        }\n      }\n    } catch (error) {\n      console.error('Error enforcing concurrent session limit:', error);\n    }\n  }\n\n  /**\n   * Track session activity\n   */\n  private async trackActivity(\n    sessionId: string,\n    activityType: string,\n    metadata: Record<string, any> = {}\n  ): Promise<void> {\n    try {\n      const activityKey = `${this.SESSION_ACTIVITY_PREFIX}${sessionId}`;\n      const activity = {\n        type: activityType,\n        timestamp: Date.now(),\n        ...metadata\n      };\n\n      await redisService.addToList(activityKey, JSON.stringify(activity));\n      \n      // Keep only last 100 activities per session\n      await redisService.trimList(activityKey, 0, 99);\n      \n      // Set expiration for activity log\n      await redisService.expire(activityKey, this.defaultOptions.maxAge);\n    } catch (error) {\n      console.error('Error tracking session activity:', error);\n    }\n  }\n\n  /**\n   * Get session activity log\n   */\n  async getSessionActivity(sessionId: string): Promise<any[]> {\n    try {\n      const activityKey = `${this.SESSION_ACTIVITY_PREFIX}${sessionId}`;\n      const activities = await redisService.getListRange(activityKey, 0, -1);\n      \n      return activities.map(activity => {\n        try {\n          return JSON.parse(activity);\n        } catch {\n          return { type: 'unknown', timestamp: 0 };\n        }\n      });\n    } catch (error) {\n      console.error('Error getting session activity:', error);\n      return [];\n    }\n  }\n}\n\nexport const sessionService = new SessionService();","import { NextResponse } from 'next/server';\nimport type { NextRequest } from 'next/server';\nimport { subscriptionMiddleware } from './middleware/subscription';\nimport { sessionService } from './services/SessionService';\n\n// Define protected routes that require authentication\nconst protectedRoutes = [\n  '/dashboard',\n  '/portfolio',\n  '/trading',\n  '/analytics',\n  '/settings',\n  '/profile'\n];\n\n// Define routes that require authentication but not subscription checks\nconst freeProtectedRoutes = [\n  '/dashboard',\n  '/portfolio',\n  '/settings',\n  '/profile'\n];\n\n// Define public routes that don't require authentication\nconst publicRoutes = [\n  '/',\n  '/landing',\n  '/pricing',\n  '/demo',\n  '/contact',\n  '/about',\n  '/features',\n  '/blog',\n  '/careers',\n  '/help-center',\n  '/documentation',\n  '/security',\n  '/status',\n  '/tutorial',\n  '/auth/login',\n  '/auth/register',\n  '/auth/forgot-password',\n  '/auth/reset-password',\n  '/auth/verify-email',\n  '/legal/terms',\n  '/legal/privacy',\n  '/support',\n  '/api/auth/captcha',\n  '/api/auth/register',\n  '/api/auth/login',\n  '/api/auth/password-reset',\n  '/api/auth/verify-email',\n  '/api/auth/reset-password-confirm'\n];\n\n// Define auth routes that authenticated users shouldn't access\nconst authRoutes = [\n  '/auth/login',\n  '/auth/register',\n  '/auth/forgot-password'\n];\n\nexport async function middleware(request: NextRequest) {\n  const pathname = request.nextUrl.pathname;\n  const fullUrl = request.url;\n  \n  // Immediately bypass for RSC requests, static files, and API routes\n  const url = new URL(request.url);\n  const hasRscParam = url.searchParams.has('_rsc') || fullUrl.includes('_rsc=');\n  \n  if (hasRscParam || \n      fullUrl.includes('_next=') ||\n      pathname.startsWith('/_next/') ||\n      pathname.startsWith('/api/') ||\n      pathname.startsWith('/static/') ||\n      pathname.startsWith('/_vercel/') ||\n      pathname.includes('.') || // files with extensions\n      request.headers.get('RSC') === '1' ||\n      request.headers.get('Next-Router-Prefetch') === '1' ||\n      request.headers.get('accept')?.includes('text/x-component') ||\n      request.headers.get('accept')?.includes('application/rsc') ||\n      request.headers.get('next-router-state-tree') ||\n      request.headers.get('next-url') ||\n      request.headers.get('x-middleware-prefetch') ||\n      request.headers.get('x-middleware-invoke') ||\n      request.method === 'HEAD'\n  ) {\n    return NextResponse.next();\n  }\n  \n  const token = request.cookies.get('access_token')?.value;\n  const sessionId = request.cookies.get('session_id')?.value;\n  \n  // Validate token and session if they exist\n  let isValidToken = false;\n  let sessionData = null;\n  \n  if (token && sessionId) {\n    try {\n      // Validate JWT token\n      const { jwtVerify } = await import('jose');\n      const secret = new TextEncoder().encode(process.env.JWT_SECRET || 'your-secret-key-here-change-in-production');\n      const { payload } = await jwtVerify(token, secret);\n      \n      // Validate Redis session\n      sessionData = await sessionService.getSession(sessionId);\n      \n      if (sessionData && sessionData.userId === payload.sub) {\n        isValidToken = true;\n        \n        // Update session activity for protected routes\n        if (protectedRoutes.some(route => pathname.startsWith(route))) {\n          await sessionService.updateActivity(sessionId);\n        }\n      }\n    } catch (error) {\n      // Token or session is invalid, clear them\n      isValidToken = false;\n      sessionData = null;\n    }\n  }\n  \n  // Handle root path\n  if (pathname === '/') {\n    if (isValidToken) {\n      return NextResponse.redirect(new URL('/dashboard', request.url));\n    } else {\n      return NextResponse.redirect(new URL('/landing', request.url));\n    }\n  }\n\n  // Check if the route is protected\n  const isProtectedRoute = protectedRoutes.some(route => \n    pathname.startsWith(route)\n  );\n  \n  // Check if the route is an auth route\n  const isAuthRoute = authRoutes.some(route => \n    pathname.startsWith(route)\n  );\n\n  // Check if the route is public\n  const isPublicRoute = publicRoutes.some(route => \n    pathname.startsWith(route)\n  );\n\n  // If user is authenticated and trying to access auth routes, redirect to dashboard\n  if (isValidToken && isAuthRoute) {\n    const redirectResponse = NextResponse.redirect(new URL('/dashboard', request.url));\n    // Add headers to ensure clean redirect\n    redirectResponse.headers.set('Cache-Control', 'no-cache, no-store, must-revalidate');\n    redirectResponse.headers.set('Pragma', 'no-cache');\n    redirectResponse.headers.set('Expires', '0');\n    return redirectResponse;\n  }\n\n  // If user is not authenticated and trying to access protected routes, redirect to login\n  if (!isValidToken && isProtectedRoute) {\n    const loginUrl = new URL('/auth/login', request.url);\n    loginUrl.searchParams.set('redirect', pathname);\n    return NextResponse.redirect(loginUrl);\n  }\n\n  // For email verification and password reset, allow access regardless of auth status\n  if (pathname.startsWith('/auth/verify-email') || pathname.startsWith('/auth/reset-password')) {\n    return NextResponse.next();\n  }\n\n  // If route is not explicitly public or protected, and user is not authenticated,\n  // redirect to landing page\n  if (!isValidToken && !isPublicRoute && !isProtectedRoute) {\n    return NextResponse.redirect(new URL('/landing', request.url));\n  }\n\n  // Check if route is free (requires auth but no subscription)\n  const isFreeProtectedRoute = freeProtectedRoutes.some(route => \n    pathname.startsWith(route)\n  );\n\n  // If user is authenticated and accessing protected routes, check subscription access\n  // Only apply subscription middleware to routes that require paid subscriptions\n  if (isValidToken && isProtectedRoute && !isPublicRoute && !isFreeProtectedRoute) {\n    const subscriptionResponse = await subscriptionMiddleware(request);\n    \n    // If subscription middleware returns a response (error), handle it\n    if (subscriptionResponse.status === 403) {\n      // Subscription upgrade required - redirect to pricing with context\n      const pricingUrl = new URL('/pricing', request.url);\n      pricingUrl.searchParams.set('upgrade', 'true');\n      pricingUrl.searchParams.set('feature', pathname);\n      return NextResponse.redirect(pricingUrl);\n    } else if (subscriptionResponse.status === 401) {\n      // Invalid token - redirect to login\n      const loginUrl = new URL('/auth/login', request.url);\n      loginUrl.searchParams.set('redirect', pathname);\n      return NextResponse.redirect(loginUrl);\n    }\n    \n    // If subscription check passed, return the response with headers\n    if (subscriptionResponse.status === 200) {\n      return subscriptionResponse;\n    }\n  }\n\n  // Add headers to prevent caching of auth-related pages\n  const response = NextResponse.next();\n  if (pathname.startsWith('/auth/')) {\n    response.headers.set('Cache-Control', 'no-cache, no-store, must-revalidate');\n    response.headers.set('Pragma', 'no-cache');\n    response.headers.set('Expires', '0');\n  }\n\n  return response;\n}\n\n// Configure which routes the middleware should run on\nexport const config = {\n  matcher: [\n    /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     * - public folder files\n     */\n    '/((?!api|_next/static|_next/image|favicon.ico|public).*)',\n  ],\n};","import \"next/dist/server/web/globals\";\nimport { adapter } from \"next/dist/server/web/adapter\";\n// Import the userland code.\nimport * as _mod from \"private-next-root-dir/src/middleware.ts\";\nconst mod = {\n    ..._mod\n};\nconst handler = mod.middleware || mod.default;\nconst page = \"/src/middleware\";\nif (typeof handler !== \"function\") {\n    throw new Error(`The Middleware \"${page}\" must export a \\`middleware\\` or a \\`default\\` function`);\n}\nexport default function nHandler(opts) {\n    return adapter({\n        ...opts,\n        page,\n        handler\n    });\n}\n\n//# sourceMappingURL=middleware.js.map","\"use strict\";\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toCommonJS = (mod) => __copyProps(__defProp({}, \"__esModule\", { value: true }), mod);\n\n// src/index.ts\nvar src_exports = {};\n__export(src_exports, {\n  RequestCookies: () => RequestCookies,\n  ResponseCookies: () => ResponseCookies,\n  parseCookie: () => parseCookie,\n  parseSetCookie: () => parseSetCookie,\n  stringifyCookie: () => stringifyCookie\n});\nmodule.exports = __toCommonJS(src_exports);\n\n// src/serialize.ts\nfunction stringifyCookie(c) {\n  var _a;\n  const attrs = [\n    \"path\" in c && c.path && `Path=${c.path}`,\n    \"expires\" in c && (c.expires || c.expires === 0) && `Expires=${(typeof c.expires === \"number\" ? new Date(c.expires) : c.expires).toUTCString()}`,\n    \"maxAge\" in c && typeof c.maxAge === \"number\" && `Max-Age=${c.maxAge}`,\n    \"domain\" in c && c.domain && `Domain=${c.domain}`,\n    \"secure\" in c && c.secure && \"Secure\",\n    \"httpOnly\" in c && c.httpOnly && \"HttpOnly\",\n    \"sameSite\" in c && c.sameSite && `SameSite=${c.sameSite}`,\n    \"priority\" in c && c.priority && `Priority=${c.priority}`\n  ].filter(Boolean);\n  return `${c.name}=${encodeURIComponent((_a = c.value) != null ? _a : \"\")}; ${attrs.join(\"; \")}`;\n}\nfunction parseCookie(cookie) {\n  const map = /* @__PURE__ */ new Map();\n  for (const pair of cookie.split(/; */)) {\n    if (!pair)\n      continue;\n    const splitAt = pair.indexOf(\"=\");\n    if (splitAt === -1) {\n      map.set(pair, \"true\");\n      continue;\n    }\n    const [key, value] = [pair.slice(0, splitAt), pair.slice(splitAt + 1)];\n    try {\n      map.set(key, decodeURIComponent(value != null ? value : \"true\"));\n    } catch {\n    }\n  }\n  return map;\n}\nfunction parseSetCookie(setCookie) {\n  if (!setCookie) {\n    return void 0;\n  }\n  const [[name, value], ...attributes] = parseCookie(setCookie);\n  const {\n    domain,\n    expires,\n    httponly,\n    maxage,\n    path,\n    samesite,\n    secure,\n    priority\n  } = Object.fromEntries(\n    attributes.map(([key, value2]) => [key.toLowerCase(), value2])\n  );\n  const cookie = {\n    name,\n    value: decodeURIComponent(value),\n    domain,\n    ...expires && { expires: new Date(expires) },\n    ...httponly && { httpOnly: true },\n    ...typeof maxage === \"string\" && { maxAge: Number(maxage) },\n    path,\n    ...samesite && { sameSite: parseSameSite(samesite) },\n    ...secure && { secure: true },\n    ...priority && { priority: parsePriority(priority) }\n  };\n  return compact(cookie);\n}\nfunction compact(t) {\n  const newT = {};\n  for (const key in t) {\n    if (t[key]) {\n      newT[key] = t[key];\n    }\n  }\n  return newT;\n}\nvar SAME_SITE = [\"strict\", \"lax\", \"none\"];\nfunction parseSameSite(string) {\n  string = string.toLowerCase();\n  return SAME_SITE.includes(string) ? string : void 0;\n}\nvar PRIORITY = [\"low\", \"medium\", \"high\"];\nfunction parsePriority(string) {\n  string = string.toLowerCase();\n  return PRIORITY.includes(string) ? string : void 0;\n}\nfunction splitCookiesString(cookiesString) {\n  if (!cookiesString)\n    return [];\n  var cookiesStrings = [];\n  var pos = 0;\n  var start;\n  var ch;\n  var lastComma;\n  var nextStart;\n  var cookiesSeparatorFound;\n  function skipWhitespace() {\n    while (pos < cookiesString.length && /\\s/.test(cookiesString.charAt(pos))) {\n      pos += 1;\n    }\n    return pos < cookiesString.length;\n  }\n  function notSpecialChar() {\n    ch = cookiesString.charAt(pos);\n    return ch !== \"=\" && ch !== \";\" && ch !== \",\";\n  }\n  while (pos < cookiesString.length) {\n    start = pos;\n    cookiesSeparatorFound = false;\n    while (skipWhitespace()) {\n      ch = cookiesString.charAt(pos);\n      if (ch === \",\") {\n        lastComma = pos;\n        pos += 1;\n        skipWhitespace();\n        nextStart = pos;\n        while (pos < cookiesString.length && notSpecialChar()) {\n          pos += 1;\n        }\n        if (pos < cookiesString.length && cookiesString.charAt(pos) === \"=\") {\n          cookiesSeparatorFound = true;\n          pos = nextStart;\n          cookiesStrings.push(cookiesString.substring(start, lastComma));\n          start = pos;\n        } else {\n          pos = lastComma + 1;\n        }\n      } else {\n        pos += 1;\n      }\n    }\n    if (!cookiesSeparatorFound || pos >= cookiesString.length) {\n      cookiesStrings.push(cookiesString.substring(start, cookiesString.length));\n    }\n  }\n  return cookiesStrings;\n}\n\n// src/request-cookies.ts\nvar RequestCookies = class {\n  constructor(requestHeaders) {\n    /** @internal */\n    this._parsed = /* @__PURE__ */ new Map();\n    this._headers = requestHeaders;\n    const header = requestHeaders.get(\"cookie\");\n    if (header) {\n      const parsed = parseCookie(header);\n      for (const [name, value] of parsed) {\n        this._parsed.set(name, { name, value });\n      }\n    }\n  }\n  [Symbol.iterator]() {\n    return this._parsed[Symbol.iterator]();\n  }\n  /**\n   * The amount of cookies received from the client\n   */\n  get size() {\n    return this._parsed.size;\n  }\n  get(...args) {\n    const name = typeof args[0] === \"string\" ? args[0] : args[0].name;\n    return this._parsed.get(name);\n  }\n  getAll(...args) {\n    var _a;\n    const all = Array.from(this._parsed);\n    if (!args.length) {\n      return all.map(([_, value]) => value);\n    }\n    const name = typeof args[0] === \"string\" ? args[0] : (_a = args[0]) == null ? void 0 : _a.name;\n    return all.filter(([n]) => n === name).map(([_, value]) => value);\n  }\n  has(name) {\n    return this._parsed.has(name);\n  }\n  set(...args) {\n    const [name, value] = args.length === 1 ? [args[0].name, args[0].value] : args;\n    const map = this._parsed;\n    map.set(name, { name, value });\n    this._headers.set(\n      \"cookie\",\n      Array.from(map).map(([_, value2]) => stringifyCookie(value2)).join(\"; \")\n    );\n    return this;\n  }\n  /**\n   * Delete the cookies matching the passed name or names in the request.\n   */\n  delete(names) {\n    const map = this._parsed;\n    const result = !Array.isArray(names) ? map.delete(names) : names.map((name) => map.delete(name));\n    this._headers.set(\n      \"cookie\",\n      Array.from(map).map(([_, value]) => stringifyCookie(value)).join(\"; \")\n    );\n    return result;\n  }\n  /**\n   * Delete all the cookies in the cookies in the request.\n   */\n  clear() {\n    this.delete(Array.from(this._parsed.keys()));\n    return this;\n  }\n  /**\n   * Format the cookies in the request as a string for logging\n   */\n  [Symbol.for(\"edge-runtime.inspect.custom\")]() {\n    return `RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`;\n  }\n  toString() {\n    return [...this._parsed.values()].map((v) => `${v.name}=${encodeURIComponent(v.value)}`).join(\"; \");\n  }\n};\n\n// src/response-cookies.ts\nvar ResponseCookies = class {\n  constructor(responseHeaders) {\n    /** @internal */\n    this._parsed = /* @__PURE__ */ new Map();\n    var _a, _b, _c;\n    this._headers = responseHeaders;\n    const setCookie = (_c = (_b = (_a = responseHeaders.getSetCookie) == null ? void 0 : _a.call(responseHeaders)) != null ? _b : responseHeaders.get(\"set-cookie\")) != null ? _c : [];\n    const cookieStrings = Array.isArray(setCookie) ? setCookie : splitCookiesString(setCookie);\n    for (const cookieString of cookieStrings) {\n      const parsed = parseSetCookie(cookieString);\n      if (parsed)\n        this._parsed.set(parsed.name, parsed);\n    }\n  }\n  /**\n   * {@link https://wicg.github.io/cookie-store/#CookieStore-get CookieStore#get} without the Promise.\n   */\n  get(...args) {\n    const key = typeof args[0] === \"string\" ? args[0] : args[0].name;\n    return this._parsed.get(key);\n  }\n  /**\n   * {@link https://wicg.github.io/cookie-store/#CookieStore-getAll CookieStore#getAll} without the Promise.\n   */\n  getAll(...args) {\n    var _a;\n    const all = Array.from(this._parsed.values());\n    if (!args.length) {\n      return all;\n    }\n    const key = typeof args[0] === \"string\" ? args[0] : (_a = args[0]) == null ? void 0 : _a.name;\n    return all.filter((c) => c.name === key);\n  }\n  has(name) {\n    return this._parsed.has(name);\n  }\n  /**\n   * {@link https://wicg.github.io/cookie-store/#CookieStore-set CookieStore#set} without the Promise.\n   */\n  set(...args) {\n    const [name, value, cookie] = args.length === 1 ? [args[0].name, args[0].value, args[0]] : args;\n    const map = this._parsed;\n    map.set(name, normalizeCookie({ name, value, ...cookie }));\n    replace(map, this._headers);\n    return this;\n  }\n  /**\n   * {@link https://wicg.github.io/cookie-store/#CookieStore-delete CookieStore#delete} without the Promise.\n   */\n  delete(...args) {\n    const [name, path, domain] = typeof args[0] === \"string\" ? [args[0]] : [args[0].name, args[0].path, args[0].domain];\n    return this.set({ name, path, domain, value: \"\", expires: /* @__PURE__ */ new Date(0) });\n  }\n  [Symbol.for(\"edge-runtime.inspect.custom\")]() {\n    return `ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`;\n  }\n  toString() {\n    return [...this._parsed.values()].map(stringifyCookie).join(\"; \");\n  }\n};\nfunction replace(bag, headers) {\n  headers.delete(\"set-cookie\");\n  for (const [, value] of bag) {\n    const serialized = stringifyCookie(value);\n    headers.append(\"set-cookie\", serialized);\n  }\n}\nfunction normalizeCookie(cookie = { name: \"\", value: \"\" }) {\n  if (typeof cookie.expires === \"number\") {\n    cookie.expires = new Date(cookie.expires);\n  }\n  if (cookie.maxAge) {\n    cookie.expires = new Date(Date.now() + cookie.maxAge * 1e3);\n  }\n  if (cookie.path === null || cookie.path === void 0) {\n    cookie.path = \"/\";\n  }\n  return cookie;\n}\n// Annotate the CommonJS export names for ESM import in node:\n0 && (module.exports = {\n  RequestCookies,\n  ResponseCookies,\n  parseCookie,\n  parseSetCookie,\n  stringifyCookie\n});\n","(()=>{\"use strict\";if(typeof __nccwpck_require__!==\"undefined\")__nccwpck_require__.ab=__dirname+\"/\";var e={};(()=>{var r=e;\n/*!\n * cookie\n * Copyright(c) 2012-2014 Roman Shtylman\n * Copyright(c) 2015 Douglas Christopher Wilson\n * MIT Licensed\n */r.parse=parse;r.serialize=serialize;var i=decodeURIComponent;var t=encodeURIComponent;var a=/; */;var n=/^[\\u0009\\u0020-\\u007e\\u0080-\\u00ff]+$/;function parse(e,r){if(typeof e!==\"string\"){throw new TypeError(\"argument str must be a string\")}var t={};var n=r||{};var o=e.split(a);var s=n.decode||i;for(var p=0;p<o.length;p++){var f=o[p];var u=f.indexOf(\"=\");if(u<0){continue}var v=f.substr(0,u).trim();var c=f.substr(++u,f.length).trim();if('\"'==c[0]){c=c.slice(1,-1)}if(undefined==t[v]){t[v]=tryDecode(c,s)}}return t}function serialize(e,r,i){var a=i||{};var o=a.encode||t;if(typeof o!==\"function\"){throw new TypeError(\"option encode is invalid\")}if(!n.test(e)){throw new TypeError(\"argument name is invalid\")}var s=o(r);if(s&&!n.test(s)){throw new TypeError(\"argument val is invalid\")}var p=e+\"=\"+s;if(null!=a.maxAge){var f=a.maxAge-0;if(isNaN(f)||!isFinite(f)){throw new TypeError(\"option maxAge is invalid\")}p+=\"; Max-Age=\"+Math.floor(f)}if(a.domain){if(!n.test(a.domain)){throw new TypeError(\"option domain is invalid\")}p+=\"; Domain=\"+a.domain}if(a.path){if(!n.test(a.path)){throw new TypeError(\"option path is invalid\")}p+=\"; Path=\"+a.path}if(a.expires){if(typeof a.expires.toUTCString!==\"function\"){throw new TypeError(\"option expires is invalid\")}p+=\"; Expires=\"+a.expires.toUTCString()}if(a.httpOnly){p+=\"; HttpOnly\"}if(a.secure){p+=\"; Secure\"}if(a.sameSite){var u=typeof a.sameSite===\"string\"?a.sameSite.toLowerCase():a.sameSite;switch(u){case true:p+=\"; SameSite=Strict\";break;case\"lax\":p+=\"; SameSite=Lax\";break;case\"strict\":p+=\"; SameSite=Strict\";break;case\"none\":p+=\"; SameSite=None\";break;default:throw new TypeError(\"option sameSite is invalid\")}}return p}function tryDecode(e,r){try{return r(e)}catch(r){return e}}})();module.exports=e})();","export { compactDecrypt } from './jwe/compact/decrypt.js';\nexport { flattenedDecrypt } from './jwe/flattened/decrypt.js';\nexport { generalDecrypt } from './jwe/general/decrypt.js';\nexport { GeneralEncrypt } from './jwe/general/encrypt.js';\nexport { compactVerify } from './jws/compact/verify.js';\nexport { flattenedVerify } from './jws/flattened/verify.js';\nexport { generalVerify } from './jws/general/verify.js';\nexport { jwtVerify } from './jwt/verify.js';\nexport { jwtDecrypt } from './jwt/decrypt.js';\nexport { CompactEncrypt } from './jwe/compact/encrypt.js';\nexport { FlattenedEncrypt } from './jwe/flattened/encrypt.js';\nexport { CompactSign } from './jws/compact/sign.js';\nexport { FlattenedSign } from './jws/flattened/sign.js';\nexport { GeneralSign } from './jws/general/sign.js';\nexport { SignJWT } from './jwt/sign.js';\nexport { EncryptJWT } from './jwt/encrypt.js';\nexport { calculateJwkThumbprint, calculateJwkThumbprintUri } from './jwk/thumbprint.js';\nexport { EmbeddedJWK } from './jwk/embedded.js';\nexport { createLocalJWKSet } from './jwks/local.js';\nexport { createRemoteJWKSet, jwksCache, customFetch } from './jwks/remote.js';\nexport { UnsecuredJWT } from './jwt/unsecured.js';\nexport { exportPKCS8, exportSPKI, exportJWK } from './key/export.js';\nexport { importSPKI, importPKCS8, importX509, importJWK } from './key/import.js';\nexport { decodeProtectedHeader } from './util/decode_protected_header.js';\nexport { decodeJwt } from './util/decode_jwt.js';\nexport * as errors from './util/errors.js';\nexport { generateKeyPair } from './key/generate_key_pair.js';\nexport { generateSecret } from './key/generate_secret.js';\nexport * as base64url from './util/base64url.js';\nexport const cryptoRuntime = 'WebCryptoAPI';\n","export const encoder = new TextEncoder();\nexport const decoder = new TextDecoder();\nconst MAX_INT32 = 2 ** 32;\nexport function concat(...buffers) {\n    const size = buffers.reduce((acc, { length }) => acc + length, 0);\n    const buf = new Uint8Array(size);\n    let i = 0;\n    for (const buffer of buffers) {\n        buf.set(buffer, i);\n        i += buffer.length;\n    }\n    return buf;\n}\nfunction writeUInt32BE(buf, value, offset) {\n    if (value < 0 || value >= MAX_INT32) {\n        throw new RangeError(`value must be >= 0 and <= ${MAX_INT32 - 1}. Received ${value}`);\n    }\n    buf.set([value >>> 24, value >>> 16, value >>> 8, value & 0xff], offset);\n}\nexport function uint64be(value) {\n    const high = Math.floor(value / MAX_INT32);\n    const low = value % MAX_INT32;\n    const buf = new Uint8Array(8);\n    writeUInt32BE(buf, high, 0);\n    writeUInt32BE(buf, low, 4);\n    return buf;\n}\nexport function uint32be(value) {\n    const buf = new Uint8Array(4);\n    writeUInt32BE(buf, value);\n    return buf;\n}\n","export function encodeBase64(input) {\n    if (Uint8Array.prototype.toBase64) {\n        return input.toBase64();\n    }\n    const CHUNK_SIZE = 0x8000;\n    const arr = [];\n    for (let i = 0; i < input.length; i += CHUNK_SIZE) {\n        arr.push(String.fromCharCode.apply(null, input.subarray(i, i + CHUNK_SIZE)));\n    }\n    return btoa(arr.join(''));\n}\nexport function decodeBase64(encoded) {\n    if (Uint8Array.fromBase64) {\n        return Uint8Array.fromBase64(encoded);\n    }\n    const binary = atob(encoded);\n    const bytes = new Uint8Array(binary.length);\n    for (let i = 0; i < binary.length; i++) {\n        bytes[i] = binary.charCodeAt(i);\n    }\n    return bytes;\n}\n","import { encoder, decoder } from '../lib/buffer_utils.js';\nimport { encodeBase64, decodeBase64 } from '../lib/base64.js';\nexport function decode(input) {\n    if (Uint8Array.fromBase64) {\n        return Uint8Array.fromBase64(typeof input === 'string' ? input : decoder.decode(input), {\n            alphabet: 'base64url',\n        });\n    }\n    let encoded = input;\n    if (encoded instanceof Uint8Array) {\n        encoded = decoder.decode(encoded);\n    }\n    encoded = encoded.replace(/-/g, '+').replace(/_/g, '/').replace(/\\s/g, '');\n    try {\n        return decodeBase64(encoded);\n    }\n    catch {\n        throw new TypeError('The input to be decoded is not correctly encoded.');\n    }\n}\nexport function encode(input) {\n    let unencoded = input;\n    if (typeof unencoded === 'string') {\n        unencoded = encoder.encode(unencoded);\n    }\n    if (Uint8Array.prototype.toBase64) {\n        return unencoded.toBase64({ alphabet: 'base64url', omitPadding: true });\n    }\n    return encodeBase64(unencoded).replace(/=/g, '').replace(/\\+/g, '-').replace(/\\//g, '_');\n}\n","export class JOSEError extends Error {\n    static code = 'ERR_JOSE_GENERIC';\n    code = 'ERR_JOSE_GENERIC';\n    constructor(message, options) {\n        super(message, options);\n        this.name = this.constructor.name;\n        Error.captureStackTrace?.(this, this.constructor);\n    }\n}\nexport class JWTClaimValidationFailed extends JOSEError {\n    static code = 'ERR_JWT_CLAIM_VALIDATION_FAILED';\n    code = 'ERR_JWT_CLAIM_VALIDATION_FAILED';\n    claim;\n    reason;\n    payload;\n    constructor(message, payload, claim = 'unspecified', reason = 'unspecified') {\n        super(message, { cause: { claim, reason, payload } });\n        this.claim = claim;\n        this.reason = reason;\n        this.payload = payload;\n    }\n}\nexport class JWTExpired extends JOSEError {\n    static code = 'ERR_JWT_EXPIRED';\n    code = 'ERR_JWT_EXPIRED';\n    claim;\n    reason;\n    payload;\n    constructor(message, payload, claim = 'unspecified', reason = 'unspecified') {\n        super(message, { cause: { claim, reason, payload } });\n        this.claim = claim;\n        this.reason = reason;\n        this.payload = payload;\n    }\n}\nexport class JOSEAlgNotAllowed extends JOSEError {\n    static code = 'ERR_JOSE_ALG_NOT_ALLOWED';\n    code = 'ERR_JOSE_ALG_NOT_ALLOWED';\n}\nexport class JOSENotSupported extends JOSEError {\n    static code = 'ERR_JOSE_NOT_SUPPORTED';\n    code = 'ERR_JOSE_NOT_SUPPORTED';\n}\nexport class JWEDecryptionFailed extends JOSEError {\n    static code = 'ERR_JWE_DECRYPTION_FAILED';\n    code = 'ERR_JWE_DECRYPTION_FAILED';\n    constructor(message = 'decryption operation failed', options) {\n        super(message, options);\n    }\n}\nexport class JWEInvalid extends JOSEError {\n    static code = 'ERR_JWE_INVALID';\n    code = 'ERR_JWE_INVALID';\n}\nexport class JWSInvalid extends JOSEError {\n    static code = 'ERR_JWS_INVALID';\n    code = 'ERR_JWS_INVALID';\n}\nexport class JWTInvalid extends JOSEError {\n    static code = 'ERR_JWT_INVALID';\n    code = 'ERR_JWT_INVALID';\n}\nexport class JWKInvalid extends JOSEError {\n    static code = 'ERR_JWK_INVALID';\n    code = 'ERR_JWK_INVALID';\n}\nexport class JWKSInvalid extends JOSEError {\n    static code = 'ERR_JWKS_INVALID';\n    code = 'ERR_JWKS_INVALID';\n}\nexport class JWKSNoMatchingKey extends JOSEError {\n    static code = 'ERR_JWKS_NO_MATCHING_KEY';\n    code = 'ERR_JWKS_NO_MATCHING_KEY';\n    constructor(message = 'no applicable key found in the JSON Web Key Set', options) {\n        super(message, options);\n    }\n}\nexport class JWKSMultipleMatchingKeys extends JOSEError {\n    [Symbol.asyncIterator];\n    static code = 'ERR_JWKS_MULTIPLE_MATCHING_KEYS';\n    code = 'ERR_JWKS_MULTIPLE_MATCHING_KEYS';\n    constructor(message = 'multiple matching keys found in the JSON Web Key Set', options) {\n        super(message, options);\n    }\n}\nexport class JWKSTimeout extends JOSEError {\n    static code = 'ERR_JWKS_TIMEOUT';\n    code = 'ERR_JWKS_TIMEOUT';\n    constructor(message = 'request timed out', options) {\n        super(message, options);\n    }\n}\nexport class JWSSignatureVerificationFailed extends JOSEError {\n    static code = 'ERR_JWS_SIGNATURE_VERIFICATION_FAILED';\n    code = 'ERR_JWS_SIGNATURE_VERIFICATION_FAILED';\n    constructor(message = 'signature verification failed', options) {\n        super(message, options);\n    }\n}\n","import { JOSENotSupported } from '../util/errors.js';\nexport default (alg, algorithm) => {\n    const hash = `SHA-${alg.slice(-3)}`;\n    switch (alg) {\n        case 'HS256':\n        case 'HS384':\n        case 'HS512':\n            return { hash, name: 'HMAC' };\n        case 'PS256':\n        case 'PS384':\n        case 'PS512':\n            return { hash, name: 'RSA-PSS', saltLength: parseInt(alg.slice(-3), 10) >> 3 };\n        case 'RS256':\n        case 'RS384':\n        case 'RS512':\n            return { hash, name: 'RSASSA-PKCS1-v1_5' };\n        case 'ES256':\n        case 'ES384':\n        case 'ES512':\n            return { hash, name: 'ECDSA', namedCurve: algorithm.namedCurve };\n        case 'Ed25519':\n        case 'EdDSA':\n            return { name: 'Ed25519' };\n        case 'ML-DSA-44':\n        case 'ML-DSA-65':\n        case 'ML-DSA-87':\n            return { name: alg };\n        default:\n            throw new JOSENotSupported(`alg ${alg} is not supported either by JOSE or your javascript runtime`);\n    }\n};\n","export default (alg, key) => {\n    if (alg.startsWith('RS') || alg.startsWith('PS')) {\n        const { modulusLength } = key.algorithm;\n        if (typeof modulusLength !== 'number' || modulusLength < 2048) {\n            throw new TypeError(`${alg} requires key modulusLength to be 2048 bits or larger`);\n        }\n    }\n};\n","function unusable(name, prop = 'algorithm.name') {\n    return new TypeError(`CryptoKey does not support this operation, its ${prop} must be ${name}`);\n}\nfunction isAlgorithm(algorithm, name) {\n    return algorithm.name === name;\n}\nfunction getHashLength(hash) {\n    return parseInt(hash.name.slice(4), 10);\n}\nfunction getNamedCurve(alg) {\n    switch (alg) {\n        case 'ES256':\n            return 'P-256';\n        case 'ES384':\n            return 'P-384';\n        case 'ES512':\n            return 'P-521';\n        default:\n            throw new Error('unreachable');\n    }\n}\nfunction checkUsage(key, usage) {\n    if (usage && !key.usages.includes(usage)) {\n        throw new TypeError(`CryptoKey does not support this operation, its usages must include ${usage}.`);\n    }\n}\nexport function checkSigCryptoKey(key, alg, usage) {\n    switch (alg) {\n        case 'HS256':\n        case 'HS384':\n        case 'HS512': {\n            if (!isAlgorithm(key.algorithm, 'HMAC'))\n                throw unusable('HMAC');\n            const expected = parseInt(alg.slice(2), 10);\n            const actual = getHashLength(key.algorithm.hash);\n            if (actual !== expected)\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\n            break;\n        }\n        case 'RS256':\n        case 'RS384':\n        case 'RS512': {\n            if (!isAlgorithm(key.algorithm, 'RSASSA-PKCS1-v1_5'))\n                throw unusable('RSASSA-PKCS1-v1_5');\n            const expected = parseInt(alg.slice(2), 10);\n            const actual = getHashLength(key.algorithm.hash);\n            if (actual !== expected)\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\n            break;\n        }\n        case 'PS256':\n        case 'PS384':\n        case 'PS512': {\n            if (!isAlgorithm(key.algorithm, 'RSA-PSS'))\n                throw unusable('RSA-PSS');\n            const expected = parseInt(alg.slice(2), 10);\n            const actual = getHashLength(key.algorithm.hash);\n            if (actual !== expected)\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\n            break;\n        }\n        case 'Ed25519':\n        case 'EdDSA': {\n            if (!isAlgorithm(key.algorithm, 'Ed25519'))\n                throw unusable('Ed25519');\n            break;\n        }\n        case 'ML-DSA-44':\n        case 'ML-DSA-65':\n        case 'ML-DSA-87': {\n            if (!isAlgorithm(key.algorithm, alg))\n                throw unusable(alg);\n            break;\n        }\n        case 'ES256':\n        case 'ES384':\n        case 'ES512': {\n            if (!isAlgorithm(key.algorithm, 'ECDSA'))\n                throw unusable('ECDSA');\n            const expected = getNamedCurve(alg);\n            const actual = key.algorithm.namedCurve;\n            if (actual !== expected)\n                throw unusable(expected, 'algorithm.namedCurve');\n            break;\n        }\n        default:\n            throw new TypeError('CryptoKey does not support this operation');\n    }\n    checkUsage(key, usage);\n}\nexport function checkEncCryptoKey(key, alg, usage) {\n    switch (alg) {\n        case 'A128GCM':\n        case 'A192GCM':\n        case 'A256GCM': {\n            if (!isAlgorithm(key.algorithm, 'AES-GCM'))\n                throw unusable('AES-GCM');\n            const expected = parseInt(alg.slice(1, 4), 10);\n            const actual = key.algorithm.length;\n            if (actual !== expected)\n                throw unusable(expected, 'algorithm.length');\n            break;\n        }\n        case 'A128KW':\n        case 'A192KW':\n        case 'A256KW': {\n            if (!isAlgorithm(key.algorithm, 'AES-KW'))\n                throw unusable('AES-KW');\n            const expected = parseInt(alg.slice(1, 4), 10);\n            const actual = key.algorithm.length;\n            if (actual !== expected)\n                throw unusable(expected, 'algorithm.length');\n            break;\n        }\n        case 'ECDH': {\n            switch (key.algorithm.name) {\n                case 'ECDH':\n                case 'X25519':\n                    break;\n                default:\n                    throw unusable('ECDH or X25519');\n            }\n            break;\n        }\n        case 'PBES2-HS256+A128KW':\n        case 'PBES2-HS384+A192KW':\n        case 'PBES2-HS512+A256KW':\n            if (!isAlgorithm(key.algorithm, 'PBKDF2'))\n                throw unusable('PBKDF2');\n            break;\n        case 'RSA-OAEP':\n        case 'RSA-OAEP-256':\n        case 'RSA-OAEP-384':\n        case 'RSA-OAEP-512': {\n            if (!isAlgorithm(key.algorithm, 'RSA-OAEP'))\n                throw unusable('RSA-OAEP');\n            const expected = parseInt(alg.slice(9), 10) || 1;\n            const actual = getHashLength(key.algorithm.hash);\n            if (actual !== expected)\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\n            break;\n        }\n        default:\n            throw new TypeError('CryptoKey does not support this operation');\n    }\n    checkUsage(key, usage);\n}\n","function message(msg, actual, ...types) {\n    types = types.filter(Boolean);\n    if (types.length > 2) {\n        const last = types.pop();\n        msg += `one of type ${types.join(', ')}, or ${last}.`;\n    }\n    else if (types.length === 2) {\n        msg += `one of type ${types[0]} or ${types[1]}.`;\n    }\n    else {\n        msg += `of type ${types[0]}.`;\n    }\n    if (actual == null) {\n        msg += ` Received ${actual}`;\n    }\n    else if (typeof actual === 'function' && actual.name) {\n        msg += ` Received function ${actual.name}`;\n    }\n    else if (typeof actual === 'object' && actual != null) {\n        if (actual.constructor?.name) {\n            msg += ` Received an instance of ${actual.constructor.name}`;\n        }\n    }\n    return msg;\n}\nexport default (actual, ...types) => {\n    return message('Key must be ', actual, ...types);\n};\nexport function withAlg(alg, actual, ...types) {\n    return message(`Key for the ${alg} algorithm must be `, actual, ...types);\n}\n","import { checkSigCryptoKey } from './crypto_key.js';\nimport invalidKeyInput from './invalid_key_input.js';\nexport default async (alg, key, usage) => {\n    if (key instanceof Uint8Array) {\n        if (!alg.startsWith('HS')) {\n            throw new TypeError(invalidKeyInput(key, 'CryptoKey', 'KeyObject', 'JSON Web Key'));\n        }\n        return crypto.subtle.importKey('raw', key, { hash: `SHA-${alg.slice(-3)}`, name: 'HMAC' }, false, [usage]);\n    }\n    checkSigCryptoKey(key, alg, usage);\n    return key;\n};\n","import subtleAlgorithm from './subtle_dsa.js';\nimport checkKeyLength from './check_key_length.js';\nimport getVerifyKey from './get_sign_verify_key.js';\nexport default async (alg, key, signature, data) => {\n    const cryptoKey = await getVerifyKey(alg, key, 'verify');\n    checkKeyLength(alg, cryptoKey);\n    const algorithm = subtleAlgorithm(alg, cryptoKey.algorithm);\n    try {\n        return await crypto.subtle.verify(algorithm, cryptoKey, signature, data);\n    }\n    catch {\n        return false;\n    }\n};\n","export default (...headers) => {\n    const sources = headers.filter(Boolean);\n    if (sources.length === 0 || sources.length === 1) {\n        return true;\n    }\n    let acc;\n    for (const header of sources) {\n        const parameters = Object.keys(header);\n        if (!acc || acc.size === 0) {\n            acc = new Set(parameters);\n            continue;\n        }\n        for (const parameter of parameters) {\n            if (acc.has(parameter)) {\n                return false;\n            }\n            acc.add(parameter);\n        }\n    }\n    return true;\n};\n","function isObjectLike(value) {\n    return typeof value === 'object' && value !== null;\n}\nexport default (input) => {\n    if (!isObjectLike(input) || Object.prototype.toString.call(input) !== '[object Object]') {\n        return false;\n    }\n    if (Object.getPrototypeOf(input) === null) {\n        return true;\n    }\n    let proto = input;\n    while (Object.getPrototypeOf(proto) !== null) {\n        proto = Object.getPrototypeOf(proto);\n    }\n    return Object.getPrototypeOf(input) === proto;\n};\n","export function assertCryptoKey(key) {\n    if (!isCryptoKey(key)) {\n        throw new Error('CryptoKey instance expected');\n    }\n}\nexport function isCryptoKey(key) {\n    return key?.[Symbol.toStringTag] === 'CryptoKey';\n}\nexport function isKeyObject(key) {\n    return key?.[Symbol.toStringTag] === 'KeyObject';\n}\nexport default (key) => {\n    return isCryptoKey(key) || isKeyObject(key);\n};\n","import isObject from './is_object.js';\nexport function isJWK(key) {\n    return isObject(key) && typeof key.kty === 'string';\n}\nexport function isPrivateJWK(key) {\n    return (key.kty !== 'oct' &&\n        ((key.kty === 'AKP' && typeof key.priv === 'string') || typeof key.d === 'string'));\n}\nexport function isPublicJWK(key) {\n    return key.kty !== 'oct' && typeof key.d === 'undefined' && typeof key.priv === 'undefined';\n}\nexport function isSecretJWK(key) {\n    return key.kty === 'oct' && typeof key.k === 'string';\n}\n","import { withAlg as invalidKeyInput } from './invalid_key_input.js';\nimport isKeyLike from './is_key_like.js';\nimport * as jwk from './is_jwk.js';\nconst tag = (key) => key?.[Symbol.toStringTag];\nconst jwkMatchesOp = (alg, key, usage) => {\n    if (key.use !== undefined) {\n        let expected;\n        switch (usage) {\n            case 'sign':\n            case 'verify':\n                expected = 'sig';\n                break;\n            case 'encrypt':\n            case 'decrypt':\n                expected = 'enc';\n                break;\n        }\n        if (key.use !== expected) {\n            throw new TypeError(`Invalid key for this operation, its \"use\" must be \"${expected}\" when present`);\n        }\n    }\n    if (key.alg !== undefined && key.alg !== alg) {\n        throw new TypeError(`Invalid key for this operation, its \"alg\" must be \"${alg}\" when present`);\n    }\n    if (Array.isArray(key.key_ops)) {\n        let expectedKeyOp;\n        switch (true) {\n            case usage === 'sign' || usage === 'verify':\n            case alg === 'dir':\n            case alg.includes('CBC-HS'):\n                expectedKeyOp = usage;\n                break;\n            case alg.startsWith('PBES2'):\n                expectedKeyOp = 'deriveBits';\n                break;\n            case /^A\\d{3}(?:GCM)?(?:KW)?$/.test(alg):\n                if (!alg.includes('GCM') && alg.endsWith('KW')) {\n                    expectedKeyOp = usage === 'encrypt' ? 'wrapKey' : 'unwrapKey';\n                }\n                else {\n                    expectedKeyOp = usage;\n                }\n                break;\n            case usage === 'encrypt' && alg.startsWith('RSA'):\n                expectedKeyOp = 'wrapKey';\n                break;\n            case usage === 'decrypt':\n                expectedKeyOp = alg.startsWith('RSA') ? 'unwrapKey' : 'deriveBits';\n                break;\n        }\n        if (expectedKeyOp && key.key_ops?.includes?.(expectedKeyOp) === false) {\n            throw new TypeError(`Invalid key for this operation, its \"key_ops\" must include \"${expectedKeyOp}\" when present`);\n        }\n    }\n    return true;\n};\nconst symmetricTypeCheck = (alg, key, usage) => {\n    if (key instanceof Uint8Array)\n        return;\n    if (jwk.isJWK(key)) {\n        if (jwk.isSecretJWK(key) && jwkMatchesOp(alg, key, usage))\n            return;\n        throw new TypeError(`JSON Web Key for symmetric algorithms must have JWK \"kty\" (Key Type) equal to \"oct\" and the JWK \"k\" (Key Value) present`);\n    }\n    if (!isKeyLike(key)) {\n        throw new TypeError(invalidKeyInput(alg, key, 'CryptoKey', 'KeyObject', 'JSON Web Key', 'Uint8Array'));\n    }\n    if (key.type !== 'secret') {\n        throw new TypeError(`${tag(key)} instances for symmetric algorithms must be of type \"secret\"`);\n    }\n};\nconst asymmetricTypeCheck = (alg, key, usage) => {\n    if (jwk.isJWK(key)) {\n        switch (usage) {\n            case 'decrypt':\n            case 'sign':\n                if (jwk.isPrivateJWK(key) && jwkMatchesOp(alg, key, usage))\n                    return;\n                throw new TypeError(`JSON Web Key for this operation be a private JWK`);\n            case 'encrypt':\n            case 'verify':\n                if (jwk.isPublicJWK(key) && jwkMatchesOp(alg, key, usage))\n                    return;\n                throw new TypeError(`JSON Web Key for this operation be a public JWK`);\n        }\n    }\n    if (!isKeyLike(key)) {\n        throw new TypeError(invalidKeyInput(alg, key, 'CryptoKey', 'KeyObject', 'JSON Web Key'));\n    }\n    if (key.type === 'secret') {\n        throw new TypeError(`${tag(key)} instances for asymmetric algorithms must not be of type \"secret\"`);\n    }\n    if (key.type === 'public') {\n        switch (usage) {\n            case 'sign':\n                throw new TypeError(`${tag(key)} instances for asymmetric algorithm signing must be of type \"private\"`);\n            case 'decrypt':\n                throw new TypeError(`${tag(key)} instances for asymmetric algorithm decryption must be of type \"private\"`);\n            default:\n                break;\n        }\n    }\n    if (key.type === 'private') {\n        switch (usage) {\n            case 'verify':\n                throw new TypeError(`${tag(key)} instances for asymmetric algorithm verifying must be of type \"public\"`);\n            case 'encrypt':\n                throw new TypeError(`${tag(key)} instances for asymmetric algorithm encryption must be of type \"public\"`);\n            default:\n                break;\n        }\n    }\n};\nexport default (alg, key, usage) => {\n    const symmetric = alg.startsWith('HS') ||\n        alg === 'dir' ||\n        alg.startsWith('PBES2') ||\n        /^A(?:128|192|256)(?:GCM)?(?:KW)?$/.test(alg) ||\n        /^A(?:128|192|256)CBC-HS(?:256|384|512)$/.test(alg);\n    if (symmetric) {\n        symmetricTypeCheck(alg, key, usage);\n    }\n    else {\n        asymmetricTypeCheck(alg, key, usage);\n    }\n};\n","import { JOSENotSupported, JWEInvalid, JWSInvalid } from '../util/errors.js';\nexport default (Err, recognizedDefault, recognizedOption, protectedHeader, joseHeader) => {\n    if (joseHeader.crit !== undefined && protectedHeader?.crit === undefined) {\n        throw new Err('\"crit\" (Critical) Header Parameter MUST be integrity protected');\n    }\n    if (!protectedHeader || protectedHeader.crit === undefined) {\n        return new Set();\n    }\n    if (!Array.isArray(protectedHeader.crit) ||\n        protectedHeader.crit.length === 0 ||\n        protectedHeader.crit.some((input) => typeof input !== 'string' || input.length === 0)) {\n        throw new Err('\"crit\" (Critical) Header Parameter MUST be an array of non-empty strings when present');\n    }\n    let recognized;\n    if (recognizedOption !== undefined) {\n        recognized = new Map([...Object.entries(recognizedOption), ...recognizedDefault.entries()]);\n    }\n    else {\n        recognized = recognizedDefault;\n    }\n    for (const parameter of protectedHeader.crit) {\n        if (!recognized.has(parameter)) {\n            throw new JOSENotSupported(`Extension Header Parameter \"${parameter}\" is not recognized`);\n        }\n        if (joseHeader[parameter] === undefined) {\n            throw new Err(`Extension Header Parameter \"${parameter}\" is missing`);\n        }\n        if (recognized.get(parameter) && protectedHeader[parameter] === undefined) {\n            throw new Err(`Extension Header Parameter \"${parameter}\" MUST be integrity protected`);\n        }\n    }\n    return new Set(protectedHeader.crit);\n};\n","export default (option, algorithms) => {\n    if (algorithms !== undefined &&\n        (!Array.isArray(algorithms) || algorithms.some((s) => typeof s !== 'string'))) {\n        throw new TypeError(`\"${option}\" option must be an array of strings`);\n    }\n    if (!algorithms) {\n        return undefined;\n    }\n    return new Set(algorithms);\n};\n","import { JOSENotSupported } from '../util/errors.js';\nfunction subtleMapping(jwk) {\n    let algorithm;\n    let keyUsages;\n    switch (jwk.kty) {\n        case 'AKP': {\n            switch (jwk.alg) {\n                case 'ML-DSA-44':\n                case 'ML-DSA-65':\n                case 'ML-DSA-87':\n                    algorithm = { name: jwk.alg };\n                    keyUsages = jwk.priv ? ['sign'] : ['verify'];\n                    break;\n                default:\n                    throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        case 'RSA': {\n            switch (jwk.alg) {\n                case 'PS256':\n                case 'PS384':\n                case 'PS512':\n                    algorithm = { name: 'RSA-PSS', hash: `SHA-${jwk.alg.slice(-3)}` };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'RS256':\n                case 'RS384':\n                case 'RS512':\n                    algorithm = { name: 'RSASSA-PKCS1-v1_5', hash: `SHA-${jwk.alg.slice(-3)}` };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'RSA-OAEP':\n                case 'RSA-OAEP-256':\n                case 'RSA-OAEP-384':\n                case 'RSA-OAEP-512':\n                    algorithm = {\n                        name: 'RSA-OAEP',\n                        hash: `SHA-${parseInt(jwk.alg.slice(-3), 10) || 1}`,\n                    };\n                    keyUsages = jwk.d ? ['decrypt', 'unwrapKey'] : ['encrypt', 'wrapKey'];\n                    break;\n                default:\n                    throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        case 'EC': {\n            switch (jwk.alg) {\n                case 'ES256':\n                    algorithm = { name: 'ECDSA', namedCurve: 'P-256' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ES384':\n                    algorithm = { name: 'ECDSA', namedCurve: 'P-384' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ES512':\n                    algorithm = { name: 'ECDSA', namedCurve: 'P-521' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ECDH-ES':\n                case 'ECDH-ES+A128KW':\n                case 'ECDH-ES+A192KW':\n                case 'ECDH-ES+A256KW':\n                    algorithm = { name: 'ECDH', namedCurve: jwk.crv };\n                    keyUsages = jwk.d ? ['deriveBits'] : [];\n                    break;\n                default:\n                    throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        case 'OKP': {\n            switch (jwk.alg) {\n                case 'Ed25519':\n                case 'EdDSA':\n                    algorithm = { name: 'Ed25519' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ECDH-ES':\n                case 'ECDH-ES+A128KW':\n                case 'ECDH-ES+A192KW':\n                case 'ECDH-ES+A256KW':\n                    algorithm = { name: jwk.crv };\n                    keyUsages = jwk.d ? ['deriveBits'] : [];\n                    break;\n                default:\n                    throw new JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        default:\n            throw new JOSENotSupported('Invalid or unsupported JWK \"kty\" (Key Type) Parameter value');\n    }\n    return { algorithm, keyUsages };\n}\nexport default async (jwk) => {\n    if (!jwk.alg) {\n        throw new TypeError('\"alg\" argument is required when \"jwk.alg\" is not present');\n    }\n    const { algorithm, keyUsages } = subtleMapping(jwk);\n    const keyData = { ...jwk };\n    if (keyData.kty !== 'AKP') {\n        delete keyData.alg;\n    }\n    delete keyData.use;\n    return crypto.subtle.importKey('jwk', keyData, algorithm, jwk.ext ?? (jwk.d || jwk.priv ? false : true), jwk.key_ops ?? keyUsages);\n};\n","import { isJWK } from './is_jwk.js';\nimport { decode } from '../util/base64url.js';\nimport importJWK from './jwk_to_key.js';\nimport { isCryptoKey, isKeyObject } from './is_key_like.js';\nlet cache;\nconst handleJWK = async (key, jwk, alg, freeze = false) => {\n    cache ||= new WeakMap();\n    let cached = cache.get(key);\n    if (cached?.[alg]) {\n        return cached[alg];\n    }\n    const cryptoKey = await importJWK({ ...jwk, alg });\n    if (freeze)\n        Object.freeze(key);\n    if (!cached) {\n        cache.set(key, { [alg]: cryptoKey });\n    }\n    else {\n        cached[alg] = cryptoKey;\n    }\n    return cryptoKey;\n};\nconst handleKeyObject = (keyObject, alg) => {\n    cache ||= new WeakMap();\n    let cached = cache.get(keyObject);\n    if (cached?.[alg]) {\n        return cached[alg];\n    }\n    const isPublic = keyObject.type === 'public';\n    const extractable = isPublic ? true : false;\n    let cryptoKey;\n    if (keyObject.asymmetricKeyType === 'x25519') {\n        switch (alg) {\n            case 'ECDH-ES':\n            case 'ECDH-ES+A128KW':\n            case 'ECDH-ES+A192KW':\n            case 'ECDH-ES+A256KW':\n                break;\n            default:\n                throw new TypeError('given KeyObject instance cannot be used for this algorithm');\n        }\n        cryptoKey = keyObject.toCryptoKey(keyObject.asymmetricKeyType, extractable, isPublic ? [] : ['deriveBits']);\n    }\n    if (keyObject.asymmetricKeyType === 'ed25519') {\n        if (alg !== 'EdDSA' && alg !== 'Ed25519') {\n            throw new TypeError('given KeyObject instance cannot be used for this algorithm');\n        }\n        cryptoKey = keyObject.toCryptoKey(keyObject.asymmetricKeyType, extractable, [\n            isPublic ? 'verify' : 'sign',\n        ]);\n    }\n    switch (keyObject.asymmetricKeyType) {\n        case 'ml-dsa-44':\n        case 'ml-dsa-65':\n        case 'ml-dsa-87': {\n            if (alg !== keyObject.asymmetricKeyType.toUpperCase()) {\n                throw new TypeError('given KeyObject instance cannot be used for this algorithm');\n            }\n            cryptoKey = keyObject.toCryptoKey(keyObject.asymmetricKeyType, extractable, [\n                isPublic ? 'verify' : 'sign',\n            ]);\n        }\n    }\n    if (keyObject.asymmetricKeyType === 'rsa') {\n        let hash;\n        switch (alg) {\n            case 'RSA-OAEP':\n                hash = 'SHA-1';\n                break;\n            case 'RS256':\n            case 'PS256':\n            case 'RSA-OAEP-256':\n                hash = 'SHA-256';\n                break;\n            case 'RS384':\n            case 'PS384':\n            case 'RSA-OAEP-384':\n                hash = 'SHA-384';\n                break;\n            case 'RS512':\n            case 'PS512':\n            case 'RSA-OAEP-512':\n                hash = 'SHA-512';\n                break;\n            default:\n                throw new TypeError('given KeyObject instance cannot be used for this algorithm');\n        }\n        if (alg.startsWith('RSA-OAEP')) {\n            return keyObject.toCryptoKey({\n                name: 'RSA-OAEP',\n                hash,\n            }, extractable, isPublic ? ['encrypt'] : ['decrypt']);\n        }\n        cryptoKey = keyObject.toCryptoKey({\n            name: alg.startsWith('PS') ? 'RSA-PSS' : 'RSASSA-PKCS1-v1_5',\n            hash,\n        }, extractable, [isPublic ? 'verify' : 'sign']);\n    }\n    if (keyObject.asymmetricKeyType === 'ec') {\n        const nist = new Map([\n            ['prime256v1', 'P-256'],\n            ['secp384r1', 'P-384'],\n            ['secp521r1', 'P-521'],\n        ]);\n        const namedCurve = nist.get(keyObject.asymmetricKeyDetails?.namedCurve);\n        if (!namedCurve) {\n            throw new TypeError('given KeyObject instance cannot be used for this algorithm');\n        }\n        if (alg === 'ES256' && namedCurve === 'P-256') {\n            cryptoKey = keyObject.toCryptoKey({\n                name: 'ECDSA',\n                namedCurve,\n            }, extractable, [isPublic ? 'verify' : 'sign']);\n        }\n        if (alg === 'ES384' && namedCurve === 'P-384') {\n            cryptoKey = keyObject.toCryptoKey({\n                name: 'ECDSA',\n                namedCurve,\n            }, extractable, [isPublic ? 'verify' : 'sign']);\n        }\n        if (alg === 'ES512' && namedCurve === 'P-521') {\n            cryptoKey = keyObject.toCryptoKey({\n                name: 'ECDSA',\n                namedCurve,\n            }, extractable, [isPublic ? 'verify' : 'sign']);\n        }\n        if (alg.startsWith('ECDH-ES')) {\n            cryptoKey = keyObject.toCryptoKey({\n                name: 'ECDH',\n                namedCurve,\n            }, extractable, isPublic ? [] : ['deriveBits']);\n        }\n    }\n    if (!cryptoKey) {\n        throw new TypeError('given KeyObject instance cannot be used for this algorithm');\n    }\n    if (!cached) {\n        cache.set(keyObject, { [alg]: cryptoKey });\n    }\n    else {\n        cached[alg] = cryptoKey;\n    }\n    return cryptoKey;\n};\nexport default async (key, alg) => {\n    if (key instanceof Uint8Array) {\n        return key;\n    }\n    if (isCryptoKey(key)) {\n        return key;\n    }\n    if (isKeyObject(key)) {\n        if (key.type === 'secret') {\n            return key.export();\n        }\n        if ('toCryptoKey' in key && typeof key.toCryptoKey === 'function') {\n            try {\n                return handleKeyObject(key, alg);\n            }\n            catch (err) {\n                if (err instanceof TypeError) {\n                    throw err;\n                }\n            }\n        }\n        let jwk = key.export({ format: 'jwk' });\n        return handleJWK(key, jwk, alg);\n    }\n    if (isJWK(key)) {\n        if (key.k) {\n            return decode(key.k);\n        }\n        return handleJWK(key, key, alg, true);\n    }\n    throw new Error('unreachable');\n};\n","import { decode as b64u } from '../../util/base64url.js';\nimport verify from '../../lib/verify.js';\nimport { JOSEAlgNotAllowed, JWSInvalid, JWSSignatureVerificationFailed } from '../../util/errors.js';\nimport { concat, encoder, decoder } from '../../lib/buffer_utils.js';\nimport isDisjoint from '../../lib/is_disjoint.js';\nimport isObject from '../../lib/is_object.js';\nimport checkKeyType from '../../lib/check_key_type.js';\nimport validateCrit from '../../lib/validate_crit.js';\nimport validateAlgorithms from '../../lib/validate_algorithms.js';\nimport normalizeKey from '../../lib/normalize_key.js';\nexport async function flattenedVerify(jws, key, options) {\n    if (!isObject(jws)) {\n        throw new JWSInvalid('Flattened JWS must be an object');\n    }\n    if (jws.protected === undefined && jws.header === undefined) {\n        throw new JWSInvalid('Flattened JWS must have either of the \"protected\" or \"header\" members');\n    }\n    if (jws.protected !== undefined && typeof jws.protected !== 'string') {\n        throw new JWSInvalid('JWS Protected Header incorrect type');\n    }\n    if (jws.payload === undefined) {\n        throw new JWSInvalid('JWS Payload missing');\n    }\n    if (typeof jws.signature !== 'string') {\n        throw new JWSInvalid('JWS Signature missing or incorrect type');\n    }\n    if (jws.header !== undefined && !isObject(jws.header)) {\n        throw new JWSInvalid('JWS Unprotected Header incorrect type');\n    }\n    let parsedProt = {};\n    if (jws.protected) {\n        try {\n            const protectedHeader = b64u(jws.protected);\n            parsedProt = JSON.parse(decoder.decode(protectedHeader));\n        }\n        catch {\n            throw new JWSInvalid('JWS Protected Header is invalid');\n        }\n    }\n    if (!isDisjoint(parsedProt, jws.header)) {\n        throw new JWSInvalid('JWS Protected and JWS Unprotected Header Parameter names must be disjoint');\n    }\n    const joseHeader = {\n        ...parsedProt,\n        ...jws.header,\n    };\n    const extensions = validateCrit(JWSInvalid, new Map([['b64', true]]), options?.crit, parsedProt, joseHeader);\n    let b64 = true;\n    if (extensions.has('b64')) {\n        b64 = parsedProt.b64;\n        if (typeof b64 !== 'boolean') {\n            throw new JWSInvalid('The \"b64\" (base64url-encode payload) Header Parameter must be a boolean');\n        }\n    }\n    const { alg } = joseHeader;\n    if (typeof alg !== 'string' || !alg) {\n        throw new JWSInvalid('JWS \"alg\" (Algorithm) Header Parameter missing or invalid');\n    }\n    const algorithms = options && validateAlgorithms('algorithms', options.algorithms);\n    if (algorithms && !algorithms.has(alg)) {\n        throw new JOSEAlgNotAllowed('\"alg\" (Algorithm) Header Parameter value not allowed');\n    }\n    if (b64) {\n        if (typeof jws.payload !== 'string') {\n            throw new JWSInvalid('JWS Payload must be a string');\n        }\n    }\n    else if (typeof jws.payload !== 'string' && !(jws.payload instanceof Uint8Array)) {\n        throw new JWSInvalid('JWS Payload must be a string or an Uint8Array instance');\n    }\n    let resolvedKey = false;\n    if (typeof key === 'function') {\n        key = await key(parsedProt, jws);\n        resolvedKey = true;\n    }\n    checkKeyType(alg, key, 'verify');\n    const data = concat(encoder.encode(jws.protected ?? ''), encoder.encode('.'), typeof jws.payload === 'string' ? encoder.encode(jws.payload) : jws.payload);\n    let signature;\n    try {\n        signature = b64u(jws.signature);\n    }\n    catch {\n        throw new JWSInvalid('Failed to base64url decode the signature');\n    }\n    const k = await normalizeKey(key, alg);\n    const verified = await verify(alg, k, signature, data);\n    if (!verified) {\n        throw new JWSSignatureVerificationFailed();\n    }\n    let payload;\n    if (b64) {\n        try {\n            payload = b64u(jws.payload);\n        }\n        catch {\n            throw new JWSInvalid('Failed to base64url decode the payload');\n        }\n    }\n    else if (typeof jws.payload === 'string') {\n        payload = encoder.encode(jws.payload);\n    }\n    else {\n        payload = jws.payload;\n    }\n    const result = { payload };\n    if (jws.protected !== undefined) {\n        result.protectedHeader = parsedProt;\n    }\n    if (jws.header !== undefined) {\n        result.unprotectedHeader = jws.header;\n    }\n    if (resolvedKey) {\n        return { ...result, key: k };\n    }\n    return result;\n}\n","import { flattenedVerify } from '../flattened/verify.js';\nimport { JWSInvalid } from '../../util/errors.js';\nimport { decoder } from '../../lib/buffer_utils.js';\nexport async function compactVerify(jws, key, options) {\n    if (jws instanceof Uint8Array) {\n        jws = decoder.decode(jws);\n    }\n    if (typeof jws !== 'string') {\n        throw new JWSInvalid('Compact JWS must be a string or Uint8Array');\n    }\n    const { 0: protectedHeader, 1: payload, 2: signature, length } = jws.split('.');\n    if (length !== 3) {\n        throw new JWSInvalid('Invalid Compact JWS');\n    }\n    const verified = await flattenedVerify({ payload, protected: protectedHeader, signature }, key, options);\n    const result = { payload: verified.payload, protectedHeader: verified.protectedHeader };\n    if (typeof key === 'function') {\n        return { ...result, key: verified.key };\n    }\n    return result;\n}\n","export default (date) => Math.floor(date.getTime() / 1000);\n","const minute = 60;\nconst hour = minute * 60;\nconst day = hour * 24;\nconst week = day * 7;\nconst year = day * 365.25;\nconst REGEX = /^(\\+|\\-)? ?(\\d+|\\d+\\.\\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;\nexport default (str) => {\n    const matched = REGEX.exec(str);\n    if (!matched || (matched[4] && matched[1])) {\n        throw new TypeError('Invalid time period format');\n    }\n    const value = parseFloat(matched[2]);\n    const unit = matched[3].toLowerCase();\n    let numericDate;\n    switch (unit) {\n        case 'sec':\n        case 'secs':\n        case 'second':\n        case 'seconds':\n        case 's':\n            numericDate = Math.round(value);\n            break;\n        case 'minute':\n        case 'minutes':\n        case 'min':\n        case 'mins':\n        case 'm':\n            numericDate = Math.round(value * minute);\n            break;\n        case 'hour':\n        case 'hours':\n        case 'hr':\n        case 'hrs':\n        case 'h':\n            numericDate = Math.round(value * hour);\n            break;\n        case 'day':\n        case 'days':\n        case 'd':\n            numericDate = Math.round(value * day);\n            break;\n        case 'week':\n        case 'weeks':\n        case 'w':\n            numericDate = Math.round(value * week);\n            break;\n        default:\n            numericDate = Math.round(value * year);\n            break;\n    }\n    if (matched[1] === '-' || matched[4] === 'ago') {\n        return -numericDate;\n    }\n    return numericDate;\n};\n","import { JWTClaimValidationFailed, JWTExpired, JWTInvalid } from '../util/errors.js';\nimport { decoder } from './buffer_utils.js';\nimport epoch from './epoch.js';\nimport secs from './secs.js';\nimport isObject from './is_object.js';\nimport { encoder } from './buffer_utils.js';\nfunction validateInput(label, input) {\n    if (!Number.isFinite(input)) {\n        throw new TypeError(`Invalid ${label} input`);\n    }\n    return input;\n}\nconst normalizeTyp = (value) => {\n    if (value.includes('/')) {\n        return value.toLowerCase();\n    }\n    return `application/${value.toLowerCase()}`;\n};\nconst checkAudiencePresence = (audPayload, audOption) => {\n    if (typeof audPayload === 'string') {\n        return audOption.includes(audPayload);\n    }\n    if (Array.isArray(audPayload)) {\n        return audOption.some(Set.prototype.has.bind(new Set(audPayload)));\n    }\n    return false;\n};\nexport function validateClaimsSet(protectedHeader, encodedPayload, options = {}) {\n    let payload;\n    try {\n        payload = JSON.parse(decoder.decode(encodedPayload));\n    }\n    catch {\n    }\n    if (!isObject(payload)) {\n        throw new JWTInvalid('JWT Claims Set must be a top-level JSON object');\n    }\n    const { typ } = options;\n    if (typ &&\n        (typeof protectedHeader.typ !== 'string' ||\n            normalizeTyp(protectedHeader.typ) !== normalizeTyp(typ))) {\n        throw new JWTClaimValidationFailed('unexpected \"typ\" JWT header value', payload, 'typ', 'check_failed');\n    }\n    const { requiredClaims = [], issuer, subject, audience, maxTokenAge } = options;\n    const presenceCheck = [...requiredClaims];\n    if (maxTokenAge !== undefined)\n        presenceCheck.push('iat');\n    if (audience !== undefined)\n        presenceCheck.push('aud');\n    if (subject !== undefined)\n        presenceCheck.push('sub');\n    if (issuer !== undefined)\n        presenceCheck.push('iss');\n    for (const claim of new Set(presenceCheck.reverse())) {\n        if (!(claim in payload)) {\n            throw new JWTClaimValidationFailed(`missing required \"${claim}\" claim`, payload, claim, 'missing');\n        }\n    }\n    if (issuer &&\n        !(Array.isArray(issuer) ? issuer : [issuer]).includes(payload.iss)) {\n        throw new JWTClaimValidationFailed('unexpected \"iss\" claim value', payload, 'iss', 'check_failed');\n    }\n    if (subject && payload.sub !== subject) {\n        throw new JWTClaimValidationFailed('unexpected \"sub\" claim value', payload, 'sub', 'check_failed');\n    }\n    if (audience &&\n        !checkAudiencePresence(payload.aud, typeof audience === 'string' ? [audience] : audience)) {\n        throw new JWTClaimValidationFailed('unexpected \"aud\" claim value', payload, 'aud', 'check_failed');\n    }\n    let tolerance;\n    switch (typeof options.clockTolerance) {\n        case 'string':\n            tolerance = secs(options.clockTolerance);\n            break;\n        case 'number':\n            tolerance = options.clockTolerance;\n            break;\n        case 'undefined':\n            tolerance = 0;\n            break;\n        default:\n            throw new TypeError('Invalid clockTolerance option type');\n    }\n    const { currentDate } = options;\n    const now = epoch(currentDate || new Date());\n    if ((payload.iat !== undefined || maxTokenAge) && typeof payload.iat !== 'number') {\n        throw new JWTClaimValidationFailed('\"iat\" claim must be a number', payload, 'iat', 'invalid');\n    }\n    if (payload.nbf !== undefined) {\n        if (typeof payload.nbf !== 'number') {\n            throw new JWTClaimValidationFailed('\"nbf\" claim must be a number', payload, 'nbf', 'invalid');\n        }\n        if (payload.nbf > now + tolerance) {\n            throw new JWTClaimValidationFailed('\"nbf\" claim timestamp check failed', payload, 'nbf', 'check_failed');\n        }\n    }\n    if (payload.exp !== undefined) {\n        if (typeof payload.exp !== 'number') {\n            throw new JWTClaimValidationFailed('\"exp\" claim must be a number', payload, 'exp', 'invalid');\n        }\n        if (payload.exp <= now - tolerance) {\n            throw new JWTExpired('\"exp\" claim timestamp check failed', payload, 'exp', 'check_failed');\n        }\n    }\n    if (maxTokenAge) {\n        const age = now - payload.iat;\n        const max = typeof maxTokenAge === 'number' ? maxTokenAge : secs(maxTokenAge);\n        if (age - tolerance > max) {\n            throw new JWTExpired('\"iat\" claim timestamp check failed (too far in the past)', payload, 'iat', 'check_failed');\n        }\n        if (age < 0 - tolerance) {\n            throw new JWTClaimValidationFailed('\"iat\" claim timestamp check failed (it should be in the past)', payload, 'iat', 'check_failed');\n        }\n    }\n    return payload;\n}\nexport class JWTClaimsBuilder {\n    #payload;\n    constructor(payload) {\n        if (!isObject(payload)) {\n            throw new TypeError('JWT Claims Set MUST be an object');\n        }\n        this.#payload = structuredClone(payload);\n    }\n    data() {\n        return encoder.encode(JSON.stringify(this.#payload));\n    }\n    get iss() {\n        return this.#payload.iss;\n    }\n    set iss(value) {\n        this.#payload.iss = value;\n    }\n    get sub() {\n        return this.#payload.sub;\n    }\n    set sub(value) {\n        this.#payload.sub = value;\n    }\n    get aud() {\n        return this.#payload.aud;\n    }\n    set aud(value) {\n        this.#payload.aud = value;\n    }\n    set jti(value) {\n        this.#payload.jti = value;\n    }\n    set nbf(value) {\n        if (typeof value === 'number') {\n            this.#payload.nbf = validateInput('setNotBefore', value);\n        }\n        else if (value instanceof Date) {\n            this.#payload.nbf = validateInput('setNotBefore', epoch(value));\n        }\n        else {\n            this.#payload.nbf = epoch(new Date()) + secs(value);\n        }\n    }\n    set exp(value) {\n        if (typeof value === 'number') {\n            this.#payload.exp = validateInput('setExpirationTime', value);\n        }\n        else if (value instanceof Date) {\n            this.#payload.exp = validateInput('setExpirationTime', epoch(value));\n        }\n        else {\n            this.#payload.exp = epoch(new Date()) + secs(value);\n        }\n    }\n    set iat(value) {\n        if (typeof value === 'undefined') {\n            this.#payload.iat = epoch(new Date());\n        }\n        else if (value instanceof Date) {\n            this.#payload.iat = validateInput('setIssuedAt', epoch(value));\n        }\n        else if (typeof value === 'string') {\n            this.#payload.iat = validateInput('setIssuedAt', epoch(new Date()) + secs(value));\n        }\n        else {\n            this.#payload.iat = validateInput('setIssuedAt', value);\n        }\n    }\n}\n","import { compactVerify } from '../jws/compact/verify.js';\nimport { validateClaimsSet } from '../lib/jwt_claims_set.js';\nimport { JWTInvalid } from '../util/errors.js';\nexport async function jwtVerify(jwt, key, options) {\n    const verified = await compactVerify(jwt, key, options);\n    if (verified.protectedHeader.crit?.includes('b64') && verified.protectedHeader.b64 === false) {\n        throw new JWTInvalid('JWTs MUST NOT use unencoded payload');\n    }\n    const payload = validateClaimsSet(verified.protectedHeader, verified.payload, options);\n    const result = { payload, protectedHeader: verified.protectedHeader };\n    if (typeof key === 'function') {\n        return { ...result, key: verified.key };\n    }\n    return result;\n}\n"],"names":["registerInstrumentation","globalThis","_ENTRIES","middleware_instrumentation","register","err","message","registerInstrumentationPromise","ensureInstrumentationRegistered","getUnsupportedModuleErrorMessage","module","__import_unsupported","moduleName","proxy","Proxy","get","_obj","prop","Error","construct","apply","_target","_this","args","enhanceGlobals","process","global","env","Object","defineProperty","value","enumerable","configurable","PageSignatureError","constructor","page","RemovedPageError","RemovedUAError","fromNodeOutgoingHttpHeaders","nodeHeaders","headers","Headers","key","entries","values","Array","isArray","v","toString","append","splitCookiesString","cookiesString","cookiesStrings","pos","start","ch","lastComma","nextStart","cookiesSeparatorFound","skipWhitespace","length","test","charAt","notSpecialChar","push","substring","toNodeOutgoingHttpHeaders","cookies","toLowerCase","validateURL","url","String","URL","error","cause","responseSymbol","Symbol","passThroughSymbol","waitUntilSymbol","FetchEvent","_request","respondWith","response","Promise","resolve","passThroughOnException","waitUntil","promise","NextFetchEvent","params","request","sourcePage","detectDomainLocale","domainItems","hostname","detectedLocale","item","_item_domain","_item_locales","domainHostname","domain","split","defaultLocale","locales","some","locale","removeTrailingSlash","route","replace","parsePath","path","hashIndex","indexOf","queryIndex","hasQuery","pathname","query","undefined","hash","slice","addPathPrefix","prefix","startsWith","addPathSuffix","suffix","pathHasPrefix","addLocale","ignorePrefix","lower","formatNextPathnameInfo","info","buildId","trailingSlash","basePath","endsWith","getHostname","parsed","host","normalizeLocalePath","pathnameParts","splice","join","removePathPrefix","withoutPrefix","getNextPathnameInfo","options","_options_nextConfig","i18n","nextConfig","pathnameNoDataPrefix","paths","parseData","result","i18nProvider","analyze","_result_pathname","REGEX_LOCALHOST_HOSTNAME","parseURL","base","Internal","NextURL","input","baseOrOpts","opts","_this_Internal_options_nextConfig_i18n","_this_Internal_options_nextConfig","_this_Internal_domainLocale","_this_Internal_options_nextConfig_i18n1","_this_Internal_options_nextConfig1","__NEXT_NO_MIDDLEWARE_URL_NORMALIZE","domainLocale","domains","formatPathname","forceLocale","formatSearch","search","includes","TypeError","searchParams","port","protocol","href","origin","password","username","toJSON","for","clone","RequestCookies","ResponseCookies","INTERNALS","NextRequest","Request","init","nextUrl","geo","ip","bodyUsed","cache","credentials","destination","fromEntries","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","ua","REDIRECTS","Set","handleMiddlewareField","_init_request","keys","set","NextResponse","Response","body","ok","redirected","status","statusText","type","json","has","RangeError","initObj","rewrite","next","relativizeURL","baseURL","relative","RSC","ACTION","NEXT_ROUTER_STATE_TREE","NEXT_ROUTER_PREFETCH","NEXT_URL","RSC_CONTENT_TYPE_HEADER","RSC_VARY_HEADER","FLIGHT_PARAMETERS","NEXT_RSC_UNION_QUERY","INTERNAL_QUERY_NAMES","EDGE_EXTENDED_INTERNAL_QUERY_NAMES","stripInternalQueries","name","stripInternalSearchParams","isEdge","isStringUrl","instance","delete","INTERNAL_HEADERS","stripInternalHeaders","ensureLeadingSlash","isGroupSegment","normalizeAppPath","reduce","segment","index","segments","normalizeRscURL","normalizePostponedURL","NEXT_QUERY_PARAM_PREFIX","PRERENDER_REVALIDATE_HEADER","PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER","NEXT_DID_POSTPONE_HEADER","NEXT_CACHE_TAGS_HEADER","NEXT_CACHE_SOFT_TAGS_HEADER","NEXT_CACHE_REVALIDATED_TAGS_HEADER","NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER","NEXT_CACHE_TAG_MAX_LENGTH","NEXT_CACHE_SOFT_TAG_MAX_LENGTH","NEXT_CACHE_IMPLICIT_TAG_ID","CACHE_ONE_YEAR","MIDDLEWARE_FILENAME","MIDDLEWARE_LOCATION_REGEXP","INSTRUMENTATION_HOOK_FILENAME","PAGES_DIR_ALIAS","DOT_NEXT_ALIAS","ROOT_DIR_ALIAS","APP_DIR_ALIAS","RSC_MOD_REF_PROXY_ALIAS","RSC_ACTION_VALIDATE_ALIAS","RSC_ACTION_PROXY_ALIAS","RSC_ACTION_ENCRYPTION_ALIAS","RSC_ACTION_CLIENT_WRAPPER_ALIAS","PUBLIC_DIR_MIDDLEWARE_CONFLICT","SSG_GET_INITIAL_PROPS_CONFLICT","SERVER_PROPS_GET_INIT_PROPS_CONFLICT","SERVER_PROPS_SSG_CONFLICT","STATIC_STATUS_PAGE_GET_INITIAL_PROPS_ERROR","SERVER_PROPS_EXPORT_ERROR","GSP_NO_RETURNED_VALUE","GSSP_NO_RETURNED_VALUE","UNSTABLE_REVALIDATE_RENAME_ERROR","GSSP_COMPONENT_MEMBER_ERROR","NON_STANDARD_NODE_ENV","SSG_FALLBACK_EXPORT_ERROR","ESLINT_DEFAULT_DIRS","ESLINT_PROMPT_VALUES","title","recommended","config","extends","SERVER_RUNTIME","edge","experimentalEdge","nodejs","WEBPACK_LAYERS_NAMES","shared","reactServerComponents","serverSideRendering","actionBrowser","api","middleware","edgeAsset","appPagesBrowser","appMetadataRoute","appRouteHandler","WEBPACK_LAYERS","GROUP","server","nonClientServerTarget","app","WEBPACK_RESOURCE_QUERIES","edgeSSREntry","metadata","metadataRoute","metadataImageMeta","ReflectAdapter","target","receiver","Reflect","bind","deleteProperty","ReadonlyHeadersError","callable","HeadersAdapter","lowercased","original","find","o","seal","merge","from","existing","forEach","callbackfn","thisArg","call","iterator","ReadonlyRequestCookiesError","RequestCookiesAdapter","SYMBOL_MODIFY_COOKIE_VALUES","getModifiedCookieValues","modified","appendMutableCookies","mutableCookies","modifiedCookieValues","resCookies","returnedCookies","getAll","cookie","MutableRequestCookiesAdapter","wrap","onUpdateCookies","responseCookes","modifiedValues","modifiedCookies","updateResponseCookies","_fetch___nextGetStaticStore","staticGenerationAsyncStore","fetch","__nextGetStaticStore","getStore","pathWasRevalidated","allCookies","filter","c","serializedCookies","tempCookies","add","sendStatusCode","res","statusCode","statusOrUrl","writeHead","Location","write","end","checkIsOnDemandRevalidate","req","previewProps","previewModeId","isOnDemandRevalidate","revalidateOnlyGenerated","COOKIE_NAME_PRERENDER_BYPASS","COOKIE_NAME_PRERENDER_DATA","RESPONSE_LIMIT_DEFAULT","SYMBOL_PREVIEW_DATA","SYMBOL_CLEARED_COOKIES","clearPreviewData","serialize","require","previous","getHeader","setHeader","expires","Date","httpOnly","sameSite","secure","ApiError","sendError","statusMessage","setLazyProp","getter","optsReset","writable","DraftModeProvider","_cookies_get","cookieValue","isEnabled","Boolean","_previewModeId","_mutableCookies","enable","disable","getHeaders","cleaned","param","getCookies","getMutableCookies","RequestAsyncStorageWrapper","storage","renderOpts","callback","defaultOnUpdateCookies","store","draftMode","run","sharedAsyncLocalStorageNotAvailableError","FakeAsyncLocalStorage","exit","enterWith","maybeGlobalAsyncLocalStorage","AsyncLocalStorage","createAsyncLocalStorage","requestAsyncStorage","NextRequestHint","adapter","isEdgeRendering","self","__BUILD_MANIFEST","prerenderManifest","__PRERENDER_MANIFEST","JSON","parse","requestUrl","normalizedKey","val","isDataReq","requestHeaders","flightHeaders","Map","normalizeUrl","__incrementalCache","IncrementalCache","appDir","fetchCache","minimalMode","fetchCacheKeyPrefix","__NEXT_FETCH_CACHE_KEY_PREFIX","dev","requestProtocol","getPrerenderManifest","version","routes","dynamicRoutes","notFoundRoutes","preview","event","cookiesFromResponse","isMiddleware","previewModeEncryptionKey","previewModeSigningKey","handler","rewriteUrl","relativizedRewrite","__NEXT_EXTERNAL_MIDDLEWARE_REWRITE_RESOLVE","match","redirectURL","finalResponse","middlewareOverrideHeaders","overwrittenHeaders","all","fetchMetrics","default","jwtVerify","PROTECTED_ROUTES","FEATURE_ACCESS","subscriptionMiddleware","requiredPlan","getRequiredPlanForRoute","token","createUnauthorizedResponse","secret","TextEncoder","encode","JWT_SECRET","payload","hasSubscriptionAccess","createSubscriptionRequiredResponse","subscription_plan","subscription_status","user_id","console","plan","user","planHierarchy","free","basic","premium","userPlanLevel","requiredPlanLevel","stringify","code","required_plan","current_path","upgrade_url","checkFeatureAccess","userPlan","userStatus","feature","SimpleEventEmitter","on","events","emit","callbacks","removeListener","MockRedisClient","data","EX","setTimeout","PX","del","existed","hashes","lists","sortedSets","exists","expire","seconds","hget","field","hset","isNew","hgetall","hdel","lpush","list","unshift","rpush","lpop","shift","rpop","pop","lrange","stop","zadd","score","member","sortedSet","zrange","sorted","sort","a","b","WITHSCORES","flatMap","map","zrevrange","zrem","publish","channel","subscribers","size","subscribe","log","unsubscribe","disconnect","clear","RedisService","isConnected","defaultTTL","maxRetries","retryDelay","client","connect","ttl","serialized","withScores","receivedChannel","cacheMarketData","symbol","getMarketData","cacheNews","newsId","article","getNews","cacheUserSession","userId","sessionData","getUserSession","addTradeOrder","order","getNextTradeOrder","updateLeaderboard","category","getLeaderboard","limit","updateTradingPerformance","metrics","timestamp","now","totalReturn","winRate","sharpeRatio","totalTrades","followers","aum","lastUpdated","getTopTraders","results","traders","i","parseFloat","rank","Math","floor","parseInt","getUserRank","zrevrank","updatePeriodLeaderboard","period","periodKey","getFullYear","getMonth","padStart","getDate","weekStart","setDate","getDay","ceil","expiration","getPeriodLeaderboard","addPaperTradingOrder","getNextPaperTradingOrder","subscribeToOrderUpdates","publishOrderUpdate","orderUpdate","cacheQueueStats","stats","pending","processing","completed","getQueueStats","isHealthy","redisService","SessionService","createSession","sessionId","userSession","defaultOptions","sessionKey","SESSION_PREFIX","userSessionsKey","USER_SESSIONS_PREFIX","setHash","email","role","permissions","loginTime","lastActivity","ipAddress","userAgent","deviceId","maxAge","addToSortedSet","ACTIVE_SESSIONS_PREFIX","maxConcurrentSessions","enforceConcurrentSessionLimit","trackActivity","getSession","getHash","updateActivity","setHashField","extendOnActivity","destroySession","session","removeFromSortedSet","getUserSessions","sessions","getSortedSetRange","activeSessions","destroyUserSessions","excludeSessionId","destroyedCount","success","getSessionStats","last24h","lastHour","totalActiveSessions","getSortedSetCount","sessionsLast24h","getSortedSetCountByScore","sessionsLastHour","cleanupExpiredSessions","expiredThreshold","expiredSessions","getSortedSetRangeByScore","cleanedCount","maxSessions","sessionDetails","sessionsToRemove","activityType","activityKey","SESSION_ACTIVITY_PREFIX","activity","addToList","trimList","getSessionActivity","activities","getListRange","sessionService","protectedRoutes","freeProtectedRoutes","publicRoutes","authRoutes","fullUrl","hasRscParam","isValidToken","sub","isProtectedRoute","isAuthRoute","isPublicRoute","redirectResponse","loginUrl","isFreeProtectedRoute","subscriptionResponse","pricingUrl","matcher","__defProp","__getOwnPropDesc","getOwnPropertyDescriptor","__getOwnPropNames","getOwnPropertyNames","__hasOwnProp","prototype","hasOwnProperty","__export","__copyProps","to","except","desc","__toCommonJS","mod","src_exports","parseCookie","parseSetCookie","stringifyCookie","exports","_a","attrs","toUTCString","priority","encodeURIComponent","pair","splitAt","decodeURIComponent","setCookie","attributes","httponly","maxage","samesite","value2","Number","parseSameSite","parsePriority","compact","t","newT","SAME_SITE","string","PRIORITY","_parsed","_headers","header","_","n","names","responseHeaders","_b","_c","getSetCookie","cookieStrings","cookieString","normalizeCookie","bag","__nccwpck_require__","ab","__dirname","e","r","s","decode","p","f","u","substr","trim","tryDecode","isNaN","isFinite","compactDecrypt","flattenedDecrypt","generalDecrypt","GeneralEncrypt","compactVerify","flattenedVerify","generalVerify","jwtDecrypt","CompactEncrypt","FlattenedEncrypt","CompactSign","FlattenedSign","GeneralSign","SignJWT","EncryptJWT","calculateJwkThumbprint","calculateJwkThumbprintUri","EmbeddedJWK","createLocalJWKSet","createRemoteJWKSet","jwksCache","customFetch","UnsecuredJWT","exportPKCS8","exportSPKI","exportJWK","importSPKI","importPKCS8","importX509","importJWK","decodeProtectedHeader","decodeJwt","errors","generateKeyPair","generateSecret","base64url","cryptoRuntime","encoder","decoder","TextDecoder","MAX_INT32","concat","buffers","acc","buf","Uint8Array","buffer","writeUInt32BE","offset","uint64be","high","low","uint32be","encodeBase64","toBase64","CHUNK_SIZE","arr","fromCharCode","subarray","btoa","decodeBase64","encoded","fromBase64","binary","atob","bytes","charCodeAt","alphabet","unencoded","omitPadding","JOSEError","captureStackTrace","JWTClaimValidationFailed","claim","reason","JWTExpired","JOSEAlgNotAllowed","JOSENotSupported","JWEDecryptionFailed","JWEInvalid","JWSInvalid","JWTInvalid","JWKInvalid","JWKSInvalid","JWKSNoMatchingKey","JWKSMultipleMatchingKeys","asyncIterator","JWKSTimeout","JWSSignatureVerificationFailed","alg","algorithm","saltLength","namedCurve","modulusLength","unusable","isAlgorithm","getHashLength","getNamedCurve","checkUsage","usage","usages","checkSigCryptoKey","expected","actual","checkEncCryptoKey","msg","types","last","withAlg","invalidKeyInput","crypto","subtle","importKey","subtleAlgorithm","checkKeyLength","getVerifyKey","signature","cryptoKey","verify","sources","parameters","parameter","isObjectLike","getPrototypeOf","proto","assertCryptoKey","isCryptoKey","toStringTag","isKeyObject","isObject","isJWK","kty","isPrivateJWK","priv","d","isPublicJWK","isSecretJWK","k","isKeyLike","jwk","tag","jwkMatchesOp","use","key_ops","expectedKeyOp","symmetricTypeCheck","asymmetricTypeCheck","symmetric","Err","recognizedDefault","recognizedOption","protectedHeader","joseHeader","crit","recognized","option","algorithms","subtleMapping","keyUsages","crv","keyData","ext","handleJWK","freeze","WeakMap","cached","handleKeyObject","keyObject","isPublic","extractable","asymmetricKeyType","toCryptoKey","toUpperCase","nist","asymmetricKeyDetails","export","format","b64u","isDisjoint","checkKeyType","validateCrit","validateAlgorithms","normalizeKey","jws","protected","parsedProt","extensions","b64","resolvedKey","verified","unprotectedHeader","date","getTime","minute","hour","day","week","year","REGEX","str","matched","exec","unit","numericDate","round","epoch","secs","validateInput","label","normalizeTyp","checkAudiencePresence","audPayload","audOption","validateClaimsSet","encodedPayload","typ","requiredClaims","issuer","subject","audience","maxTokenAge","presenceCheck","reverse","iss","aud","tolerance","clockTolerance","currentDate","iat","nbf","exp","age","max","JWTClaimsBuilder","structuredClone","jti","jwt"],"sourceRoot":""}